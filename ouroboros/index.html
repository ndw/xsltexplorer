<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>XSLT Explorer: explorer.xsl</title><meta name="viewport" content="width=device-width,initial-scale=1" /><link rel="shortcut icon" href="https://xslt.xmlexplorer.com/img/icon64.png" type="image/png" /><link rel="stylesheet" href="css/prism.css" /><link rel="stylesheet" href="css/xsltexplorer.css" /><link rel="schema.dc" href="http://purl.org/dc/elements/1.1/" /><meta name="dc.modified" content="2020-06-07T07:44:49Z" /><meta name="generator" content="XSLT Explorer 0.1.5 / 2621bf7" /><script src="js/prism.js"></script></head><body><main><h1><a href="https://xslt.xmlexplorer.com/"><img class="logo" src="https://xslt.xmlexplorer.com/img/logo256.png" /></a>XSLT Explorer: explorer.xsl</h1><p>5 imports, 44 templates, 21 functions, 4 variables, 12 params, 1 FIXME: comment</p><div class="toc"><span class="closed">List of Imports</span><ul><li><a href="#S-16674">VERSION.xsl</a></li><li><a href="#S-56087">parse.xsl</a></li><li><a href="#S-6140">resolve.xsl</a></li><li><a href="#S-28400">analyze.xsl</a></li><li><a href="#S-60890">summarize.xsl</a></li></ul></div><div class="lot"><span class="closed">List of Templates</span><dl class="columns"><dt><a href="#S-60890-nwalsh.com.ns.xslt.templates.functions-called">t:functions-called</a></dt><dt><a href="#S-60890-nwalsh.com.ns.xslt.templates.templates-called">t:templates-called</a></dt><dt><a href="#S-60890-nwalsh.com.ns.xslt.templates.variables-referenced">t:variables-referenced</a></dt></dl></div><div class="lof"><span class="closed">List of Functions</span><dl class="columns"><dt><a href="#S-28400-nwalsh.com.ns.xslt.functions.function-calls,1">f:function-calls()</a></dt><dt><a href="#S-28400-nwalsh.com.ns.xslt.functions.function-shadows,2">f:function-shadows()</a></dt><dt><a href="#S-28400-nwalsh.com.ns.xslt.functions.generate-id,1">f:generate-id()</a></dt><dt><a href="#S-28400-nwalsh.com.ns.xslt.functions.template-calls,1">f:template-calls()</a></dt><dt><a href="#S-28400-nwalsh.com.ns.xslt.functions.template-shadows,2">f:template-shadows()</a></dt><dt><a href="#S-28400-nwalsh.com.ns.xslt.functions.variable,2">f:variable()</a></dt><dt><a href="#S-28400-nwalsh.com.ns.xslt.functions.variables-referenced,1">f:variables-referenced()</a></dt><dt><a href="#S-56087-nwalsh.com.ns.xslt.functions.checksum,1">f:checksum()</a></dt><dt><a href="#S-56087-nwalsh.com.ns.xslt.functions.clark-name,1">f:clark-name()</a></dt><dt><a href="#S-56087-nwalsh.com.ns.xslt.functions.clark-name,2">f:clark-name()</a></dt><dt><a href="#S-56087-nwalsh.com.ns.xslt.functions.encode-for-id,1">f:encode-for-id()</a></dt><dt><a href="#S-56087-nwalsh.com.ns.xslt.functions.fletcher16,5">f:fletcher16()</a></dt><dt><a href="#S-56087-nwalsh.com.ns.xslt.functions.parse-expr,2">f:parse-expr()</a></dt><dt><a href="#S-56087-nwalsh.com.ns.xslt.functions.process-avts,2">f:process-avts()</a></dt><dt><a href="#S-56087-nwalsh.com.ns.xslt.functions.source-location,1">f:source-location()</a></dt><dt><a href="#S-56087-nwalsh.com.ns.xslt.functions.unique-id,1">f:unique-id()</a></dt><dt><a href="#S-60890-nwalsh.com.ns.xslt.functions.line-link,1">f:line-link()</a></dt><dt><a href="#S-60890-nwalsh.com.ns.xslt.functions.reference-list,1">f:reference-list()</a></dt><dt><a href="#S-60890-nwalsh.com.ns.xslt.functions.summary-count,2">f:summary-count()</a></dt><dt><a href="#S-60890-nwalsh.com.ns.xslt.functions.summary-details,1">f:summary-details()</a></dt><dt><a href="#S-6140-nwalsh.com.ns.xslt.functions.xvariable,2">f:xvariable()</a></dt></dl></div><div class="stylesheet" id="S-49518"><h1>explorer.xsl</h1><p><span class="import all">5 imports</span></p><div class="stylesheet" id="S-16674"><h2>VERSION.xsl</h2><p><span><span class="variable all">3 variables</span> (<span class="variable elsewhere">3 used only in one other module</span>)</span></p><div class="instructions"><div class="title closed">Instructions</div><div class="body"><div id="S-16674-..TITLE" class="instruction variable elsewhere"><div class="title"><span class="link" title="Line 2"><a href="#line-d47615e10-2" class="goto-lno">§</a></span>Variable <code>$TITLE</code></div><div class="props"><div class="used-by"><span class="marker"></span>Used by: <a href="#S-60890-t-1">template</a></div><div class="used-in"><span class="marker" title="Only used in one other module">☝</span>Used in: <a href="#S-60890">summarize.xsl</a></div></div></div><div id="S-16674-..VERSION" class="instruction variable elsewhere"><div class="title"><span class="link" title="Line 3"><a href="#line-d47615e10-3" class="goto-lno">§</a></span>Variable <code>$VERSION</code></div><div class="props"><div class="used-by"><span class="marker"></span>Used by: <a href="#S-60890-t-1">template</a></div><div class="used-in"><span class="marker" title="Only used in one other module">☝</span>Used in: <a href="#S-60890">summarize.xsl</a></div></div></div><div id="S-16674-..VERHASH" class="instruction variable elsewhere"><div class="title"><span class="link" title="Line 4"><a href="#line-d47615e10-4" class="goto-lno">§</a></span>Variable <code>$VERHASH</code></div><div class="props"><div class="used-by"><span class="marker"></span>Used by: <a href="#S-60890-t-1">template</a></div><div class="used-in"><span class="marker" title="Only used in one other module">☝</span>Used in: <a href="#S-60890">summarize.xsl</a></div></div></div></div></div><div class="source-code"><div class="title closed">Source code</div><div class="body"><div><table><tr><td valign="top" align="right"><pre class="fake-prism"><span id="line-d47615e10-1">1</span>
<span id="line-d47615e10-2"><span class="lno">2</span></span>
<span id="line-d47615e10-3"><span class="lno">3</span></span>
<span id="line-d47615e10-4"><span class="lno">4</span></span>
<span id="line-d47615e10-5">5</span>
<span id="line-d47615e10-6"><span class="lno">6</span></span>
<span id="line-d47615e10-7"><span class="lno">7</span></span>
</pre></td><td valign="top"><pre><code class="language-xml">&lt;xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="3.0"&gt;
   &lt;xsl:variable name="TITLE" select="'XSLT Explorer'"/&gt;
   &lt;xsl:variable name="VERSION" select="'0.1.5'"/&gt;
   &lt;xsl:variable name="VERHASH" select="'2621bf7'"/&gt;
&lt;/xsl:stylesheet&gt;

</code></pre></td></tr></table></div></div></div></div><div class="stylesheet" id="S-56087"><h2>parse.xsl</h2><p><span><span class="template all">14 templates</span></span>, <span><span class="function all">9 functions</span></span>, <span><span class="param all">1 param</span></span>, <span><span class="FIXME: comment all">1 FIXME: comment</span></span></p><div class="instructions"><div class="title closed">Instructions</div><div class="body"><div id="S-56087-..fixme" class="instruction param"><div class="title"><span class="link" title="Line 17"><a href="#line-d47615e37-17" class="goto-lno">§</a></span>Param <code>$fixme</code></div><div class="props"><div class="used-by"><span class="marker"></span>Used by: <a href="#S-56087-t-13">template</a></div><div class="used-in"><span class="marker"></span>Used in: <a href="#S-56087">parse.xsl</a></div></div></div><div id="S-56087-t-1" class="instruction template"><div class="title"><span class="link" title="Line 19"><a href="#line-d47615e37-19" class="goto-lno">§</a></span>Template match ≅ /</div><div class="props"><div class="mode">Mode: <code>m:parse</code></div><div class="matches">Matches: <code>/</code></div></div></div><div id="S-56087-t-2" class="instruction template"><div class="title"><span class="link" title="Line 23"><a href="#line-d47615e37-23" class="goto-lno">§</a></span>Template match ≅ xsl:stylesheet|xsl:transform</div><div class="props"><div class="calls">Calls: <a href="#S-56087-nwalsh.com.ns.xslt.functions.encode-for-id,1">f:encode-for-id()</a>, <a href="#S-56087-nwalsh.com.ns.xslt.functions.source-location,1">f:source-location()</a>, <a href="#S-56087-nwalsh.com.ns.xslt.functions.unique-id,1">f:unique-id()</a></div><div class="mode">Mode: <code>m:parse</code></div><div class="matches">Matches: <code>xsl:stylesheet</code>, <code>xsl:transform</code></div></div></div><div id="S-56087-t-3" class="instruction template"><div class="title"><span class="link" title="Line 41"><a href="#line-d47615e37-41" class="goto-lno">§</a></span>Template match ≅ xsl:import</div><div class="props"><div class="calls">Calls: <a href="#S-56087-nwalsh.com.ns.xslt.functions.source-location,1">f:source-location()</a></div><div class="mode">Mode: <code>m:parse</code></div><div class="matches">Matches: <code>xsl:import</code></div></div></div><div id="S-56087-t-4" class="instruction template"><div class="title"><span class="link" title="Line 56"><a href="#line-d47615e37-56" class="goto-lno">§</a></span>Template match ≅ xsl:include</div><div class="props"><div class="calls">Calls: <a href="#S-56087-nwalsh.com.ns.xslt.functions.source-location,1">f:source-location()</a></div><div class="mode">Mode: <code>m:parse</code></div><div class="matches">Matches: <code>xsl:include</code></div></div></div><div id="S-56087-t-5" class="instruction template"><div class="title"><span class="link" title="Line 72"><a href="#line-d47615e37-72" class="goto-lno">§</a></span>Template match ≅ xsl:template</div><div class="props"><div class="calls">Calls: <a href="#S-56087-nwalsh.com.ns.xslt.functions.clark-name,1">f:clark-name()</a>, <a href="#S-56087-nwalsh.com.ns.xslt.functions.encode-for-id,1">f:encode-for-id()</a>, <a href="#S-56087-nwalsh.com.ns.xslt.functions.source-location,1">f:source-location()</a>, <a href="#S-56087-nwalsh.com.ns.xslt.functions.unique-id,1">f:unique-id()</a></div><div class="mode">Mode: <code>m:parse</code></div><div class="matches">Matches: <code>xsl:template</code></div></div></div><div id="S-56087-t-6" class="instruction template"><div class="title"><span class="link" title="Line 137"><a href="#line-d47615e37-137" class="goto-lno">§</a></span>Template match ≅ xsl:function</div><div class="props"><div class="calls">Calls: <a href="#S-56087-nwalsh.com.ns.xslt.functions.clark-name,1">f:clark-name()</a>, <a href="#S-56087-nwalsh.com.ns.xslt.functions.encode-for-id,1">f:encode-for-id()</a>, <a href="#S-56087-nwalsh.com.ns.xslt.functions.source-location,1">f:source-location()</a>, <a href="#S-56087-nwalsh.com.ns.xslt.functions.unique-id,1">f:unique-id()</a></div><div class="mode">Mode: <code>m:parse</code></div><div class="matches">Matches: <code>xsl:function</code></div></div></div><div id="S-56087-t-7" class="instruction template"><div class="title"><span class="link" title="Line 156"><a href="#line-d47615e37-156" class="goto-lno">§</a></span>Template match ≅ xsl:param|xsl:variable</div><div class="props"><div class="calls">Calls: <a href="#S-56087-nwalsh.com.ns.xslt.functions.clark-name,1">f:clark-name()</a>, <a href="#S-56087-nwalsh.com.ns.xslt.functions.encode-for-id,1">f:encode-for-id()</a>, <a href="#S-56087-nwalsh.com.ns.xslt.functions.source-location,1">f:source-location()</a>, <a href="#S-56087-nwalsh.com.ns.xslt.functions.unique-id,1">f:unique-id()</a></div><div class="mode">Mode: <code>m:parse</code></div><div class="matches">Matches: <code>xsl:param</code>, <code>xsl:variable</code></div></div></div><div id="S-56087-t-8" class="instruction template"><div class="title"><span class="link" title="Line 171"><a href="#line-d47615e37-171" class="goto-lno">§</a></span>Template match ≅ xsl:call-template</div><div class="props"><div class="calls">Calls: <a href="#S-56087-nwalsh.com.ns.xslt.functions.clark-name,1">f:clark-name()</a>, <a href="#S-56087-nwalsh.com.ns.xslt.functions.source-location,1">f:source-location()</a></div><div class="mode">Mode: <code>m:parse</code></div><div class="matches">Matches: <code>xsl:call-template</code></div></div></div><div id="S-56087-t-9" class="instruction template"><div class="title"><span class="link" title="Line 182"><a href="#line-d47615e37-182" class="goto-lno">§</a></span>Template match ≅ xsl:apply-templates</div><div class="props"><div class="calls">Calls: <a href="#S-56087-nwalsh.com.ns.xslt.functions.source-location,1">f:source-location()</a></div><div class="mode">Mode: <code>m:parse</code></div><div class="matches">Matches: <code>xsl:apply-templates</code></div></div></div><div id="S-56087-t-10" class="instruction template"><div class="title"><span class="link" title="Line 211"><a href="#line-d47615e37-211" class="goto-lno">§</a></span>Template match ≅ element()</div><div class="props"><div class="mode">Mode: <code>m:parse</code></div><div class="matches">Matches: <code>element()</code></div></div></div><div id="S-56087-t-11" class="instruction template"><div class="title"><span class="link" title="Line 223"><a href="#line-d47615e37-223" class="goto-lno">§</a></span>Template match ≅ @select|xsl:evaluate/@context-…</div><div class="props"><div class="calls">Calls: <a href="#S-56087-nwalsh.com.ns.xslt.functions.parse-expr,2">f:parse-expr()</a></div><div class="mode">Mode: <code>m:parse</code></div><div class="matches">Matches: <code>@select</code>, <code>xsl:evaluate/@context-item</code>, <code>xsl:evaluate/@xpath</code>, <code>xsl:group-by/@group-by</code>, <code>xsl:if/@test</code>, <code>xsl:template/@match</code>, <code>xsl:when/@test</code></div></div></div><div id="S-56087-t-12" class="instruction template"><div class="title"><span class="link" title="Line 227"><a href="#line-d47615e37-227" class="goto-lno">§</a></span>Template match ≅ @*</div><div class="props"><div class="calls">Calls: <a href="#S-56087-nwalsh.com.ns.xslt.functions.process-avts,2">f:process-avts()</a></div><div class="mode">Mode: <code>m:parse</code></div><div class="matches">Matches: <code>@*</code></div></div></div><div id="S-56087-t-13" class="instruction template"><div class="title"><span class="link" title="Line 236"><a href="#line-d47615e37-236" class="goto-lno">§</a></span>Template match ≅ comment()</div><div class="props"><div class="uses">Uses: <a href="#S-56087-..fixme">$fixme</a></div><div class="calls">Calls: <a href="#S-56087-nwalsh.com.ns.xslt.functions.encode-for-id,1">f:encode-for-id()</a>, <a href="#S-56087-nwalsh.com.ns.xslt.functions.source-location,1">f:source-location()</a>, <a href="#S-56087-nwalsh.com.ns.xslt.functions.unique-id,1">f:unique-id()</a></div><div class="mode">Mode: <code>m:parse</code></div><div class="matches">Matches: <code>comment()</code></div></div></div><div id="S-56087-t-14" class="instruction template"><div class="title"><span class="link" title="Line 245"><a href="#line-d47615e37-245" class="goto-lno">§</a></span>Template match ≅ processing-instruction()|text(…</div><div class="props"><div class="mode">Mode: <code>m:parse</code></div><div class="matches">Matches: <code>processing-instruction()</code>, <code>text()</code></div></div></div><div id="S-56087-nwalsh.com.ns.xslt.functions.process-avts,2" class="instruction function"><div class="title"><span class="link" title="Line 249"><a href="#line-d47615e37-249" class="goto-lno">§</a></span>Function f:process-avts($context as element(), $value as xs:string) <span class="recursive" title="Recursive function">♻</span></div><div class="props"><div class="used-by"><span class="marker"></span>Used by: <a href="#S-56087-t-12">template</a>, <a href="#S-56087-nwalsh.com.ns.xslt.functions.process-avts,2">f:process-avts()</a></div><div class="used-in"><span class="marker"></span>Used in: <a href="#S-56087">parse.xsl</a></div></div></div><div id="S-56087-nwalsh.com.ns.xslt.functions.parse-expr,2" class="instruction function"><div class="title"><span class="link" title="Line 262"><a href="#line-d47615e37-262" class="goto-lno">§</a></span>Function f:parse-expr($context as element(), $expr as xs:string)</div><div class="props"><div class="calls">Calls: <a href="#S-56087-nwalsh.com.ns.xslt.functions.process-avts,2">f:process-avts()</a></div><div class="used-by"><span class="marker"></span>Used by: <a href="#S-56087-t-11">template</a>, <a href="#S-56087-nwalsh.com.ns.xslt.functions.process-avts,2">f:process-avts()</a></div><div class="used-in"><span class="marker"></span>Used in: <a href="#S-56087">parse.xsl</a></div></div></div><div id="S-56087-nwalsh.com.ns.xslt.functions.unique-id,1" class="instruction function"><div class="title"><span class="link" title="Line 339"><a href="#line-d47615e37-339" class="goto-lno">§</a></span>Function f:unique-id($ref as node()) as xs:string <span class="recursive" title="Recursive function">♻</span></div><div class="props"><div class="used-by"><span class="marker"></span>Used by: <a href="#S-56087-t-2">template</a>, <a href="#S-56087-t-5">template</a>, <a href="#S-56087-t-6">template</a>, <a href="#S-56087-t-7">template</a>, <a href="#S-56087-t-13">template</a>, <a href="#S-56087-nwalsh.com.ns.xslt.functions.unique-id,1">f:unique-id()</a></div><div class="used-in"><span class="marker"></span>Used in: <a href="#S-56087">parse.xsl</a></div></div></div><div id="S-56087-nwalsh.com.ns.xslt.functions.encode-for-id,1" class="instruction function"><div class="title"><span class="link" title="Line 366"><a href="#line-d47615e37-366" class="goto-lno">§</a></span>Function f:encode-for-id($name as xs:string) as xs:string</div><div class="props"><div class="used-by"><span class="marker"></span>Used by: <a href="#S-56087-t-2">template</a>, <a href="#S-56087-t-5">template</a>, <a href="#S-56087-t-6">template</a>, <a href="#S-56087-t-7">template</a>, <a href="#S-56087-t-13">template</a></div><div class="used-in"><span class="marker"></span>Used in: <a href="#S-56087">parse.xsl</a></div></div></div><div id="S-56087-nwalsh.com.ns.xslt.functions.clark-name,1" class="instruction function"><div class="title"><span class="link" title="Line 375"><a href="#line-d47615e37-375" class="goto-lno">§</a></span>Function f:clark-name#1($node as node()) as xs:string</div><div class="props"><div class="calls">Calls: <a href="#S-56087-nwalsh.com.ns.xslt.functions.unique-id,1">f:unique-id()</a></div><div class="used-by"><span class="marker"></span>Used by: <a href="#S-56087-t-5">template</a>, <a href="#S-56087-t-6">template</a>, <a href="#S-56087-t-7">template</a>, <a href="#S-56087-t-8">template</a>, <a href="#S-56087-nwalsh.com.ns.xslt.functions.unique-id,1">f:unique-id()</a></div><div class="used-in"><span class="marker"></span>Used in: <a href="#S-56087">parse.xsl</a></div></div></div><div id="S-56087-nwalsh.com.ns.xslt.functions.clark-name,2" class="instruction function"><div class="title"><span class="link" title="Line 387"><a href="#line-d47615e37-387" class="goto-lno">§</a></span>Function f:clark-name#2($node as node(), $name as xs:string) as xs:string</div><div class="props"><div class="calls">Calls: <a href="#S-56087-nwalsh.com.ns.xslt.functions.clark-name,1">f:clark-name()</a></div><div class="used-by"><span class="marker"></span>Used by: <a href="#S-56087-nwalsh.com.ns.xslt.functions.clark-name,1">f:clark-name()</a></div><div class="used-in"><span class="marker"></span>Used in: <a href="#S-56087">parse.xsl</a></div></div></div><div id="S-56087-nwalsh.com.ns.xslt.functions.source-location,1" class="instruction function"><div class="title"><span class="link" title="Line 404"><a href="#line-d47615e37-404" class="goto-lno">§</a></span>Function f:source-location($context as node()) as attribute()*</div><div class="props"><div class="used-by"><span class="marker"></span>Used by: <a href="#S-56087-t-2">template</a>, <a href="#S-56087-t-3">template</a>, <a href="#S-56087-t-4">template</a>, <a href="#S-56087-t-5">template</a>, <a href="#S-56087-t-6">template</a>, <a href="#S-56087-t-7">template</a>, <a href="#S-56087-t-8">template</a>, <a href="#S-56087-t-9">template</a>, <a href="#S-56087-t-13">template</a></div><div class="used-in"><span class="marker"></span>Used in: <a href="#S-56087">parse.xsl</a></div></div></div><div id="S-56087-nwalsh.com.ns.xslt.functions.checksum,1" class="instruction function"><div class="title"><span class="link" title="Line 421"><a href="#line-d47615e37-421" class="goto-lno">§</a></span>Function f:checksum($str as xs:string) as xs:string</div><div class="props"><div class="uses">Uses: <a href="#S-49518-..xspec-tests">$xspec-tests</a></div><div class="calls">Calls: <a href="#S-56087-nwalsh.com.ns.xslt.functions.unique-id,1">f:unique-id()</a></div><div class="used-by"><span class="marker"></span>Used by: <a href="#S-56087-nwalsh.com.ns.xslt.functions.unique-id,1">f:unique-id()</a></div><div class="used-in"><span class="marker"></span>Used in: <a href="#S-56087">parse.xsl</a></div></div></div><div id="S-56087-nwalsh.com.ns.xslt.functions.fletcher16,5" class="instruction function"><div class="title"><span class="link" title="Line 437"><a href="#line-d47615e37-437" class="goto-lno">§</a></span>Function f:fletcher16($str as xs:integer*, $len as xs:integer, $index as xs:integer, $sum1 as xs:integer, $sum2 as xs:integer) <span class="recursive" title="Recursive function">♻</span></div><div class="props"><div class="calls">Calls: <a href="#S-56087-nwalsh.com.ns.xslt.functions.checksum,1">f:checksum()</a></div><div class="used-by"><span class="marker"></span>Used by: <a href="#S-56087-nwalsh.com.ns.xslt.functions.checksum,1">f:checksum()</a>, <a href="#S-56087-nwalsh.com.ns.xslt.functions.fletcher16,5">f:fletcher16()</a></div><div class="used-in"><span class="marker"></span>Used in: <a href="#S-56087">parse.xsl</a></div></div></div></div></div><div class="instructions"><div class="title closed">FIXME: comments</div><div class="body"><div id="S-56087-c-1" class="instruction comment"><div class="title"><span class="link" title="Line 13"><a href="#line-d47615e37-13" class="goto-lno">§</a></span>Comment</div><div class="props">FIXME: Implement XPath parsing as an extension function.</div></div></div></div><div class="source-code"><div class="title closed">Source code</div><div class="body"><div><table><tr><td valign="top" align="right"><pre class="fake-prism"><span id="line-d47615e37-1">1</span>
<span id="line-d47615e37-2"><span class="lno">2</span></span>
<span id="line-d47615e37-3"><span class="lno">3</span></span>
<span id="line-d47615e37-4"><span class="lno">4</span></span>
<span id="line-d47615e37-5">5</span>
<span id="line-d47615e37-6"><span class="lno">6</span></span>
<span id="line-d47615e37-7"><span class="lno">7</span></span>
<span id="line-d47615e37-8"><span class="lno">8</span></span>
<span id="line-d47615e37-9"><span class="lno">9</span></span>
<span id="line-d47615e37-10">10</span>
<span id="line-d47615e37-11"><span class="lno">11</span></span>
<span id="line-d47615e37-12"><span class="lno">12</span></span>
<span id="line-d47615e37-13"><span class="lno">13</span></span>
<span id="line-d47615e37-14"><span class="lno">14</span></span>
<span id="line-d47615e37-15">15</span>
<span id="line-d47615e37-16"><span class="lno">16</span></span>
<span id="line-d47615e37-17"><span class="lno">17</span></span>
<span id="line-d47615e37-18"><span class="lno">18</span></span>
<span id="line-d47615e37-19"><span class="lno">19</span></span>
<span id="line-d47615e37-20">20</span>
<span id="line-d47615e37-21"><span class="lno">21</span></span>
<span id="line-d47615e37-22"><span class="lno">22</span></span>
<span id="line-d47615e37-23"><span class="lno">23</span></span>
<span id="line-d47615e37-24"><span class="lno">24</span></span>
<span id="line-d47615e37-25">25</span>
<span id="line-d47615e37-26"><span class="lno">26</span></span>
<span id="line-d47615e37-27"><span class="lno">27</span></span>
<span id="line-d47615e37-28"><span class="lno">28</span></span>
<span id="line-d47615e37-29"><span class="lno">29</span></span>
<span id="line-d47615e37-30">30</span>
<span id="line-d47615e37-31"><span class="lno">31</span></span>
<span id="line-d47615e37-32"><span class="lno">32</span></span>
<span id="line-d47615e37-33"><span class="lno">33</span></span>
<span id="line-d47615e37-34"><span class="lno">34</span></span>
<span id="line-d47615e37-35">35</span>
<span id="line-d47615e37-36"><span class="lno">36</span></span>
<span id="line-d47615e37-37"><span class="lno">37</span></span>
<span id="line-d47615e37-38"><span class="lno">38</span></span>
<span id="line-d47615e37-39"><span class="lno">39</span></span>
<span id="line-d47615e37-40">40</span>
<span id="line-d47615e37-41"><span class="lno">41</span></span>
<span id="line-d47615e37-42"><span class="lno">42</span></span>
<span id="line-d47615e37-43"><span class="lno">43</span></span>
<span id="line-d47615e37-44"><span class="lno">44</span></span>
<span id="line-d47615e37-45">45</span>
<span id="line-d47615e37-46"><span class="lno">46</span></span>
<span id="line-d47615e37-47"><span class="lno">47</span></span>
<span id="line-d47615e37-48"><span class="lno">48</span></span>
<span id="line-d47615e37-49"><span class="lno">49</span></span>
<span id="line-d47615e37-50">50</span>
<span id="line-d47615e37-51"><span class="lno">51</span></span>
<span id="line-d47615e37-52"><span class="lno">52</span></span>
<span id="line-d47615e37-53"><span class="lno">53</span></span>
<span id="line-d47615e37-54"><span class="lno">54</span></span>
<span id="line-d47615e37-55">55</span>
<span id="line-d47615e37-56"><span class="lno">56</span></span>
<span id="line-d47615e37-57"><span class="lno">57</span></span>
<span id="line-d47615e37-58"><span class="lno">58</span></span>
<span id="line-d47615e37-59"><span class="lno">59</span></span>
<span id="line-d47615e37-60">60</span>
<span id="line-d47615e37-61"><span class="lno">61</span></span>
<span id="line-d47615e37-62"><span class="lno">62</span></span>
<span id="line-d47615e37-63"><span class="lno">63</span></span>
<span id="line-d47615e37-64"><span class="lno">64</span></span>
<span id="line-d47615e37-65">65</span>
<span id="line-d47615e37-66"><span class="lno">66</span></span>
<span id="line-d47615e37-67"><span class="lno">67</span></span>
<span id="line-d47615e37-68"><span class="lno">68</span></span>
<span id="line-d47615e37-69"><span class="lno">69</span></span>
<span id="line-d47615e37-70">70</span>
<span id="line-d47615e37-71"><span class="lno">71</span></span>
<span id="line-d47615e37-72"><span class="lno">72</span></span>
<span id="line-d47615e37-73"><span class="lno">73</span></span>
<span id="line-d47615e37-74"><span class="lno">74</span></span>
<span id="line-d47615e37-75">75</span>
<span id="line-d47615e37-76"><span class="lno">76</span></span>
<span id="line-d47615e37-77"><span class="lno">77</span></span>
<span id="line-d47615e37-78"><span class="lno">78</span></span>
<span id="line-d47615e37-79"><span class="lno">79</span></span>
<span id="line-d47615e37-80">80</span>
<span id="line-d47615e37-81"><span class="lno">81</span></span>
<span id="line-d47615e37-82"><span class="lno">82</span></span>
<span id="line-d47615e37-83"><span class="lno">83</span></span>
<span id="line-d47615e37-84"><span class="lno">84</span></span>
<span id="line-d47615e37-85">85</span>
<span id="line-d47615e37-86"><span class="lno">86</span></span>
<span id="line-d47615e37-87"><span class="lno">87</span></span>
<span id="line-d47615e37-88"><span class="lno">88</span></span>
<span id="line-d47615e37-89"><span class="lno">89</span></span>
<span id="line-d47615e37-90">90</span>
<span id="line-d47615e37-91"><span class="lno">91</span></span>
<span id="line-d47615e37-92"><span class="lno">92</span></span>
<span id="line-d47615e37-93"><span class="lno">93</span></span>
<span id="line-d47615e37-94"><span class="lno">94</span></span>
<span id="line-d47615e37-95">95</span>
<span id="line-d47615e37-96"><span class="lno">96</span></span>
<span id="line-d47615e37-97"><span class="lno">97</span></span>
<span id="line-d47615e37-98"><span class="lno">98</span></span>
<span id="line-d47615e37-99"><span class="lno">99</span></span>
<span id="line-d47615e37-100">100</span>
<span id="line-d47615e37-101"><span class="lno">101</span></span>
<span id="line-d47615e37-102"><span class="lno">102</span></span>
<span id="line-d47615e37-103"><span class="lno">103</span></span>
<span id="line-d47615e37-104"><span class="lno">104</span></span>
<span id="line-d47615e37-105">105</span>
<span id="line-d47615e37-106"><span class="lno">106</span></span>
<span id="line-d47615e37-107"><span class="lno">107</span></span>
<span id="line-d47615e37-108"><span class="lno">108</span></span>
<span id="line-d47615e37-109"><span class="lno">109</span></span>
<span id="line-d47615e37-110">110</span>
<span id="line-d47615e37-111"><span class="lno">111</span></span>
<span id="line-d47615e37-112"><span class="lno">112</span></span>
<span id="line-d47615e37-113"><span class="lno">113</span></span>
<span id="line-d47615e37-114"><span class="lno">114</span></span>
<span id="line-d47615e37-115">115</span>
<span id="line-d47615e37-116"><span class="lno">116</span></span>
<span id="line-d47615e37-117"><span class="lno">117</span></span>
<span id="line-d47615e37-118"><span class="lno">118</span></span>
<span id="line-d47615e37-119"><span class="lno">119</span></span>
<span id="line-d47615e37-120">120</span>
<span id="line-d47615e37-121"><span class="lno">121</span></span>
<span id="line-d47615e37-122"><span class="lno">122</span></span>
<span id="line-d47615e37-123"><span class="lno">123</span></span>
<span id="line-d47615e37-124"><span class="lno">124</span></span>
<span id="line-d47615e37-125">125</span>
<span id="line-d47615e37-126"><span class="lno">126</span></span>
<span id="line-d47615e37-127"><span class="lno">127</span></span>
<span id="line-d47615e37-128"><span class="lno">128</span></span>
<span id="line-d47615e37-129"><span class="lno">129</span></span>
<span id="line-d47615e37-130">130</span>
<span id="line-d47615e37-131"><span class="lno">131</span></span>
<span id="line-d47615e37-132"><span class="lno">132</span></span>
<span id="line-d47615e37-133"><span class="lno">133</span></span>
<span id="line-d47615e37-134"><span class="lno">134</span></span>
<span id="line-d47615e37-135">135</span>
<span id="line-d47615e37-136"><span class="lno">136</span></span>
<span id="line-d47615e37-137"><span class="lno">137</span></span>
<span id="line-d47615e37-138"><span class="lno">138</span></span>
<span id="line-d47615e37-139"><span class="lno">139</span></span>
<span id="line-d47615e37-140">140</span>
<span id="line-d47615e37-141"><span class="lno">141</span></span>
<span id="line-d47615e37-142"><span class="lno">142</span></span>
<span id="line-d47615e37-143"><span class="lno">143</span></span>
<span id="line-d47615e37-144"><span class="lno">144</span></span>
<span id="line-d47615e37-145">145</span>
<span id="line-d47615e37-146"><span class="lno">146</span></span>
<span id="line-d47615e37-147"><span class="lno">147</span></span>
<span id="line-d47615e37-148"><span class="lno">148</span></span>
<span id="line-d47615e37-149"><span class="lno">149</span></span>
<span id="line-d47615e37-150">150</span>
<span id="line-d47615e37-151"><span class="lno">151</span></span>
<span id="line-d47615e37-152"><span class="lno">152</span></span>
<span id="line-d47615e37-153"><span class="lno">153</span></span>
<span id="line-d47615e37-154"><span class="lno">154</span></span>
<span id="line-d47615e37-155">155</span>
<span id="line-d47615e37-156"><span class="lno">156</span></span>
<span id="line-d47615e37-157"><span class="lno">157</span></span>
<span id="line-d47615e37-158"><span class="lno">158</span></span>
<span id="line-d47615e37-159"><span class="lno">159</span></span>
<span id="line-d47615e37-160">160</span>
<span id="line-d47615e37-161"><span class="lno">161</span></span>
<span id="line-d47615e37-162"><span class="lno">162</span></span>
<span id="line-d47615e37-163"><span class="lno">163</span></span>
<span id="line-d47615e37-164"><span class="lno">164</span></span>
<span id="line-d47615e37-165">165</span>
<span id="line-d47615e37-166"><span class="lno">166</span></span>
<span id="line-d47615e37-167"><span class="lno">167</span></span>
<span id="line-d47615e37-168"><span class="lno">168</span></span>
<span id="line-d47615e37-169"><span class="lno">169</span></span>
<span id="line-d47615e37-170">170</span>
<span id="line-d47615e37-171"><span class="lno">171</span></span>
<span id="line-d47615e37-172"><span class="lno">172</span></span>
<span id="line-d47615e37-173"><span class="lno">173</span></span>
<span id="line-d47615e37-174"><span class="lno">174</span></span>
<span id="line-d47615e37-175">175</span>
<span id="line-d47615e37-176"><span class="lno">176</span></span>
<span id="line-d47615e37-177"><span class="lno">177</span></span>
<span id="line-d47615e37-178"><span class="lno">178</span></span>
<span id="line-d47615e37-179"><span class="lno">179</span></span>
<span id="line-d47615e37-180">180</span>
<span id="line-d47615e37-181"><span class="lno">181</span></span>
<span id="line-d47615e37-182"><span class="lno">182</span></span>
<span id="line-d47615e37-183"><span class="lno">183</span></span>
<span id="line-d47615e37-184"><span class="lno">184</span></span>
<span id="line-d47615e37-185">185</span>
<span id="line-d47615e37-186"><span class="lno">186</span></span>
<span id="line-d47615e37-187"><span class="lno">187</span></span>
<span id="line-d47615e37-188"><span class="lno">188</span></span>
<span id="line-d47615e37-189"><span class="lno">189</span></span>
<span id="line-d47615e37-190">190</span>
<span id="line-d47615e37-191"><span class="lno">191</span></span>
<span id="line-d47615e37-192"><span class="lno">192</span></span>
<span id="line-d47615e37-193"><span class="lno">193</span></span>
<span id="line-d47615e37-194"><span class="lno">194</span></span>
<span id="line-d47615e37-195">195</span>
<span id="line-d47615e37-196"><span class="lno">196</span></span>
<span id="line-d47615e37-197"><span class="lno">197</span></span>
<span id="line-d47615e37-198"><span class="lno">198</span></span>
<span id="line-d47615e37-199"><span class="lno">199</span></span>
<span id="line-d47615e37-200">200</span>
<span id="line-d47615e37-201"><span class="lno">201</span></span>
<span id="line-d47615e37-202"><span class="lno">202</span></span>
<span id="line-d47615e37-203"><span class="lno">203</span></span>
<span id="line-d47615e37-204"><span class="lno">204</span></span>
<span id="line-d47615e37-205">205</span>
<span id="line-d47615e37-206"><span class="lno">206</span></span>
<span id="line-d47615e37-207"><span class="lno">207</span></span>
<span id="line-d47615e37-208"><span class="lno">208</span></span>
<span id="line-d47615e37-209"><span class="lno">209</span></span>
<span id="line-d47615e37-210">210</span>
<span id="line-d47615e37-211"><span class="lno">211</span></span>
<span id="line-d47615e37-212"><span class="lno">212</span></span>
<span id="line-d47615e37-213"><span class="lno">213</span></span>
<span id="line-d47615e37-214"><span class="lno">214</span></span>
<span id="line-d47615e37-215">215</span>
<span id="line-d47615e37-216"><span class="lno">216</span></span>
<span id="line-d47615e37-217"><span class="lno">217</span></span>
<span id="line-d47615e37-218"><span class="lno">218</span></span>
<span id="line-d47615e37-219"><span class="lno">219</span></span>
<span id="line-d47615e37-220">220</span>
<span id="line-d47615e37-221"><span class="lno">221</span></span>
<span id="line-d47615e37-222"><span class="lno">222</span></span>
<span id="line-d47615e37-223"><span class="lno">223</span></span>
<span id="line-d47615e37-224"><span class="lno">224</span></span>
<span id="line-d47615e37-225">225</span>
<span id="line-d47615e37-226"><span class="lno">226</span></span>
<span id="line-d47615e37-227"><span class="lno">227</span></span>
<span id="line-d47615e37-228"><span class="lno">228</span></span>
<span id="line-d47615e37-229"><span class="lno">229</span></span>
<span id="line-d47615e37-230">230</span>
<span id="line-d47615e37-231"><span class="lno">231</span></span>
<span id="line-d47615e37-232"><span class="lno">232</span></span>
<span id="line-d47615e37-233"><span class="lno">233</span></span>
<span id="line-d47615e37-234"><span class="lno">234</span></span>
<span id="line-d47615e37-235">235</span>
<span id="line-d47615e37-236"><span class="lno">236</span></span>
<span id="line-d47615e37-237"><span class="lno">237</span></span>
<span id="line-d47615e37-238"><span class="lno">238</span></span>
<span id="line-d47615e37-239"><span class="lno">239</span></span>
<span id="line-d47615e37-240">240</span>
<span id="line-d47615e37-241"><span class="lno">241</span></span>
<span id="line-d47615e37-242"><span class="lno">242</span></span>
<span id="line-d47615e37-243"><span class="lno">243</span></span>
<span id="line-d47615e37-244"><span class="lno">244</span></span>
<span id="line-d47615e37-245">245</span>
<span id="line-d47615e37-246"><span class="lno">246</span></span>
<span id="line-d47615e37-247"><span class="lno">247</span></span>
<span id="line-d47615e37-248"><span class="lno">248</span></span>
<span id="line-d47615e37-249"><span class="lno">249</span></span>
<span id="line-d47615e37-250">250</span>
<span id="line-d47615e37-251"><span class="lno">251</span></span>
<span id="line-d47615e37-252"><span class="lno">252</span></span>
<span id="line-d47615e37-253"><span class="lno">253</span></span>
<span id="line-d47615e37-254"><span class="lno">254</span></span>
<span id="line-d47615e37-255">255</span>
<span id="line-d47615e37-256"><span class="lno">256</span></span>
<span id="line-d47615e37-257"><span class="lno">257</span></span>
<span id="line-d47615e37-258"><span class="lno">258</span></span>
<span id="line-d47615e37-259"><span class="lno">259</span></span>
<span id="line-d47615e37-260">260</span>
<span id="line-d47615e37-261"><span class="lno">261</span></span>
<span id="line-d47615e37-262"><span class="lno">262</span></span>
<span id="line-d47615e37-263"><span class="lno">263</span></span>
<span id="line-d47615e37-264"><span class="lno">264</span></span>
<span id="line-d47615e37-265">265</span>
<span id="line-d47615e37-266"><span class="lno">266</span></span>
<span id="line-d47615e37-267"><span class="lno">267</span></span>
<span id="line-d47615e37-268"><span class="lno">268</span></span>
<span id="line-d47615e37-269"><span class="lno">269</span></span>
<span id="line-d47615e37-270">270</span>
<span id="line-d47615e37-271"><span class="lno">271</span></span>
<span id="line-d47615e37-272"><span class="lno">272</span></span>
<span id="line-d47615e37-273"><span class="lno">273</span></span>
<span id="line-d47615e37-274"><span class="lno">274</span></span>
<span id="line-d47615e37-275">275</span>
<span id="line-d47615e37-276"><span class="lno">276</span></span>
<span id="line-d47615e37-277"><span class="lno">277</span></span>
<span id="line-d47615e37-278"><span class="lno">278</span></span>
<span id="line-d47615e37-279"><span class="lno">279</span></span>
<span id="line-d47615e37-280">280</span>
<span id="line-d47615e37-281"><span class="lno">281</span></span>
<span id="line-d47615e37-282"><span class="lno">282</span></span>
<span id="line-d47615e37-283"><span class="lno">283</span></span>
<span id="line-d47615e37-284"><span class="lno">284</span></span>
<span id="line-d47615e37-285">285</span>
<span id="line-d47615e37-286"><span class="lno">286</span></span>
<span id="line-d47615e37-287"><span class="lno">287</span></span>
<span id="line-d47615e37-288"><span class="lno">288</span></span>
<span id="line-d47615e37-289"><span class="lno">289</span></span>
<span id="line-d47615e37-290">290</span>
<span id="line-d47615e37-291"><span class="lno">291</span></span>
<span id="line-d47615e37-292"><span class="lno">292</span></span>
<span id="line-d47615e37-293"><span class="lno">293</span></span>
<span id="line-d47615e37-294"><span class="lno">294</span></span>
<span id="line-d47615e37-295">295</span>
<span id="line-d47615e37-296"><span class="lno">296</span></span>
<span id="line-d47615e37-297"><span class="lno">297</span></span>
<span id="line-d47615e37-298"><span class="lno">298</span></span>
<span id="line-d47615e37-299"><span class="lno">299</span></span>
<span id="line-d47615e37-300">300</span>
<span id="line-d47615e37-301"><span class="lno">301</span></span>
<span id="line-d47615e37-302"><span class="lno">302</span></span>
<span id="line-d47615e37-303"><span class="lno">303</span></span>
<span id="line-d47615e37-304"><span class="lno">304</span></span>
<span id="line-d47615e37-305">305</span>
<span id="line-d47615e37-306"><span class="lno">306</span></span>
<span id="line-d47615e37-307"><span class="lno">307</span></span>
<span id="line-d47615e37-308"><span class="lno">308</span></span>
<span id="line-d47615e37-309"><span class="lno">309</span></span>
<span id="line-d47615e37-310">310</span>
<span id="line-d47615e37-311"><span class="lno">311</span></span>
<span id="line-d47615e37-312"><span class="lno">312</span></span>
<span id="line-d47615e37-313"><span class="lno">313</span></span>
<span id="line-d47615e37-314"><span class="lno">314</span></span>
<span id="line-d47615e37-315">315</span>
<span id="line-d47615e37-316"><span class="lno">316</span></span>
<span id="line-d47615e37-317"><span class="lno">317</span></span>
<span id="line-d47615e37-318"><span class="lno">318</span></span>
<span id="line-d47615e37-319"><span class="lno">319</span></span>
<span id="line-d47615e37-320">320</span>
<span id="line-d47615e37-321"><span class="lno">321</span></span>
<span id="line-d47615e37-322"><span class="lno">322</span></span>
<span id="line-d47615e37-323"><span class="lno">323</span></span>
<span id="line-d47615e37-324"><span class="lno">324</span></span>
<span id="line-d47615e37-325">325</span>
<span id="line-d47615e37-326"><span class="lno">326</span></span>
<span id="line-d47615e37-327"><span class="lno">327</span></span>
<span id="line-d47615e37-328"><span class="lno">328</span></span>
<span id="line-d47615e37-329"><span class="lno">329</span></span>
<span id="line-d47615e37-330">330</span>
<span id="line-d47615e37-331"><span class="lno">331</span></span>
<span id="line-d47615e37-332"><span class="lno">332</span></span>
<span id="line-d47615e37-333"><span class="lno">333</span></span>
<span id="line-d47615e37-334"><span class="lno">334</span></span>
<span id="line-d47615e37-335">335</span>
<span id="line-d47615e37-336"><span class="lno">336</span></span>
<span id="line-d47615e37-337"><span class="lno">337</span></span>
<span id="line-d47615e37-338"><span class="lno">338</span></span>
<span id="line-d47615e37-339"><span class="lno">339</span></span>
<span id="line-d47615e37-340">340</span>
<span id="line-d47615e37-341"><span class="lno">341</span></span>
<span id="line-d47615e37-342"><span class="lno">342</span></span>
<span id="line-d47615e37-343"><span class="lno">343</span></span>
<span id="line-d47615e37-344"><span class="lno">344</span></span>
<span id="line-d47615e37-345">345</span>
<span id="line-d47615e37-346"><span class="lno">346</span></span>
<span id="line-d47615e37-347"><span class="lno">347</span></span>
<span id="line-d47615e37-348"><span class="lno">348</span></span>
<span id="line-d47615e37-349"><span class="lno">349</span></span>
<span id="line-d47615e37-350">350</span>
<span id="line-d47615e37-351"><span class="lno">351</span></span>
<span id="line-d47615e37-352"><span class="lno">352</span></span>
<span id="line-d47615e37-353"><span class="lno">353</span></span>
<span id="line-d47615e37-354"><span class="lno">354</span></span>
<span id="line-d47615e37-355">355</span>
<span id="line-d47615e37-356"><span class="lno">356</span></span>
<span id="line-d47615e37-357"><span class="lno">357</span></span>
<span id="line-d47615e37-358"><span class="lno">358</span></span>
<span id="line-d47615e37-359"><span class="lno">359</span></span>
<span id="line-d47615e37-360">360</span>
<span id="line-d47615e37-361"><span class="lno">361</span></span>
<span id="line-d47615e37-362"><span class="lno">362</span></span>
<span id="line-d47615e37-363"><span class="lno">363</span></span>
<span id="line-d47615e37-364"><span class="lno">364</span></span>
<span id="line-d47615e37-365">365</span>
<span id="line-d47615e37-366"><span class="lno">366</span></span>
<span id="line-d47615e37-367"><span class="lno">367</span></span>
<span id="line-d47615e37-368"><span class="lno">368</span></span>
<span id="line-d47615e37-369"><span class="lno">369</span></span>
<span id="line-d47615e37-370">370</span>
<span id="line-d47615e37-371"><span class="lno">371</span></span>
<span id="line-d47615e37-372"><span class="lno">372</span></span>
<span id="line-d47615e37-373"><span class="lno">373</span></span>
<span id="line-d47615e37-374"><span class="lno">374</span></span>
<span id="line-d47615e37-375">375</span>
<span id="line-d47615e37-376"><span class="lno">376</span></span>
<span id="line-d47615e37-377"><span class="lno">377</span></span>
<span id="line-d47615e37-378"><span class="lno">378</span></span>
<span id="line-d47615e37-379"><span class="lno">379</span></span>
<span id="line-d47615e37-380">380</span>
<span id="line-d47615e37-381"><span class="lno">381</span></span>
<span id="line-d47615e37-382"><span class="lno">382</span></span>
<span id="line-d47615e37-383"><span class="lno">383</span></span>
<span id="line-d47615e37-384"><span class="lno">384</span></span>
<span id="line-d47615e37-385">385</span>
<span id="line-d47615e37-386"><span class="lno">386</span></span>
<span id="line-d47615e37-387"><span class="lno">387</span></span>
<span id="line-d47615e37-388"><span class="lno">388</span></span>
<span id="line-d47615e37-389"><span class="lno">389</span></span>
<span id="line-d47615e37-390">390</span>
<span id="line-d47615e37-391"><span class="lno">391</span></span>
<span id="line-d47615e37-392"><span class="lno">392</span></span>
<span id="line-d47615e37-393"><span class="lno">393</span></span>
<span id="line-d47615e37-394"><span class="lno">394</span></span>
<span id="line-d47615e37-395">395</span>
<span id="line-d47615e37-396"><span class="lno">396</span></span>
<span id="line-d47615e37-397"><span class="lno">397</span></span>
<span id="line-d47615e37-398"><span class="lno">398</span></span>
<span id="line-d47615e37-399"><span class="lno">399</span></span>
<span id="line-d47615e37-400">400</span>
<span id="line-d47615e37-401"><span class="lno">401</span></span>
<span id="line-d47615e37-402"><span class="lno">402</span></span>
<span id="line-d47615e37-403"><span class="lno">403</span></span>
<span id="line-d47615e37-404"><span class="lno">404</span></span>
<span id="line-d47615e37-405">405</span>
<span id="line-d47615e37-406"><span class="lno">406</span></span>
<span id="line-d47615e37-407"><span class="lno">407</span></span>
<span id="line-d47615e37-408"><span class="lno">408</span></span>
<span id="line-d47615e37-409"><span class="lno">409</span></span>
<span id="line-d47615e37-410">410</span>
<span id="line-d47615e37-411"><span class="lno">411</span></span>
<span id="line-d47615e37-412"><span class="lno">412</span></span>
<span id="line-d47615e37-413"><span class="lno">413</span></span>
<span id="line-d47615e37-414"><span class="lno">414</span></span>
<span id="line-d47615e37-415">415</span>
<span id="line-d47615e37-416"><span class="lno">416</span></span>
<span id="line-d47615e37-417"><span class="lno">417</span></span>
<span id="line-d47615e37-418"><span class="lno">418</span></span>
<span id="line-d47615e37-419"><span class="lno">419</span></span>
<span id="line-d47615e37-420">420</span>
<span id="line-d47615e37-421"><span class="lno">421</span></span>
<span id="line-d47615e37-422"><span class="lno">422</span></span>
<span id="line-d47615e37-423"><span class="lno">423</span></span>
<span id="line-d47615e37-424"><span class="lno">424</span></span>
<span id="line-d47615e37-425">425</span>
<span id="line-d47615e37-426"><span class="lno">426</span></span>
<span id="line-d47615e37-427"><span class="lno">427</span></span>
<span id="line-d47615e37-428"><span class="lno">428</span></span>
<span id="line-d47615e37-429"><span class="lno">429</span></span>
<span id="line-d47615e37-430">430</span>
<span id="line-d47615e37-431"><span class="lno">431</span></span>
<span id="line-d47615e37-432"><span class="lno">432</span></span>
<span id="line-d47615e37-433"><span class="lno">433</span></span>
<span id="line-d47615e37-434"><span class="lno">434</span></span>
<span id="line-d47615e37-435">435</span>
<span id="line-d47615e37-436"><span class="lno">436</span></span>
<span id="line-d47615e37-437"><span class="lno">437</span></span>
<span id="line-d47615e37-438"><span class="lno">438</span></span>
<span id="line-d47615e37-439"><span class="lno">439</span></span>
<span id="line-d47615e37-440">440</span>
<span id="line-d47615e37-441"><span class="lno">441</span></span>
<span id="line-d47615e37-442"><span class="lno">442</span></span>
<span id="line-d47615e37-443"><span class="lno">443</span></span>
<span id="line-d47615e37-444"><span class="lno">444</span></span>
<span id="line-d47615e37-445">445</span>
<span id="line-d47615e37-446"><span class="lno">446</span></span>
<span id="line-d47615e37-447"><span class="lno">447</span></span>
<span id="line-d47615e37-448"><span class="lno">448</span></span>
<span id="line-d47615e37-449"><span class="lno">449</span></span>
<span id="line-d47615e37-450">450</span>
<span id="line-d47615e37-451"><span class="lno">451</span></span>
<span id="line-d47615e37-452"><span class="lno">452</span></span>
<span id="line-d47615e37-453"><span class="lno">453</span></span>
<span id="line-d47615e37-454"><span class="lno">454</span></span>
<span id="line-d47615e37-455">455</span>
<span id="line-d47615e37-456"><span class="lno">456</span></span>
<span id="line-d47615e37-457"><span class="lno">457</span></span>
</pre></td><td valign="top"><pre><code class="language-xml">&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
                xmlns:a="http://nwalsh.com/ns/xslt/analysis"
                xmlns:f="http://nwalsh.com/ns/xslt/functions"
                xmlns:m="http://nwalsh.com/ns/xslt/modes"
                xmlns:p="xpath-31"
                xmlns:xs="http://www.w3.org/2001/XMLSchema"
                xmlns="http://nwalsh.com/ns/xslt/analysis"
                default-mode="m:parse"
                exclude-result-prefixes="a f m p xs"
                version="3.0"&gt;

&lt;!-- FIXME: Implement XPath parsing as an extension function. --&gt;
&lt;?xsltexplorer-skip-import?&gt;
&lt;xsl:import href="xpath-31.xslt"/&gt;

&lt;xsl:param name="fixme" select="'FIXME:'"/&gt;

&lt;xsl:template match="/"&gt;
  &lt;xsl:apply-templates/&gt;
&lt;/xsl:template&gt;

&lt;xsl:template match="xsl:stylesheet|xsl:transform"&gt;
  &lt;xsl:param name="href" as="xs:string?" select="()"/&gt;
  &lt;xsl:param name="extra-attributes" as="attribute()*" select="()"/&gt;

  &lt;stylesheet id="{f:encode-for-id(f:unique-id(.))}"&gt;
    &lt;xsl:copy-of select="namespace::*[local-name(.) != '']"/&gt;
    &lt;xsl:attribute name="xml:base" select="resolve-uri(base-uri(.))"/&gt;
    &lt;xsl:if test="$href"&gt;
      &lt;xsl:attribute name="href" select="$href"/&gt;
    &lt;/xsl:if&gt;
    &lt;xsl:sequence select="if (exists($extra-attributes))
                          then $extra-attributes
                          else f:source-location(.)"/&gt;
    &lt;xsl:apply-templates select="@*"/&gt;
    &lt;xsl:apply-templates/&gt;
  &lt;/stylesheet&gt;
&lt;/xsl:template&gt;

&lt;xsl:template match="xsl:import"&gt;
  &lt;xsl:variable name="pi"
                select="preceding-sibling::node()[not(self::text())][1]"/&gt;
  &lt;xsl:if test="not($pi/self::processing-instruction('xsltexplorer-skip-import'))"&gt;
    &lt;xsl:message select="'Importing', @href/string(), '…'"/&gt;
    &lt;xsl:apply-templates select="doc(resolve-uri(@href, base-uri(.)))/node()"&gt;
      &lt;xsl:with-param name="href" select="@href/string()"/&gt;
      &lt;xsl:with-param name="extra-attributes" as="attribute()+"&gt;
        &lt;xsl:sequence select="f:source-location(.)"/&gt;
        &lt;xsl:attribute name="transclusion" select="'import'"/&gt;
      &lt;/xsl:with-param&gt;
    &lt;/xsl:apply-templates&gt;
  &lt;/xsl:if&gt;
&lt;/xsl:template&gt;

&lt;xsl:template match="xsl:include"&gt;
  &lt;xsl:variable name="pi"
                select="preceding-sibling::node()[not(self::text())][1]"/&gt;
  &lt;xsl:if test="not(preceding-sibling
                    ::processing-instruction('xsltexplorer-skip-include'))"&gt;
    &lt;xsl:message select="'Including', @href/string(), '…'"/&gt;
    &lt;xsl:apply-templates select="doc(resolve-uri(@href, base-uri(.)))/node()"&gt;
      &lt;xsl:with-param name="href" select="@href/string()"/&gt;
      &lt;xsl:with-param name="extra-attributes" as="attribute()+"&gt;
        &lt;xsl:sequence select="f:source-location(.)"/&gt;
        &lt;xsl:attribute name="transclusion" select="'include'"/&gt;
      &lt;/xsl:with-param&gt;
    &lt;/xsl:apply-templates&gt;
  &lt;/xsl:if&gt;
&lt;/xsl:template&gt;

&lt;xsl:template match="xsl:template"&gt;
  &lt;xsl:message use-when="false()" select="'xsl:template', @name/string()"/&gt;

  &lt;xsl:variable name="match" as="xs:string*"&gt;
    &lt;xsl:for-each select="tokenize(@match, '\|')"&gt;
      &lt;xsl:sequence select="if (contains(., '['))
                            then normalize-space(substring-before(., '['))
                            else normalize-space(.)"/&gt;
    &lt;/xsl:for-each&gt;
  &lt;/xsl:variable&gt;

  &lt;xsl:variable name="match" as="xs:string*"&gt;
    &lt;xsl:for-each select="distinct-values($match)"&gt;
      &lt;xsl:sort select="."/&gt;
      &lt;xsl:sequence select="."/&gt;
    &lt;/xsl:for-each&gt;
  &lt;/xsl:variable&gt;

  &lt;xsl:variable name="mode" as="xs:string?"&gt;
    &lt;xsl:choose&gt;
      &lt;xsl:when test="@mode"&gt;
        &lt;xsl:sequence select="f:clark-name(@mode)"/&gt;
      &lt;/xsl:when&gt;
      &lt;xsl:when test="ancestor::xsl:stylesheet[1]/@default-mode"&gt;
        &lt;xsl:sequence select="f:clark-name(ancestor::xsl:stylesheet[1]/@default-mode)"/&gt;
      &lt;/xsl:when&gt;
      &lt;xsl:otherwise&gt;
        &lt;xsl:sequence select="()"/&gt;
      &lt;/xsl:otherwise&gt;
    &lt;/xsl:choose&gt;
  &lt;/xsl:variable&gt;

  &lt;xsl:variable name="display-mode" as="xs:string?"&gt;
    &lt;xsl:choose&gt;
      &lt;xsl:when test="@mode"&gt;
        &lt;xsl:sequence select="@mode/string()"/&gt;
      &lt;/xsl:when&gt;
      &lt;xsl:when test="ancestor::xsl:stylesheet[1]/@default-mode"&gt;
        &lt;xsl:sequence select="ancestor::xsl:stylesheet[1]/@default-mode/string()"/&gt;
      &lt;/xsl:when&gt;
      &lt;xsl:otherwise&gt;
        &lt;xsl:sequence select="()"/&gt;
      &lt;/xsl:otherwise&gt;
    &lt;/xsl:choose&gt;
  &lt;/xsl:variable&gt;

  &lt;template id="{f:encode-for-id(f:unique-id(.))}"&gt;
    &lt;xsl:if test="@name"&gt;
      &lt;xsl:attribute name="display-name" select="@name"/&gt;
      &lt;xsl:attribute name="name" select="f:clark-name(@name)"/&gt;
    &lt;/xsl:if&gt;
    &lt;xsl:copy-of select="@priority,@as"/&gt;
    &lt;xsl:if test="exists($mode)"&gt;
      &lt;xsl:attribute name="mode" select="$mode"/&gt;
      &lt;xsl:attribute name="display-mode" select="$display-mode"/&gt;
    &lt;/xsl:if&gt;
    &lt;xsl:if test="exists($match)"&gt;
      &lt;xsl:attribute name="match" select="string-join($match,'|')"/&gt;
    &lt;/xsl:if&gt;
    &lt;xsl:sequence select="f:source-location(.)"/&gt;
    &lt;xsl:apply-templates select="@*"/&gt;
    &lt;xsl:apply-templates/&gt;
  &lt;/template&gt;
&lt;/xsl:template&gt;

&lt;xsl:template match="xsl:function"&gt;
  &lt;xsl:message use-when="false()" select="'xsl:function', @name/string()"/&gt;

  &lt;function id="{f:encode-for-id(f:unique-id(.)||'#'||count(xsl:param))}"
            noarity-id="{f:clark-name(@name)}"
            name="{f:clark-name(@name)}#{count(xsl:param)}"
            display-name="{@name}#{count(xsl:param)}"&gt;
    &lt;xsl:sequence select="f:source-location(.)"/&gt;
    &lt;xsl:copy-of select="@as"/&gt;
    &lt;xsl:apply-templates select="@*"/&gt;
    &lt;xsl:for-each select="xsl:param"&gt;
      &lt;param&gt;
        &lt;xsl:copy-of select="@name,@as"/&gt;
      &lt;/param&gt;
    &lt;/xsl:for-each&gt;
    &lt;xsl:apply-templates/&gt;
  &lt;/function&gt;
&lt;/xsl:template&gt;

&lt;xsl:template match="xsl:variable|xsl:param"&gt;
  &lt;xsl:message use-when="false()" select="node-name(.), @name/string()"/&gt;

  &lt;variable id="{f:encode-for-id(f:unique-id(.))}"
            class="{local-name(.)}"&gt;
    &lt;xsl:copy-of select="namespace::*[local-name(.) != '']"/&gt;
    &lt;xsl:attribute name="display-name" select="@name"/&gt;
    &lt;xsl:attribute name="name" select="f:clark-name(@name)"/&gt;
    &lt;xsl:copy-of select="@static,@as"/&gt;
    &lt;xsl:sequence select="f:source-location(.)"/&gt;
    &lt;xsl:apply-templates select="@*"/&gt;
    &lt;xsl:apply-templates/&gt;
  &lt;/variable&gt;
&lt;/xsl:template&gt;

&lt;xsl:template match="xsl:call-template"&gt;
  &lt;xsl:message use-when="false()" select="node-name(.), @name/string()"/&gt;

  &lt;call-template ref="{f:clark-name(@name)}"&gt;
    &lt;xsl:copy-of select="@name"/&gt;
    &lt;xsl:sequence select="f:source-location(.)"/&gt;
    &lt;xsl:apply-templates select="@*"/&gt;
    &lt;xsl:apply-templates/&gt;
  &lt;/call-template&gt;
&lt;/xsl:template&gt;

&lt;xsl:template match="xsl:apply-templates"&gt;
  &lt;xsl:message use-when="false()" select="node-name(.), @name/string()"/&gt;

  &lt;xsl:variable name="to" as="xs:string*"&gt;
    &lt;xsl:for-each select="tokenize(@select, '\|')"&gt;
      &lt;xsl:sequence select="if (contains(., '['))
                            then normalize-space(substring-before(., '['))
                            else normalize-space(.)"/&gt;
    &lt;/xsl:for-each&gt;
  &lt;/xsl:variable&gt;

  &lt;xsl:variable name="to" as="xs:string*"&gt;
    &lt;xsl:for-each select="distinct-values($to)"&gt;
      &lt;xsl:sort select="."/&gt;
      &lt;xsl:sequence select="."/&gt;
    &lt;/xsl:for-each&gt;
  &lt;/xsl:variable&gt;

  &lt;apply-templates&gt;
    &lt;xsl:if test="exists($to)"&gt;
      &lt;xsl:attribute name="to" select="string-join($to,'|')"/&gt;
    &lt;/xsl:if&gt;
    &lt;xsl:copy-of select="@name,@mode"/&gt;
    &lt;xsl:sequence select="f:source-location(.)"/&gt;
    &lt;xsl:apply-templates select="@*"/&gt;
    &lt;xsl:apply-templates/&gt;
  &lt;/apply-templates&gt;
&lt;/xsl:template&gt;

&lt;xsl:template match="element()"&gt;
  &lt;xsl:apply-templates select="@*"/&gt;
  &lt;xsl:apply-templates/&gt;
&lt;/xsl:template&gt;

&lt;xsl:template match="@select[namespace-uri(parent::*)
                             ='http://www.w3.org/1999/XSL/Transform']
                     |xsl:if/@test
                     |xsl:when/@test
                     |xsl:evaluate/@context-item
                     |xsl:evaluate/@xpath
                     |xsl:template/@match
                     |xsl:group-by/@group-by"&gt;
  &lt;xsl:sequence select="f:parse-expr(parent::*, .)"/&gt;
&lt;/xsl:template&gt;

&lt;xsl:template match="@*"&gt;
  &lt;xsl:if test="contains(string(.), '{')"&gt;
    &lt;!-- this is primitive --&gt;
    &lt;xsl:variable name="value" select="replace(., '\{\{', '')"/&gt;
    &lt;xsl:variable name="value" select="replace($value, '\}\}', '')"/&gt;
    &lt;xsl:sequence select="f:process-avts(parent::*, $value)"/&gt;
  &lt;/xsl:if&gt;
&lt;/xsl:template&gt;

&lt;xsl:template match="comment()"&gt;
  &lt;xsl:if test="contains(., $fixme)"&gt;
    &lt;comment id="{f:encode-for-id(f:unique-id(.))}"&gt;
      &lt;xsl:sequence select="f:source-location(.)"/&gt;
      &lt;xsl:sequence select="string(.)"/&gt;
    &lt;/comment&gt;
  &lt;/xsl:if&gt;
&lt;/xsl:template&gt;

&lt;xsl:template match="text()|processing-instruction()"/&gt;

&lt;!-- ============================================================ --&gt;

&lt;xsl:function name="f:process-avts"&gt;
  &lt;xsl:param name="context" as="element()"/&gt;
  &lt;xsl:param name="value" as="xs:string"/&gt;

  &lt;xsl:if test="contains($value, '{')"&gt;
    &lt;xsl:variable name="expr" select="substring-after($value, '{')"/&gt;
    &lt;xsl:variable name="rest" select="substring-after($expr, '}')"/&gt;
    &lt;xsl:variable name="expr" select="substring-before($expr, '}')"/&gt;
    &lt;xsl:sequence select="f:parse-expr($context, $expr)"/&gt;
    &lt;xsl:sequence select="f:process-avts($context, $rest)"/&gt;
  &lt;/xsl:if&gt;
&lt;/xsl:function&gt;

&lt;xsl:function name="f:parse-expr"&gt;
  &lt;xsl:param name="context" as="element()"/&gt;
  &lt;xsl:param name="expr" as="xs:string"/&gt;

  &lt;!-- If there are no $ signs and no parens, then there
       are no variable references or function calls, so
       don't bother trying to parse the whole thing --&gt;
  &lt;xsl:if test="contains($expr, '$') or contains($expr, '(')"&gt;
    &lt;xsl:variable name="parsetree"&gt;
      &lt;xsl:sequence select="p:parse-XPath($expr)"/&gt;
    &lt;/xsl:variable&gt;    

    &lt;xsl:variable name="functions" as="element()*"&gt;
      &lt;xsl:for-each select="$parsetree//FunctionCall"&gt;
        &lt;xsl:variable name="arity" select="count(ArgumentList/Argument)"/&gt;
        &lt;xsl:variable name="qname" select="FunctionEQName/FunctionName/QName"/&gt;

        &lt;xsl:variable name="ns" as="xs:string"&gt;
          &lt;xsl:choose&gt;
            &lt;xsl:when test="not(contains($qname, ':'))"&gt; &lt;!-- default --&gt;
              &lt;xsl:sequence select="'http://www.w3.org/2005/xpath-functions'"/&gt;
            &lt;/xsl:when&gt;
            &lt;xsl:otherwise&gt;
              &lt;xsl:variable name="prefix" select="substring-before($qname, ':')"/&gt;
              &lt;xsl:sequence select="namespace-uri-for-prefix($prefix, $context)"/&gt;
            &lt;/xsl:otherwise&gt;
          &lt;/xsl:choose&gt;
        &lt;/xsl:variable&gt;
        &lt;xsl:variable name="name"
                      select="if (contains($qname, ':'))
                              then substring-after($qname, ':')
                              else string($qname)"/&gt;
        &lt;xsl:variable name="id"
                      select="'{'||$ns||'}'||$name"/&gt;
        &lt;function-call name="{$qname}" ref="{$id}#{$arity}"&gt;
          &lt;xsl:copy-of select="$context/namespace::*[local-name(.) != '']"/&gt;
        &lt;/function-call&gt;
      &lt;/xsl:for-each&gt;
    &lt;/xsl:variable&gt;

    &lt;xsl:for-each-group select="$functions" group-by="@ref"&gt;
      &lt;xsl:sequence select="current-group()[1]"/&gt;
    &lt;/xsl:for-each-group&gt;

    &lt;xsl:variable name="variables" as="element()*"&gt;
      &lt;xsl:for-each select="$parsetree//VarRef//FunctionName/QName"&gt;
        &lt;xsl:variable name="ns" as="xs:string"&gt;
          &lt;xsl:choose&gt;
            &lt;xsl:when test="not(contains(., ':'))"&gt; &lt;!-- default --&gt;
              &lt;xsl:sequence select="''"/&gt;
            &lt;/xsl:when&gt;
            &lt;xsl:otherwise&gt;
              &lt;xsl:variable name="prefix" select="substring-before(., ':')"/&gt;
              &lt;xsl:sequence select="namespace-uri-for-prefix($prefix, $context)"/&gt;
            &lt;/xsl:otherwise&gt;
          &lt;/xsl:choose&gt;
        &lt;/xsl:variable&gt;
        &lt;xsl:variable name="name"
                      select="if (contains(., ':'))
                              then substring-after(., ':')
                              else string(.)"/&gt;
        &lt;xsl:variable name="id"
                      select="'{'||$ns||'}'||$name"/&gt;
        &lt;variable-ref name="{.}" ref="{$id}"&gt;
          &lt;xsl:copy-of select="$context/namespace::*[local-name(.) != '']"/&gt;
        &lt;/variable-ref&gt;
      &lt;/xsl:for-each&gt;
    &lt;/xsl:variable&gt;

    &lt;xsl:for-each-group select="$variables" group-by="@ref"&gt;
      &lt;xsl:sequence select="current-group()[1]"/&gt;
    &lt;/xsl:for-each-group&gt;
  &lt;/xsl:if&gt;
&lt;/xsl:function&gt;

&lt;!-- ============================================================ --&gt;

&lt;xsl:function name="f:unique-id" as="xs:string"&gt;
  &lt;xsl:param name="ref" as="node()"/&gt;

  &lt;xsl:variable name="prefix"
                select="if ($ref/self::xsl:stylesheet)
                        then ''
                        else f:unique-id($ref/ancestor::xsl:stylesheet[1]) || '-'"/&gt;

  &lt;xsl:choose&gt;
    &lt;xsl:when test="$ref/self::xsl:stylesheet"&gt;
      &lt;xsl:sequence select="'S-' || f:checksum(base-uri($ref))"/&gt;
    &lt;/xsl:when&gt;
    &lt;xsl:when test="$ref/@name"&gt;
      &lt;xsl:sequence select="$prefix || f:clark-name($ref/@name)"/&gt;
    &lt;/xsl:when&gt;
    &lt;xsl:when test="$ref/self::xsl:template"&gt;
      &lt;xsl:sequence select="$prefix || 't-' || (count($ref/preceding::xsl:template)+1)"/&gt;
    &lt;/xsl:when&gt;
    &lt;xsl:when test="$ref/self::comment()"&gt;
      &lt;xsl:sequence select="$prefix || 'c-' || (count($ref/preceding::comment())+1)"/&gt;
    &lt;/xsl:when&gt;
    &lt;xsl:otherwise&gt;
      &lt;xsl:sequence select="$prefix || generate-id($ref)"/&gt;
    &lt;/xsl:otherwise&gt;
  &lt;/xsl:choose&gt;
&lt;/xsl:function&gt;

&lt;xsl:function name="f:encode-for-id" as="xs:string"&gt;
  &lt;xsl:param name="name" as="xs:string"/&gt;

  &lt;xsl:variable name="id" select="replace($name, '\{https?:/+', '')"/&gt;
  &lt;xsl:variable name="id" select="translate($id, '{}/#', '...,')"/&gt;

  &lt;xsl:sequence select="$id"/&gt;
&lt;/xsl:function&gt;

&lt;xsl:function name="f:clark-name" as="xs:string"&gt;
  &lt;xsl:param name="node" as="node()"/&gt;
  &lt;xsl:choose&gt;
    &lt;xsl:when test="$node/self::attribute()"&gt;
      &lt;xsl:sequence select="f:clark-name($node/parent::*, string($node))"/&gt;
    &lt;/xsl:when&gt;
    &lt;xsl:otherwise&gt;
      &lt;xsl:sequence select="f:clark-name($node, string($node))"/&gt;
    &lt;/xsl:otherwise&gt;
  &lt;/xsl:choose&gt;
&lt;/xsl:function&gt;

&lt;xsl:function name="f:clark-name" as="xs:string"&gt;
  &lt;xsl:param name="node" as="node()"/&gt;
  &lt;xsl:param name="name" as="xs:string"/&gt;

  &lt;xsl:choose&gt;
    &lt;xsl:when test="contains($name, ':')"&gt;
      &lt;xsl:variable name="prefix" select="substring-before($name, ':')"/&gt;
      &lt;xsl:variable name="name" select="substring-after($name, ':')"/&gt;
      &lt;xsl:variable name="ns" select="namespace-uri-for-prefix($prefix, $node)"/&gt;
      &lt;xsl:sequence select="'{' || $ns || '}' || $name"/&gt;
    &lt;/xsl:when&gt;
    &lt;xsl:otherwise&gt;
      &lt;xsl:sequence select="'{}' || $name"/&gt;
    &lt;/xsl:otherwise&gt;
  &lt;/xsl:choose&gt;
&lt;/xsl:function&gt;

&lt;xsl:function name="f:source-location" as="attribute()*"&gt;
  &lt;xsl:param name="context" as="node()"/&gt;

  &lt;xsl:if xmlns:saxon="http://saxon.sf.net/"
          use-when="function-available('saxon:line-number')"
          test="saxon:line-number($context) gt 0"&gt;
    &lt;xsl:attribute name="line-number" select="saxon:line-number($context)"/&gt;
    &lt;xsl:if use-when="function-available('saxon:column-number')"
            test="saxon:column-number($context) gt 0"&gt;
      &lt;xsl:attribute name="column-number" select="saxon:column-number($context)"/&gt;
    &lt;/xsl:if&gt;
  &lt;/xsl:if&gt;
&lt;/xsl:function&gt;

&lt;!-- ============================================================ --&gt;
&lt;!-- From: https://stackoverflow.com/questions/6753343/using-xsl-to-make-a-hash-of-xml-file --&gt;

&lt;xsl:function name="f:checksum" as="xs:string"&gt;
  &lt;xsl:param name="str" as="xs:string"/&gt;

  &lt;xsl:variable name="filename"
                select="if (($xspec-tests = ('1', 'yes', 'true'))
                            and contains($str, 'src/test/resources/'))
                        then substring-after($str, 'src/test/resources')
                        else $str"/&gt;

  &lt;xsl:variable name="codepoints" select="string-to-codepoints($filename)"/&gt;
  &lt;xsl:variable name="checksum"
                select="f:fletcher16($codepoints, count($codepoints), 1, 0, 0)"/&gt;
  &lt;!-- FIX ME: turn this into hex --&gt;
  &lt;xsl:sequence select="string($checksum)"/&gt;
&lt;/xsl:function&gt;

&lt;xsl:function name="f:fletcher16"&gt;
  &lt;xsl:param name="str" as="xs:integer*"/&gt;
  &lt;xsl:param name="len" as="xs:integer" /&gt;
  &lt;xsl:param name="index" as="xs:integer" /&gt;
  &lt;xsl:param name="sum1" as="xs:integer" /&gt;
  &lt;xsl:param name="sum2" as="xs:integer"/&gt;
  &lt;xsl:choose&gt;
    &lt;xsl:when test="$index gt $len"&gt;
      &lt;xsl:sequence select="$sum2 * 256 + $sum1"/&gt;
    &lt;/xsl:when&gt;
    &lt;xsl:otherwise&gt;
      &lt;xsl:variable name="newSum1" as="xs:integer"
                    select="($sum1 + $str[$index]) mod 255"/&gt;
      &lt;xsl:sequence select="f:fletcher16($str, $len, $index + 1, $newSum1,
                                         ($sum2 + $newSum1) mod 255)" /&gt;
    &lt;/xsl:otherwise&gt;
  &lt;/xsl:choose&gt;
&lt;/xsl:function&gt;

&lt;/xsl:stylesheet&gt;
</code></pre></td></tr></table></div></div></div></div><div class="stylesheet" id="S-6140"><h2>resolve.xsl</h2><p><span><span class="template all">5 templates</span></span>, <span><span class="function all">1 function</span></span></p><div class="instructions"><div class="title closed">Instructions</div><div class="body"><div id="S-6140-t-1" class="instruction template"><div class="title"><span class="link" title="Line 15"><a href="#line-d47615e262-15" class="goto-lno">§</a></span>Template match ≅ a:variable-ref</div><div class="props"><div class="calls">Calls: <a href="#S-6140-nwalsh.com.ns.xslt.functions.xvariable,2">f:xvariable()</a></div><div class="mode">Mode: <code>m:resolve</code></div><div class="matches">Matches: <code>a:variable-ref</code></div></div></div><div id="S-6140-t-2" class="instruction template"><div class="title"><span class="link" title="Line 39"><a href="#line-d47615e262-39" class="goto-lno">§</a></span>Template match ≅ a:call-template</div><div class="props"><div class="mode">Mode: <code>m:resolve</code></div><div class="matches">Matches: <code>a:call-template</code></div></div></div><div id="S-6140-t-3" class="instruction template"><div class="title"><span class="link" title="Line 59"><a href="#line-d47615e262-59" class="goto-lno">§</a></span>Template match ≅ a:function-call</div><div class="props"><div class="mode">Mode: <code>m:resolve</code></div><div class="matches">Matches: <code>a:function-call</code></div></div></div><div id="S-6140-t-4" class="instruction template"><div class="title"><span class="link" title="Line 90"><a href="#line-d47615e262-90" class="goto-lno">§</a></span>Template match ≅ element()</div><div class="props"><div class="mode">Mode: <code>m:resolve</code></div><div class="matches">Matches: <code>element()</code></div></div></div><div id="S-6140-t-5" class="instruction template"><div class="title"><span class="link" title="Line 96"><a href="#line-d47615e262-96" class="goto-lno">§</a></span>Template match ≅ attribute()|comment()|processi…</div><div class="props"><div class="mode">Mode: <code>m:resolve</code></div><div class="matches">Matches: <code>attribute()</code>, <code>comment()</code>, <code>processing-instruction()</code>, <code>text()</code></div></div></div><div id="S-6140-nwalsh.com.ns.xslt.functions.xvariable,2" class="instruction function"><div class="title"><span class="link" title="Line 100"><a href="#line-d47615e262-100" class="goto-lno">§</a></span>Function f:xvariable($context as element(), $ref as xs:string) as element(a:variable)? <span class="recursive" title="Recursive function">♻</span></div><div class="props"><div class="used-by"><span class="marker"></span>Used by: <a href="#S-6140-t-1">template</a>, <a href="#S-6140-nwalsh.com.ns.xslt.functions.xvariable,2">f:xvariable()</a></div><div class="used-in"><span class="marker"></span>Used in: <a href="#S-6140">resolve.xsl</a></div></div></div></div></div><div class="source-code"><div class="title closed">Source code</div><div class="body"><div><table><tr><td valign="top" align="right"><pre class="fake-prism"><span id="line-d47615e262-1">1</span>
<span id="line-d47615e262-2"><span class="lno">2</span></span>
<span id="line-d47615e262-3"><span class="lno">3</span></span>
<span id="line-d47615e262-4"><span class="lno">4</span></span>
<span id="line-d47615e262-5">5</span>
<span id="line-d47615e262-6"><span class="lno">6</span></span>
<span id="line-d47615e262-7"><span class="lno">7</span></span>
<span id="line-d47615e262-8"><span class="lno">8</span></span>
<span id="line-d47615e262-9"><span class="lno">9</span></span>
<span id="line-d47615e262-10">10</span>
<span id="line-d47615e262-11"><span class="lno">11</span></span>
<span id="line-d47615e262-12"><span class="lno">12</span></span>
<span id="line-d47615e262-13"><span class="lno">13</span></span>
<span id="line-d47615e262-14"><span class="lno">14</span></span>
<span id="line-d47615e262-15">15</span>
<span id="line-d47615e262-16"><span class="lno">16</span></span>
<span id="line-d47615e262-17"><span class="lno">17</span></span>
<span id="line-d47615e262-18"><span class="lno">18</span></span>
<span id="line-d47615e262-19"><span class="lno">19</span></span>
<span id="line-d47615e262-20">20</span>
<span id="line-d47615e262-21"><span class="lno">21</span></span>
<span id="line-d47615e262-22"><span class="lno">22</span></span>
<span id="line-d47615e262-23"><span class="lno">23</span></span>
<span id="line-d47615e262-24"><span class="lno">24</span></span>
<span id="line-d47615e262-25">25</span>
<span id="line-d47615e262-26"><span class="lno">26</span></span>
<span id="line-d47615e262-27"><span class="lno">27</span></span>
<span id="line-d47615e262-28"><span class="lno">28</span></span>
<span id="line-d47615e262-29"><span class="lno">29</span></span>
<span id="line-d47615e262-30">30</span>
<span id="line-d47615e262-31"><span class="lno">31</span></span>
<span id="line-d47615e262-32"><span class="lno">32</span></span>
<span id="line-d47615e262-33"><span class="lno">33</span></span>
<span id="line-d47615e262-34"><span class="lno">34</span></span>
<span id="line-d47615e262-35">35</span>
<span id="line-d47615e262-36"><span class="lno">36</span></span>
<span id="line-d47615e262-37"><span class="lno">37</span></span>
<span id="line-d47615e262-38"><span class="lno">38</span></span>
<span id="line-d47615e262-39"><span class="lno">39</span></span>
<span id="line-d47615e262-40">40</span>
<span id="line-d47615e262-41"><span class="lno">41</span></span>
<span id="line-d47615e262-42"><span class="lno">42</span></span>
<span id="line-d47615e262-43"><span class="lno">43</span></span>
<span id="line-d47615e262-44"><span class="lno">44</span></span>
<span id="line-d47615e262-45">45</span>
<span id="line-d47615e262-46"><span class="lno">46</span></span>
<span id="line-d47615e262-47"><span class="lno">47</span></span>
<span id="line-d47615e262-48"><span class="lno">48</span></span>
<span id="line-d47615e262-49"><span class="lno">49</span></span>
<span id="line-d47615e262-50">50</span>
<span id="line-d47615e262-51"><span class="lno">51</span></span>
<span id="line-d47615e262-52"><span class="lno">52</span></span>
<span id="line-d47615e262-53"><span class="lno">53</span></span>
<span id="line-d47615e262-54"><span class="lno">54</span></span>
<span id="line-d47615e262-55">55</span>
<span id="line-d47615e262-56"><span class="lno">56</span></span>
<span id="line-d47615e262-57"><span class="lno">57</span></span>
<span id="line-d47615e262-58"><span class="lno">58</span></span>
<span id="line-d47615e262-59"><span class="lno">59</span></span>
<span id="line-d47615e262-60">60</span>
<span id="line-d47615e262-61"><span class="lno">61</span></span>
<span id="line-d47615e262-62"><span class="lno">62</span></span>
<span id="line-d47615e262-63"><span class="lno">63</span></span>
<span id="line-d47615e262-64"><span class="lno">64</span></span>
<span id="line-d47615e262-65">65</span>
<span id="line-d47615e262-66"><span class="lno">66</span></span>
<span id="line-d47615e262-67"><span class="lno">67</span></span>
<span id="line-d47615e262-68"><span class="lno">68</span></span>
<span id="line-d47615e262-69"><span class="lno">69</span></span>
<span id="line-d47615e262-70">70</span>
<span id="line-d47615e262-71"><span class="lno">71</span></span>
<span id="line-d47615e262-72"><span class="lno">72</span></span>
<span id="line-d47615e262-73"><span class="lno">73</span></span>
<span id="line-d47615e262-74"><span class="lno">74</span></span>
<span id="line-d47615e262-75">75</span>
<span id="line-d47615e262-76"><span class="lno">76</span></span>
<span id="line-d47615e262-77"><span class="lno">77</span></span>
<span id="line-d47615e262-78"><span class="lno">78</span></span>
<span id="line-d47615e262-79"><span class="lno">79</span></span>
<span id="line-d47615e262-80">80</span>
<span id="line-d47615e262-81"><span class="lno">81</span></span>
<span id="line-d47615e262-82"><span class="lno">82</span></span>
<span id="line-d47615e262-83"><span class="lno">83</span></span>
<span id="line-d47615e262-84"><span class="lno">84</span></span>
<span id="line-d47615e262-85">85</span>
<span id="line-d47615e262-86"><span class="lno">86</span></span>
<span id="line-d47615e262-87"><span class="lno">87</span></span>
<span id="line-d47615e262-88"><span class="lno">88</span></span>
<span id="line-d47615e262-89"><span class="lno">89</span></span>
<span id="line-d47615e262-90">90</span>
<span id="line-d47615e262-91"><span class="lno">91</span></span>
<span id="line-d47615e262-92"><span class="lno">92</span></span>
<span id="line-d47615e262-93"><span class="lno">93</span></span>
<span id="line-d47615e262-94"><span class="lno">94</span></span>
<span id="line-d47615e262-95">95</span>
<span id="line-d47615e262-96"><span class="lno">96</span></span>
<span id="line-d47615e262-97"><span class="lno">97</span></span>
<span id="line-d47615e262-98"><span class="lno">98</span></span>
<span id="line-d47615e262-99"><span class="lno">99</span></span>
<span id="line-d47615e262-100">100</span>
<span id="line-d47615e262-101"><span class="lno">101</span></span>
<span id="line-d47615e262-102"><span class="lno">102</span></span>
<span id="line-d47615e262-103"><span class="lno">103</span></span>
<span id="line-d47615e262-104"><span class="lno">104</span></span>
<span id="line-d47615e262-105">105</span>
<span id="line-d47615e262-106"><span class="lno">106</span></span>
<span id="line-d47615e262-107"><span class="lno">107</span></span>
<span id="line-d47615e262-108"><span class="lno">108</span></span>
<span id="line-d47615e262-109"><span class="lno">109</span></span>
<span id="line-d47615e262-110">110</span>
<span id="line-d47615e262-111"><span class="lno">111</span></span>
<span id="line-d47615e262-112"><span class="lno">112</span></span>
<span id="line-d47615e262-113"><span class="lno">113</span></span>
<span id="line-d47615e262-114"><span class="lno">114</span></span>
<span id="line-d47615e262-115">115</span>
<span id="line-d47615e262-116"><span class="lno">116</span></span>
<span id="line-d47615e262-117"><span class="lno">117</span></span>
<span id="line-d47615e262-118"><span class="lno">118</span></span>
<span id="line-d47615e262-119"><span class="lno">119</span></span>
<span id="line-d47615e262-120">120</span>
<span id="line-d47615e262-121"><span class="lno">121</span></span>
</pre></td><td valign="top"><pre><code class="language-xml">&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
                xmlns:a="http://nwalsh.com/ns/xslt/analysis"
                xmlns:f="http://nwalsh.com/ns/xslt/functions"
                xmlns:fp="http://nwalsh.com/ns/xslt/functions/private"
                xmlns:h="http://www.w3.org/1999/xhtml"
                xmlns:m="http://nwalsh.com/ns/xslt/modes"
                xmlns:t="http://nwalsh.com/ns/xslt/templates"
                xmlns:xs="http://www.w3.org/2001/XMLSchema"
                xmlns="http://nwalsh.com/ns/xslt/analysis"
                default-mode="m:resolve"
                exclude-result-prefixes="a f fp h m t xs"
                version="3.0"&gt;

&lt;xsl:template match="a:variable-ref"&gt;
  &lt;xsl:variable name="ref" select="f:xvariable(., @ref)"/&gt;

  &lt;!-- If it's a reference to a top-level variable, then the last one wins. --&gt;
  &lt;xsl:variable name="ref" select="if (empty($ref) or $ref/parent::a:stylesheet)
                                   then (//a:stylesheet/a:variable[@name = $ref/@name])[last()]
                                   else $ref"/&gt;

  &lt;xsl:copy&gt;
    &lt;xsl:apply-templates select="@*"/&gt;

    &lt;xsl:choose&gt;
      &lt;xsl:when test="empty($ref)"&gt;
        &lt;xsl:message select="'No variable:', @ref/string()"/&gt;
      &lt;/xsl:when&gt;
      &lt;xsl:otherwise&gt;
        &lt;xsl:attribute name="xref" select="$ref/@id"/&gt;
      &lt;/xsl:otherwise&gt;
    &lt;/xsl:choose&gt;

    &lt;xsl:apply-templates select="*"/&gt;
  &lt;/xsl:copy&gt;
&lt;/xsl:template&gt;

&lt;xsl:template match="a:call-template"&gt;
  &lt;xsl:variable name="ref" select="@ref"/&gt;
  &lt;xsl:variable name="ref" select="(//a:stylesheet/a:template[@name = $ref])[last()]"/&gt;

  &lt;xsl:copy&gt;
    &lt;xsl:apply-templates select="@*"/&gt;

    &lt;xsl:choose&gt;
      &lt;xsl:when test="empty($ref)"&gt;
        &lt;xsl:message select="'No template:', @ref/string()"/&gt;
      &lt;/xsl:when&gt;
      &lt;xsl:otherwise&gt;
        &lt;xsl:attribute name="xref" select="$ref/@id"/&gt;
      &lt;/xsl:otherwise&gt;
    &lt;/xsl:choose&gt;

    &lt;xsl:apply-templates select="*"/&gt;
  &lt;/xsl:copy&gt;
&lt;/xsl:template&gt;

&lt;xsl:template match="a:function-call"&gt;
  &lt;xsl:variable name="ref" select="@ref"/&gt;
  &lt;xsl:variable name="ref" select="(//a:stylesheet/a:function[@name = $ref])[last()]"/&gt;

  &lt;xsl:copy&gt;
    &lt;xsl:apply-templates select="@*"/&gt;

    &lt;xsl:choose&gt;
      &lt;xsl:when test="empty($ref)"&gt;
        &lt;xsl:choose&gt;
          &lt;xsl:when test="starts-with(@ref, '{http://www.w3.org/2005/xpath-functions}')
                          or starts-with(@ref, '{http://www.w3.org/2001/XMLSchema}')
                          or starts-with(@ref, '{http://saxon.sf.net/}')
                          or starts-with(@ref, '{http://www.w3.org/2005/xpath-functions/array}')
                          or starts-with(@ref, '{http://www.w3.org/2005/xpath-functions/map}')"&gt;
            &lt;!-- ignore standard, builtin functions --&gt;
          &lt;/xsl:when&gt;
          &lt;xsl:otherwise&gt;
            &lt;xsl:message select="'No function:', @ref/string()"/&gt;
          &lt;/xsl:otherwise&gt;
        &lt;/xsl:choose&gt;
      &lt;/xsl:when&gt;
      &lt;xsl:otherwise&gt;
        &lt;xsl:attribute name="xref" select="$ref/@id"/&gt;
      &lt;/xsl:otherwise&gt;
    &lt;/xsl:choose&gt;

    &lt;xsl:apply-templates select="*"/&gt;
  &lt;/xsl:copy&gt;
&lt;/xsl:template&gt;

&lt;xsl:template match="element()"&gt;
  &lt;xsl:copy&gt;
    &lt;xsl:apply-templates select="@*,node()"/&gt;
  &lt;/xsl:copy&gt;
&lt;/xsl:template&gt;

&lt;xsl:template match="attribute()|text()|comment()|processing-instruction()"&gt;
  &lt;xsl:copy/&gt;
&lt;/xsl:template&gt;

&lt;xsl:function name="f:xvariable" as="element(a:variable)?"&gt;
  &lt;xsl:param name="context" as="element()"/&gt;
  &lt;xsl:param name="ref" as="xs:string"/&gt;

  &lt;xsl:choose&gt;
    &lt;xsl:when test="$context/preceding-sibling::a:variable[@name=$ref]"&gt;
      &lt;xsl:sequence select="$context/preceding-sibling::a:variable[@name=$ref][1]"/&gt;
    &lt;/xsl:when&gt;
    &lt;xsl:when test="$context/self::a:stylesheet"&gt;
      &lt;xsl:sequence select="(root($context)//a:stylesheet/a:variable[@name = $ref])[last()]"/&gt;
    &lt;/xsl:when&gt;
    &lt;xsl:when test="empty($context)"&gt;
      &lt;xsl:sequence select="()"/&gt;
    &lt;/xsl:when&gt;
    &lt;xsl:otherwise&gt;
      &lt;xsl:sequence select="f:xvariable($context/parent::*, $ref)"/&gt;
    &lt;/xsl:otherwise&gt;
  &lt;/xsl:choose&gt;
&lt;/xsl:function&gt;

&lt;/xsl:stylesheet&gt;
</code></pre></td></tr></table></div></div></div></div><div class="stylesheet" id="S-28400"><h2>analyze.xsl</h2><p><span><span class="template all">6 templates</span></span>, <span><span class="function all">7 functions</span></span></p><div class="instructions"><div class="title closed">Instructions</div><div class="body"><div id="S-28400-t-1" class="instruction template"><div class="title"><span class="link" title="Line 19"><a href="#line-d47615e286-19" class="goto-lno">§</a></span>Template match ≅ /</div><div class="props"><div class="mode">Mode: <code>m:analyze</code></div><div class="matches">Matches: <code>/</code></div></div></div><div id="S-28400-t-2" class="instruction template"><div class="title"><span class="link" title="Line 40"><a href="#line-d47615e286-40" class="goto-lno">§</a></span>Template match ≅ a:stylesheet</div><div class="props"><div class="calls">Calls: <a href="#S-28400-nwalsh.com.ns.xslt.functions.function-shadows,2">f:function-shadows()</a>, <a href="#S-28400-nwalsh.com.ns.xslt.functions.generate-id,1">f:generate-id()</a>, <a href="#S-28400-nwalsh.com.ns.xslt.functions.template-shadows,2">f:template-shadows()</a>, <a href="#S-28400-nwalsh.com.ns.xslt.functions.variable,2">f:variable()</a></div><div class="mode">Mode: <code>m:analyze</code></div><div class="matches">Matches: <code>a:stylesheet</code></div></div></div><div id="S-28400-t-3" class="instruction template"><div class="title"><span class="link" title="Line 203"><a href="#line-d47615e286-203" class="goto-lno">§</a></span>Template match ≅ a:function</div><div class="props"><div class="calls">Calls: <a href="#S-28400-nwalsh.com.ns.xslt.functions.function-shadows,2">f:function-shadows()</a>, <a href="#S-28400-nwalsh.com.ns.xslt.functions.generate-id,1">f:generate-id()</a>, <a href="#S-28400-nwalsh.com.ns.xslt.functions.template-calls,1">f:template-calls()</a>, <a href="#S-28400-nwalsh.com.ns.xslt.functions.variables-referenced,1">f:variables-referenced()</a></div><div class="mode">Mode: <code>m:analyze</code></div><div class="matches">Matches: <code>a:function</code></div></div></div><div id="S-28400-t-4" class="instruction template"><div class="title"><span class="link" title="Line 268"><a href="#line-d47615e286-268" class="goto-lno">§</a></span>Template match ≅ a:variable</div><div class="props"><div class="calls">Calls: <a href="#S-28400-nwalsh.com.ns.xslt.functions.function-calls,1">f:function-calls()</a>, <a href="#S-28400-nwalsh.com.ns.xslt.functions.generate-id,1">f:generate-id()</a>, <a href="#S-28400-nwalsh.com.ns.xslt.functions.template-calls,1">f:template-calls()</a>, <a href="#S-28400-nwalsh.com.ns.xslt.functions.variable,2">f:variable()</a>, <a href="#S-28400-nwalsh.com.ns.xslt.functions.variables-referenced,1">f:variables-referenced()</a></div><div class="mode">Mode: <code>m:analyze</code></div><div class="matches">Matches: <code>a:variable</code></div></div></div><div id="S-28400-t-5" class="instruction template"><div class="title"><span class="link" title="Line 330"><a href="#line-d47615e286-330" class="goto-lno">§</a></span>Template match ≅ a:template</div><div class="props"><div class="calls">Calls: <a href="#S-28400-nwalsh.com.ns.xslt.functions.function-calls,1">f:function-calls()</a>, <a href="#S-28400-nwalsh.com.ns.xslt.functions.generate-id,1">f:generate-id()</a>, <a href="#S-28400-nwalsh.com.ns.xslt.functions.template-calls,1">f:template-calls()</a>, <a href="#S-28400-nwalsh.com.ns.xslt.functions.template-shadows,2">f:template-shadows()</a>, <a href="#S-28400-nwalsh.com.ns.xslt.functions.variables-referenced,1">f:variables-referenced()</a></div><div class="mode">Mode: <code>m:analyze</code></div><div class="matches">Matches: <code>a:template</code></div></div></div><div id="S-28400-t-6" class="instruction template"><div class="title"><span class="link" title="Line 392"><a href="#line-d47615e286-392" class="goto-lno">§</a></span>Template match ≅ a:comment</div><div class="props"><div class="calls">Calls: <a href="#S-28400-nwalsh.com.ns.xslt.functions.generate-id,1">f:generate-id()</a></div><div class="mode">Mode: <code>m:analyze</code></div><div class="matches">Matches: <code>a:comment</code></div></div></div><div id="S-28400-nwalsh.com.ns.xslt.functions.variables-referenced,1" class="instruction function"><div class="title"><span class="link" title="Line 400"><a href="#line-d47615e286-400" class="goto-lno">§</a></span>Function f:variables-referenced($node as element()) as element(a:variable)*</div><div class="props"><div class="used-by"><span class="marker"></span>Used by: <a href="#S-28400-t-3">template</a>, <a href="#S-28400-t-4">template</a>, <a href="#S-28400-t-5">template</a></div><div class="used-in"><span class="marker"></span>Used in: <a href="#S-28400">analyze.xsl</a></div></div></div><div id="S-28400-nwalsh.com.ns.xslt.functions.function-calls,1" class="instruction function"><div class="title"><span class="link" title="Line 405"><a href="#line-d47615e286-405" class="goto-lno">§</a></span>Function f:function-calls($node as element()) as element(a:function)*</div><div class="props"><div class="used-by"><span class="marker"></span>Used by: <a href="#S-28400-t-4">template</a>, <a href="#S-28400-t-5">template</a></div><div class="used-in"><span class="marker"></span>Used in: <a href="#S-28400">analyze.xsl</a></div></div></div><div id="S-28400-nwalsh.com.ns.xslt.functions.template-calls,1" class="instruction function"><div class="title"><span class="link" title="Line 410"><a href="#line-d47615e286-410" class="goto-lno">§</a></span>Function f:template-calls($node as element()) as element(a:template)*</div><div class="props"><div class="used-by"><span class="marker"></span>Used by: <a href="#S-28400-t-3">template</a>, <a href="#S-28400-t-4">template</a>, <a href="#S-28400-t-5">template</a></div><div class="used-in"><span class="marker"></span>Used in: <a href="#S-28400">analyze.xsl</a></div></div></div><div id="S-28400-nwalsh.com.ns.xslt.functions.generate-id,1" class="instruction function"><div class="title"><span class="link" title="Line 415"><a href="#line-d47615e286-415" class="goto-lno">§</a></span>Function f:generate-id($node as element()) as xs:string</div><div class="props"><div class="used-by"><span class="marker"></span>Used by: <a href="#S-28400-t-2">template</a>, <a href="#S-28400-t-3">template</a>, <a href="#S-28400-t-4">template</a>, <a href="#S-28400-t-5">template</a>, <a href="#S-28400-t-6">template</a></div><div class="used-in"><span class="marker"></span>Used in: <a href="#S-28400">analyze.xsl</a></div></div></div><div id="S-28400-nwalsh.com.ns.xslt.functions.variable,2" class="instruction function"><div class="title"><span class="link" title="Line 425"><a href="#line-d47615e286-425" class="goto-lno">§</a></span>Function f:variable($context as element(), $ref as xs:string) as element(a:variable)? <span class="recursive" title="Recursive function">♻</span></div><div class="props"><div class="used-by"><span class="marker"></span>Used by: <a href="#S-28400-t-2">template</a>, <a href="#S-28400-t-4">template</a>, <a href="#S-28400-nwalsh.com.ns.xslt.functions.variable,2">f:variable()</a></div><div class="used-in"><span class="marker"></span>Used in: <a href="#S-28400">analyze.xsl</a></div></div></div><div id="S-28400-nwalsh.com.ns.xslt.functions.template-shadows,2" class="instruction function"><div class="title"><span class="link" title="Line 445"><a href="#line-d47615e286-445" class="goto-lno">§</a></span>Function f:template-shadows($context as element(), $ref as xs:string) as element(a:template)? <span class="recursive" title="Recursive function">♻</span></div><div class="props"><div class="used-by"><span class="marker"></span>Used by: <a href="#S-28400-t-2">template</a>, <a href="#S-28400-t-5">template</a>, <a href="#S-28400-nwalsh.com.ns.xslt.functions.template-shadows,2">f:template-shadows()</a></div><div class="used-in"><span class="marker"></span>Used in: <a href="#S-28400">analyze.xsl</a></div></div></div><div id="S-28400-nwalsh.com.ns.xslt.functions.function-shadows,2" class="instruction function"><div class="title"><span class="link" title="Line 466"><a href="#line-d47615e286-466" class="goto-lno">§</a></span>Function f:function-shadows($context as element(), $ref as xs:string) as element(a:function)? <span class="recursive" title="Recursive function">♻</span></div><div class="props"><div class="used-by"><span class="marker"></span>Used by: <a href="#S-28400-t-2">template</a>, <a href="#S-28400-t-3">template</a>, <a href="#S-28400-nwalsh.com.ns.xslt.functions.function-shadows,2">f:function-shadows()</a></div><div class="used-in"><span class="marker"></span>Used in: <a href="#S-28400">analyze.xsl</a></div></div></div></div></div><div class="source-code"><div class="title closed">Source code</div><div class="body"><div><table><tr><td valign="top" align="right"><pre class="fake-prism"><span id="line-d47615e286-1">1</span>
<span id="line-d47615e286-2"><span class="lno">2</span></span>
<span id="line-d47615e286-3"><span class="lno">3</span></span>
<span id="line-d47615e286-4"><span class="lno">4</span></span>
<span id="line-d47615e286-5">5</span>
<span id="line-d47615e286-6"><span class="lno">6</span></span>
<span id="line-d47615e286-7"><span class="lno">7</span></span>
<span id="line-d47615e286-8"><span class="lno">8</span></span>
<span id="line-d47615e286-9"><span class="lno">9</span></span>
<span id="line-d47615e286-10">10</span>
<span id="line-d47615e286-11"><span class="lno">11</span></span>
<span id="line-d47615e286-12"><span class="lno">12</span></span>
<span id="line-d47615e286-13"><span class="lno">13</span></span>
<span id="line-d47615e286-14"><span class="lno">14</span></span>
<span id="line-d47615e286-15">15</span>
<span id="line-d47615e286-16"><span class="lno">16</span></span>
<span id="line-d47615e286-17"><span class="lno">17</span></span>
<span id="line-d47615e286-18"><span class="lno">18</span></span>
<span id="line-d47615e286-19"><span class="lno">19</span></span>
<span id="line-d47615e286-20">20</span>
<span id="line-d47615e286-21"><span class="lno">21</span></span>
<span id="line-d47615e286-22"><span class="lno">22</span></span>
<span id="line-d47615e286-23"><span class="lno">23</span></span>
<span id="line-d47615e286-24"><span class="lno">24</span></span>
<span id="line-d47615e286-25">25</span>
<span id="line-d47615e286-26"><span class="lno">26</span></span>
<span id="line-d47615e286-27"><span class="lno">27</span></span>
<span id="line-d47615e286-28"><span class="lno">28</span></span>
<span id="line-d47615e286-29"><span class="lno">29</span></span>
<span id="line-d47615e286-30">30</span>
<span id="line-d47615e286-31"><span class="lno">31</span></span>
<span id="line-d47615e286-32"><span class="lno">32</span></span>
<span id="line-d47615e286-33"><span class="lno">33</span></span>
<span id="line-d47615e286-34"><span class="lno">34</span></span>
<span id="line-d47615e286-35">35</span>
<span id="line-d47615e286-36"><span class="lno">36</span></span>
<span id="line-d47615e286-37"><span class="lno">37</span></span>
<span id="line-d47615e286-38"><span class="lno">38</span></span>
<span id="line-d47615e286-39"><span class="lno">39</span></span>
<span id="line-d47615e286-40">40</span>
<span id="line-d47615e286-41"><span class="lno">41</span></span>
<span id="line-d47615e286-42"><span class="lno">42</span></span>
<span id="line-d47615e286-43"><span class="lno">43</span></span>
<span id="line-d47615e286-44"><span class="lno">44</span></span>
<span id="line-d47615e286-45">45</span>
<span id="line-d47615e286-46"><span class="lno">46</span></span>
<span id="line-d47615e286-47"><span class="lno">47</span></span>
<span id="line-d47615e286-48"><span class="lno">48</span></span>
<span id="line-d47615e286-49"><span class="lno">49</span></span>
<span id="line-d47615e286-50">50</span>
<span id="line-d47615e286-51"><span class="lno">51</span></span>
<span id="line-d47615e286-52"><span class="lno">52</span></span>
<span id="line-d47615e286-53"><span class="lno">53</span></span>
<span id="line-d47615e286-54"><span class="lno">54</span></span>
<span id="line-d47615e286-55">55</span>
<span id="line-d47615e286-56"><span class="lno">56</span></span>
<span id="line-d47615e286-57"><span class="lno">57</span></span>
<span id="line-d47615e286-58"><span class="lno">58</span></span>
<span id="line-d47615e286-59"><span class="lno">59</span></span>
<span id="line-d47615e286-60">60</span>
<span id="line-d47615e286-61"><span class="lno">61</span></span>
<span id="line-d47615e286-62"><span class="lno">62</span></span>
<span id="line-d47615e286-63"><span class="lno">63</span></span>
<span id="line-d47615e286-64"><span class="lno">64</span></span>
<span id="line-d47615e286-65">65</span>
<span id="line-d47615e286-66"><span class="lno">66</span></span>
<span id="line-d47615e286-67"><span class="lno">67</span></span>
<span id="line-d47615e286-68"><span class="lno">68</span></span>
<span id="line-d47615e286-69"><span class="lno">69</span></span>
<span id="line-d47615e286-70">70</span>
<span id="line-d47615e286-71"><span class="lno">71</span></span>
<span id="line-d47615e286-72"><span class="lno">72</span></span>
<span id="line-d47615e286-73"><span class="lno">73</span></span>
<span id="line-d47615e286-74"><span class="lno">74</span></span>
<span id="line-d47615e286-75">75</span>
<span id="line-d47615e286-76"><span class="lno">76</span></span>
<span id="line-d47615e286-77"><span class="lno">77</span></span>
<span id="line-d47615e286-78"><span class="lno">78</span></span>
<span id="line-d47615e286-79"><span class="lno">79</span></span>
<span id="line-d47615e286-80">80</span>
<span id="line-d47615e286-81"><span class="lno">81</span></span>
<span id="line-d47615e286-82"><span class="lno">82</span></span>
<span id="line-d47615e286-83"><span class="lno">83</span></span>
<span id="line-d47615e286-84"><span class="lno">84</span></span>
<span id="line-d47615e286-85">85</span>
<span id="line-d47615e286-86"><span class="lno">86</span></span>
<span id="line-d47615e286-87"><span class="lno">87</span></span>
<span id="line-d47615e286-88"><span class="lno">88</span></span>
<span id="line-d47615e286-89"><span class="lno">89</span></span>
<span id="line-d47615e286-90">90</span>
<span id="line-d47615e286-91"><span class="lno">91</span></span>
<span id="line-d47615e286-92"><span class="lno">92</span></span>
<span id="line-d47615e286-93"><span class="lno">93</span></span>
<span id="line-d47615e286-94"><span class="lno">94</span></span>
<span id="line-d47615e286-95">95</span>
<span id="line-d47615e286-96"><span class="lno">96</span></span>
<span id="line-d47615e286-97"><span class="lno">97</span></span>
<span id="line-d47615e286-98"><span class="lno">98</span></span>
<span id="line-d47615e286-99"><span class="lno">99</span></span>
<span id="line-d47615e286-100">100</span>
<span id="line-d47615e286-101"><span class="lno">101</span></span>
<span id="line-d47615e286-102"><span class="lno">102</span></span>
<span id="line-d47615e286-103"><span class="lno">103</span></span>
<span id="line-d47615e286-104"><span class="lno">104</span></span>
<span id="line-d47615e286-105">105</span>
<span id="line-d47615e286-106"><span class="lno">106</span></span>
<span id="line-d47615e286-107"><span class="lno">107</span></span>
<span id="line-d47615e286-108"><span class="lno">108</span></span>
<span id="line-d47615e286-109"><span class="lno">109</span></span>
<span id="line-d47615e286-110">110</span>
<span id="line-d47615e286-111"><span class="lno">111</span></span>
<span id="line-d47615e286-112"><span class="lno">112</span></span>
<span id="line-d47615e286-113"><span class="lno">113</span></span>
<span id="line-d47615e286-114"><span class="lno">114</span></span>
<span id="line-d47615e286-115">115</span>
<span id="line-d47615e286-116"><span class="lno">116</span></span>
<span id="line-d47615e286-117"><span class="lno">117</span></span>
<span id="line-d47615e286-118"><span class="lno">118</span></span>
<span id="line-d47615e286-119"><span class="lno">119</span></span>
<span id="line-d47615e286-120">120</span>
<span id="line-d47615e286-121"><span class="lno">121</span></span>
<span id="line-d47615e286-122"><span class="lno">122</span></span>
<span id="line-d47615e286-123"><span class="lno">123</span></span>
<span id="line-d47615e286-124"><span class="lno">124</span></span>
<span id="line-d47615e286-125">125</span>
<span id="line-d47615e286-126"><span class="lno">126</span></span>
<span id="line-d47615e286-127"><span class="lno">127</span></span>
<span id="line-d47615e286-128"><span class="lno">128</span></span>
<span id="line-d47615e286-129"><span class="lno">129</span></span>
<span id="line-d47615e286-130">130</span>
<span id="line-d47615e286-131"><span class="lno">131</span></span>
<span id="line-d47615e286-132"><span class="lno">132</span></span>
<span id="line-d47615e286-133"><span class="lno">133</span></span>
<span id="line-d47615e286-134"><span class="lno">134</span></span>
<span id="line-d47615e286-135">135</span>
<span id="line-d47615e286-136"><span class="lno">136</span></span>
<span id="line-d47615e286-137"><span class="lno">137</span></span>
<span id="line-d47615e286-138"><span class="lno">138</span></span>
<span id="line-d47615e286-139"><span class="lno">139</span></span>
<span id="line-d47615e286-140">140</span>
<span id="line-d47615e286-141"><span class="lno">141</span></span>
<span id="line-d47615e286-142"><span class="lno">142</span></span>
<span id="line-d47615e286-143"><span class="lno">143</span></span>
<span id="line-d47615e286-144"><span class="lno">144</span></span>
<span id="line-d47615e286-145">145</span>
<span id="line-d47615e286-146"><span class="lno">146</span></span>
<span id="line-d47615e286-147"><span class="lno">147</span></span>
<span id="line-d47615e286-148"><span class="lno">148</span></span>
<span id="line-d47615e286-149"><span class="lno">149</span></span>
<span id="line-d47615e286-150">150</span>
<span id="line-d47615e286-151"><span class="lno">151</span></span>
<span id="line-d47615e286-152"><span class="lno">152</span></span>
<span id="line-d47615e286-153"><span class="lno">153</span></span>
<span id="line-d47615e286-154"><span class="lno">154</span></span>
<span id="line-d47615e286-155">155</span>
<span id="line-d47615e286-156"><span class="lno">156</span></span>
<span id="line-d47615e286-157"><span class="lno">157</span></span>
<span id="line-d47615e286-158"><span class="lno">158</span></span>
<span id="line-d47615e286-159"><span class="lno">159</span></span>
<span id="line-d47615e286-160">160</span>
<span id="line-d47615e286-161"><span class="lno">161</span></span>
<span id="line-d47615e286-162"><span class="lno">162</span></span>
<span id="line-d47615e286-163"><span class="lno">163</span></span>
<span id="line-d47615e286-164"><span class="lno">164</span></span>
<span id="line-d47615e286-165">165</span>
<span id="line-d47615e286-166"><span class="lno">166</span></span>
<span id="line-d47615e286-167"><span class="lno">167</span></span>
<span id="line-d47615e286-168"><span class="lno">168</span></span>
<span id="line-d47615e286-169"><span class="lno">169</span></span>
<span id="line-d47615e286-170">170</span>
<span id="line-d47615e286-171"><span class="lno">171</span></span>
<span id="line-d47615e286-172"><span class="lno">172</span></span>
<span id="line-d47615e286-173"><span class="lno">173</span></span>
<span id="line-d47615e286-174"><span class="lno">174</span></span>
<span id="line-d47615e286-175">175</span>
<span id="line-d47615e286-176"><span class="lno">176</span></span>
<span id="line-d47615e286-177"><span class="lno">177</span></span>
<span id="line-d47615e286-178"><span class="lno">178</span></span>
<span id="line-d47615e286-179"><span class="lno">179</span></span>
<span id="line-d47615e286-180">180</span>
<span id="line-d47615e286-181"><span class="lno">181</span></span>
<span id="line-d47615e286-182"><span class="lno">182</span></span>
<span id="line-d47615e286-183"><span class="lno">183</span></span>
<span id="line-d47615e286-184"><span class="lno">184</span></span>
<span id="line-d47615e286-185">185</span>
<span id="line-d47615e286-186"><span class="lno">186</span></span>
<span id="line-d47615e286-187"><span class="lno">187</span></span>
<span id="line-d47615e286-188"><span class="lno">188</span></span>
<span id="line-d47615e286-189"><span class="lno">189</span></span>
<span id="line-d47615e286-190">190</span>
<span id="line-d47615e286-191"><span class="lno">191</span></span>
<span id="line-d47615e286-192"><span class="lno">192</span></span>
<span id="line-d47615e286-193"><span class="lno">193</span></span>
<span id="line-d47615e286-194"><span class="lno">194</span></span>
<span id="line-d47615e286-195">195</span>
<span id="line-d47615e286-196"><span class="lno">196</span></span>
<span id="line-d47615e286-197"><span class="lno">197</span></span>
<span id="line-d47615e286-198"><span class="lno">198</span></span>
<span id="line-d47615e286-199"><span class="lno">199</span></span>
<span id="line-d47615e286-200">200</span>
<span id="line-d47615e286-201"><span class="lno">201</span></span>
<span id="line-d47615e286-202"><span class="lno">202</span></span>
<span id="line-d47615e286-203"><span class="lno">203</span></span>
<span id="line-d47615e286-204"><span class="lno">204</span></span>
<span id="line-d47615e286-205">205</span>
<span id="line-d47615e286-206"><span class="lno">206</span></span>
<span id="line-d47615e286-207"><span class="lno">207</span></span>
<span id="line-d47615e286-208"><span class="lno">208</span></span>
<span id="line-d47615e286-209"><span class="lno">209</span></span>
<span id="line-d47615e286-210">210</span>
<span id="line-d47615e286-211"><span class="lno">211</span></span>
<span id="line-d47615e286-212"><span class="lno">212</span></span>
<span id="line-d47615e286-213"><span class="lno">213</span></span>
<span id="line-d47615e286-214"><span class="lno">214</span></span>
<span id="line-d47615e286-215">215</span>
<span id="line-d47615e286-216"><span class="lno">216</span></span>
<span id="line-d47615e286-217"><span class="lno">217</span></span>
<span id="line-d47615e286-218"><span class="lno">218</span></span>
<span id="line-d47615e286-219"><span class="lno">219</span></span>
<span id="line-d47615e286-220">220</span>
<span id="line-d47615e286-221"><span class="lno">221</span></span>
<span id="line-d47615e286-222"><span class="lno">222</span></span>
<span id="line-d47615e286-223"><span class="lno">223</span></span>
<span id="line-d47615e286-224"><span class="lno">224</span></span>
<span id="line-d47615e286-225">225</span>
<span id="line-d47615e286-226"><span class="lno">226</span></span>
<span id="line-d47615e286-227"><span class="lno">227</span></span>
<span id="line-d47615e286-228"><span class="lno">228</span></span>
<span id="line-d47615e286-229"><span class="lno">229</span></span>
<span id="line-d47615e286-230">230</span>
<span id="line-d47615e286-231"><span class="lno">231</span></span>
<span id="line-d47615e286-232"><span class="lno">232</span></span>
<span id="line-d47615e286-233"><span class="lno">233</span></span>
<span id="line-d47615e286-234"><span class="lno">234</span></span>
<span id="line-d47615e286-235">235</span>
<span id="line-d47615e286-236"><span class="lno">236</span></span>
<span id="line-d47615e286-237"><span class="lno">237</span></span>
<span id="line-d47615e286-238"><span class="lno">238</span></span>
<span id="line-d47615e286-239"><span class="lno">239</span></span>
<span id="line-d47615e286-240">240</span>
<span id="line-d47615e286-241"><span class="lno">241</span></span>
<span id="line-d47615e286-242"><span class="lno">242</span></span>
<span id="line-d47615e286-243"><span class="lno">243</span></span>
<span id="line-d47615e286-244"><span class="lno">244</span></span>
<span id="line-d47615e286-245">245</span>
<span id="line-d47615e286-246"><span class="lno">246</span></span>
<span id="line-d47615e286-247"><span class="lno">247</span></span>
<span id="line-d47615e286-248"><span class="lno">248</span></span>
<span id="line-d47615e286-249"><span class="lno">249</span></span>
<span id="line-d47615e286-250">250</span>
<span id="line-d47615e286-251"><span class="lno">251</span></span>
<span id="line-d47615e286-252"><span class="lno">252</span></span>
<span id="line-d47615e286-253"><span class="lno">253</span></span>
<span id="line-d47615e286-254"><span class="lno">254</span></span>
<span id="line-d47615e286-255">255</span>
<span id="line-d47615e286-256"><span class="lno">256</span></span>
<span id="line-d47615e286-257"><span class="lno">257</span></span>
<span id="line-d47615e286-258"><span class="lno">258</span></span>
<span id="line-d47615e286-259"><span class="lno">259</span></span>
<span id="line-d47615e286-260">260</span>
<span id="line-d47615e286-261"><span class="lno">261</span></span>
<span id="line-d47615e286-262"><span class="lno">262</span></span>
<span id="line-d47615e286-263"><span class="lno">263</span></span>
<span id="line-d47615e286-264"><span class="lno">264</span></span>
<span id="line-d47615e286-265">265</span>
<span id="line-d47615e286-266"><span class="lno">266</span></span>
<span id="line-d47615e286-267"><span class="lno">267</span></span>
<span id="line-d47615e286-268"><span class="lno">268</span></span>
<span id="line-d47615e286-269"><span class="lno">269</span></span>
<span id="line-d47615e286-270">270</span>
<span id="line-d47615e286-271"><span class="lno">271</span></span>
<span id="line-d47615e286-272"><span class="lno">272</span></span>
<span id="line-d47615e286-273"><span class="lno">273</span></span>
<span id="line-d47615e286-274"><span class="lno">274</span></span>
<span id="line-d47615e286-275">275</span>
<span id="line-d47615e286-276"><span class="lno">276</span></span>
<span id="line-d47615e286-277"><span class="lno">277</span></span>
<span id="line-d47615e286-278"><span class="lno">278</span></span>
<span id="line-d47615e286-279"><span class="lno">279</span></span>
<span id="line-d47615e286-280">280</span>
<span id="line-d47615e286-281"><span class="lno">281</span></span>
<span id="line-d47615e286-282"><span class="lno">282</span></span>
<span id="line-d47615e286-283"><span class="lno">283</span></span>
<span id="line-d47615e286-284"><span class="lno">284</span></span>
<span id="line-d47615e286-285">285</span>
<span id="line-d47615e286-286"><span class="lno">286</span></span>
<span id="line-d47615e286-287"><span class="lno">287</span></span>
<span id="line-d47615e286-288"><span class="lno">288</span></span>
<span id="line-d47615e286-289"><span class="lno">289</span></span>
<span id="line-d47615e286-290">290</span>
<span id="line-d47615e286-291"><span class="lno">291</span></span>
<span id="line-d47615e286-292"><span class="lno">292</span></span>
<span id="line-d47615e286-293"><span class="lno">293</span></span>
<span id="line-d47615e286-294"><span class="lno">294</span></span>
<span id="line-d47615e286-295">295</span>
<span id="line-d47615e286-296"><span class="lno">296</span></span>
<span id="line-d47615e286-297"><span class="lno">297</span></span>
<span id="line-d47615e286-298"><span class="lno">298</span></span>
<span id="line-d47615e286-299"><span class="lno">299</span></span>
<span id="line-d47615e286-300">300</span>
<span id="line-d47615e286-301"><span class="lno">301</span></span>
<span id="line-d47615e286-302"><span class="lno">302</span></span>
<span id="line-d47615e286-303"><span class="lno">303</span></span>
<span id="line-d47615e286-304"><span class="lno">304</span></span>
<span id="line-d47615e286-305">305</span>
<span id="line-d47615e286-306"><span class="lno">306</span></span>
<span id="line-d47615e286-307"><span class="lno">307</span></span>
<span id="line-d47615e286-308"><span class="lno">308</span></span>
<span id="line-d47615e286-309"><span class="lno">309</span></span>
<span id="line-d47615e286-310">310</span>
<span id="line-d47615e286-311"><span class="lno">311</span></span>
<span id="line-d47615e286-312"><span class="lno">312</span></span>
<span id="line-d47615e286-313"><span class="lno">313</span></span>
<span id="line-d47615e286-314"><span class="lno">314</span></span>
<span id="line-d47615e286-315">315</span>
<span id="line-d47615e286-316"><span class="lno">316</span></span>
<span id="line-d47615e286-317"><span class="lno">317</span></span>
<span id="line-d47615e286-318"><span class="lno">318</span></span>
<span id="line-d47615e286-319"><span class="lno">319</span></span>
<span id="line-d47615e286-320">320</span>
<span id="line-d47615e286-321"><span class="lno">321</span></span>
<span id="line-d47615e286-322"><span class="lno">322</span></span>
<span id="line-d47615e286-323"><span class="lno">323</span></span>
<span id="line-d47615e286-324"><span class="lno">324</span></span>
<span id="line-d47615e286-325">325</span>
<span id="line-d47615e286-326"><span class="lno">326</span></span>
<span id="line-d47615e286-327"><span class="lno">327</span></span>
<span id="line-d47615e286-328"><span class="lno">328</span></span>
<span id="line-d47615e286-329"><span class="lno">329</span></span>
<span id="line-d47615e286-330">330</span>
<span id="line-d47615e286-331"><span class="lno">331</span></span>
<span id="line-d47615e286-332"><span class="lno">332</span></span>
<span id="line-d47615e286-333"><span class="lno">333</span></span>
<span id="line-d47615e286-334"><span class="lno">334</span></span>
<span id="line-d47615e286-335">335</span>
<span id="line-d47615e286-336"><span class="lno">336</span></span>
<span id="line-d47615e286-337"><span class="lno">337</span></span>
<span id="line-d47615e286-338"><span class="lno">338</span></span>
<span id="line-d47615e286-339"><span class="lno">339</span></span>
<span id="line-d47615e286-340">340</span>
<span id="line-d47615e286-341"><span class="lno">341</span></span>
<span id="line-d47615e286-342"><span class="lno">342</span></span>
<span id="line-d47615e286-343"><span class="lno">343</span></span>
<span id="line-d47615e286-344"><span class="lno">344</span></span>
<span id="line-d47615e286-345">345</span>
<span id="line-d47615e286-346"><span class="lno">346</span></span>
<span id="line-d47615e286-347"><span class="lno">347</span></span>
<span id="line-d47615e286-348"><span class="lno">348</span></span>
<span id="line-d47615e286-349"><span class="lno">349</span></span>
<span id="line-d47615e286-350">350</span>
<span id="line-d47615e286-351"><span class="lno">351</span></span>
<span id="line-d47615e286-352"><span class="lno">352</span></span>
<span id="line-d47615e286-353"><span class="lno">353</span></span>
<span id="line-d47615e286-354"><span class="lno">354</span></span>
<span id="line-d47615e286-355">355</span>
<span id="line-d47615e286-356"><span class="lno">356</span></span>
<span id="line-d47615e286-357"><span class="lno">357</span></span>
<span id="line-d47615e286-358"><span class="lno">358</span></span>
<span id="line-d47615e286-359"><span class="lno">359</span></span>
<span id="line-d47615e286-360">360</span>
<span id="line-d47615e286-361"><span class="lno">361</span></span>
<span id="line-d47615e286-362"><span class="lno">362</span></span>
<span id="line-d47615e286-363"><span class="lno">363</span></span>
<span id="line-d47615e286-364"><span class="lno">364</span></span>
<span id="line-d47615e286-365">365</span>
<span id="line-d47615e286-366"><span class="lno">366</span></span>
<span id="line-d47615e286-367"><span class="lno">367</span></span>
<span id="line-d47615e286-368"><span class="lno">368</span></span>
<span id="line-d47615e286-369"><span class="lno">369</span></span>
<span id="line-d47615e286-370">370</span>
<span id="line-d47615e286-371"><span class="lno">371</span></span>
<span id="line-d47615e286-372"><span class="lno">372</span></span>
<span id="line-d47615e286-373"><span class="lno">373</span></span>
<span id="line-d47615e286-374"><span class="lno">374</span></span>
<span id="line-d47615e286-375">375</span>
<span id="line-d47615e286-376"><span class="lno">376</span></span>
<span id="line-d47615e286-377"><span class="lno">377</span></span>
<span id="line-d47615e286-378"><span class="lno">378</span></span>
<span id="line-d47615e286-379"><span class="lno">379</span></span>
<span id="line-d47615e286-380">380</span>
<span id="line-d47615e286-381"><span class="lno">381</span></span>
<span id="line-d47615e286-382"><span class="lno">382</span></span>
<span id="line-d47615e286-383"><span class="lno">383</span></span>
<span id="line-d47615e286-384"><span class="lno">384</span></span>
<span id="line-d47615e286-385">385</span>
<span id="line-d47615e286-386"><span class="lno">386</span></span>
<span id="line-d47615e286-387"><span class="lno">387</span></span>
<span id="line-d47615e286-388"><span class="lno">388</span></span>
<span id="line-d47615e286-389"><span class="lno">389</span></span>
<span id="line-d47615e286-390">390</span>
<span id="line-d47615e286-391"><span class="lno">391</span></span>
<span id="line-d47615e286-392"><span class="lno">392</span></span>
<span id="line-d47615e286-393"><span class="lno">393</span></span>
<span id="line-d47615e286-394"><span class="lno">394</span></span>
<span id="line-d47615e286-395">395</span>
<span id="line-d47615e286-396"><span class="lno">396</span></span>
<span id="line-d47615e286-397"><span class="lno">397</span></span>
<span id="line-d47615e286-398"><span class="lno">398</span></span>
<span id="line-d47615e286-399"><span class="lno">399</span></span>
<span id="line-d47615e286-400">400</span>
<span id="line-d47615e286-401"><span class="lno">401</span></span>
<span id="line-d47615e286-402"><span class="lno">402</span></span>
<span id="line-d47615e286-403"><span class="lno">403</span></span>
<span id="line-d47615e286-404"><span class="lno">404</span></span>
<span id="line-d47615e286-405">405</span>
<span id="line-d47615e286-406"><span class="lno">406</span></span>
<span id="line-d47615e286-407"><span class="lno">407</span></span>
<span id="line-d47615e286-408"><span class="lno">408</span></span>
<span id="line-d47615e286-409"><span class="lno">409</span></span>
<span id="line-d47615e286-410">410</span>
<span id="line-d47615e286-411"><span class="lno">411</span></span>
<span id="line-d47615e286-412"><span class="lno">412</span></span>
<span id="line-d47615e286-413"><span class="lno">413</span></span>
<span id="line-d47615e286-414"><span class="lno">414</span></span>
<span id="line-d47615e286-415">415</span>
<span id="line-d47615e286-416"><span class="lno">416</span></span>
<span id="line-d47615e286-417"><span class="lno">417</span></span>
<span id="line-d47615e286-418"><span class="lno">418</span></span>
<span id="line-d47615e286-419"><span class="lno">419</span></span>
<span id="line-d47615e286-420">420</span>
<span id="line-d47615e286-421"><span class="lno">421</span></span>
<span id="line-d47615e286-422"><span class="lno">422</span></span>
<span id="line-d47615e286-423"><span class="lno">423</span></span>
<span id="line-d47615e286-424"><span class="lno">424</span></span>
<span id="line-d47615e286-425">425</span>
<span id="line-d47615e286-426"><span class="lno">426</span></span>
<span id="line-d47615e286-427"><span class="lno">427</span></span>
<span id="line-d47615e286-428"><span class="lno">428</span></span>
<span id="line-d47615e286-429"><span class="lno">429</span></span>
<span id="line-d47615e286-430">430</span>
<span id="line-d47615e286-431"><span class="lno">431</span></span>
<span id="line-d47615e286-432"><span class="lno">432</span></span>
<span id="line-d47615e286-433"><span class="lno">433</span></span>
<span id="line-d47615e286-434"><span class="lno">434</span></span>
<span id="line-d47615e286-435">435</span>
<span id="line-d47615e286-436"><span class="lno">436</span></span>
<span id="line-d47615e286-437"><span class="lno">437</span></span>
<span id="line-d47615e286-438"><span class="lno">438</span></span>
<span id="line-d47615e286-439"><span class="lno">439</span></span>
<span id="line-d47615e286-440">440</span>
<span id="line-d47615e286-441"><span class="lno">441</span></span>
<span id="line-d47615e286-442"><span class="lno">442</span></span>
<span id="line-d47615e286-443"><span class="lno">443</span></span>
<span id="line-d47615e286-444"><span class="lno">444</span></span>
<span id="line-d47615e286-445">445</span>
<span id="line-d47615e286-446"><span class="lno">446</span></span>
<span id="line-d47615e286-447"><span class="lno">447</span></span>
<span id="line-d47615e286-448"><span class="lno">448</span></span>
<span id="line-d47615e286-449"><span class="lno">449</span></span>
<span id="line-d47615e286-450">450</span>
<span id="line-d47615e286-451"><span class="lno">451</span></span>
<span id="line-d47615e286-452"><span class="lno">452</span></span>
<span id="line-d47615e286-453"><span class="lno">453</span></span>
<span id="line-d47615e286-454"><span class="lno">454</span></span>
<span id="line-d47615e286-455">455</span>
<span id="line-d47615e286-456"><span class="lno">456</span></span>
<span id="line-d47615e286-457"><span class="lno">457</span></span>
<span id="line-d47615e286-458"><span class="lno">458</span></span>
<span id="line-d47615e286-459"><span class="lno">459</span></span>
<span id="line-d47615e286-460">460</span>
<span id="line-d47615e286-461"><span class="lno">461</span></span>
<span id="line-d47615e286-462"><span class="lno">462</span></span>
<span id="line-d47615e286-463"><span class="lno">463</span></span>
<span id="line-d47615e286-464"><span class="lno">464</span></span>
<span id="line-d47615e286-465">465</span>
<span id="line-d47615e286-466"><span class="lno">466</span></span>
<span id="line-d47615e286-467"><span class="lno">467</span></span>
<span id="line-d47615e286-468"><span class="lno">468</span></span>
<span id="line-d47615e286-469"><span class="lno">469</span></span>
<span id="line-d47615e286-470">470</span>
<span id="line-d47615e286-471"><span class="lno">471</span></span>
<span id="line-d47615e286-472"><span class="lno">472</span></span>
<span id="line-d47615e286-473"><span class="lno">473</span></span>
<span id="line-d47615e286-474"><span class="lno">474</span></span>
<span id="line-d47615e286-475">475</span>
<span id="line-d47615e286-476"><span class="lno">476</span></span>
<span id="line-d47615e286-477"><span class="lno">477</span></span>
<span id="line-d47615e286-478"><span class="lno">478</span></span>
<span id="line-d47615e286-479"><span class="lno">479</span></span>
<span id="line-d47615e286-480">480</span>
<span id="line-d47615e286-481"><span class="lno">481</span></span>
<span id="line-d47615e286-482"><span class="lno">482</span></span>
<span id="line-d47615e286-483"><span class="lno">483</span></span>
<span id="line-d47615e286-484"><span class="lno">484</span></span>
<span id="line-d47615e286-485">485</span>
<span id="line-d47615e286-486"><span class="lno">486</span></span>
<span id="line-d47615e286-487"><span class="lno">487</span></span>
<span id="line-d47615e286-488"><span class="lno">488</span></span>
</pre></td><td valign="top"><pre><code class="language-xml">&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
                xmlns:a="http://nwalsh.com/ns/xslt/analysis"
                xmlns:f="http://nwalsh.com/ns/xslt/functions"
                xmlns:fp="http://nwalsh.com/ns/xslt/functions/private"
                xmlns:h="http://www.w3.org/1999/xhtml"
                xmlns:m="http://nwalsh.com/ns/xslt/modes"
                xmlns:t="http://nwalsh.com/ns/xslt/templates"
                xmlns:xs="http://www.w3.org/2001/XMLSchema"
                xmlns="http://nwalsh.com/ns/xslt/analysis"
                default-mode="m:analyze"
                exclude-result-prefixes="a f fp h m t xs"
                version="3.0"&gt;

&lt;xsl:key name="fnoarity" match="a:function" use="@noarity-id"/&gt;
&lt;xsl:key name="id" match="*" use="@id"/&gt;
&lt;xsl:key name="xref" match="*" use="@xref"/&gt;

&lt;xsl:template match="/"&gt;
  &lt;summary&gt;
    &lt;xsl:attribute name="xml:base" select="base-uri(/*)"/&gt;
    &lt;xsl:attribute name="imports"
                   select="count(/a:stylesheet//a:stylesheet[@transclusion='import'])"/&gt;
    &lt;xsl:attribute name="includes"
                   select="count(/a:stylesheet//a:stylesheet[@transclusion='include'])"/&gt;
    &lt;xsl:attribute name="variables"
                   select="count(//a:variable[parent::a:stylesheet and @class='variable'])"/&gt;
    &lt;xsl:attribute name="params"
                   select="count(//a:variable[parent::a:stylesheet and @class='param'])"/&gt;
    &lt;xsl:attribute name="templates"
                   select="count(//a:template[parent::a:stylesheet])"/&gt;
    &lt;xsl:attribute name="functions"
                   select="count(//a:function[parent::a:stylesheet])"/&gt;
    &lt;xsl:attribute name="fixmes"
                   select="count(//a:comment)"/&gt;
    &lt;xsl:apply-templates/&gt;
  &lt;/summary&gt;
&lt;/xsl:template&gt;

&lt;xsl:template match="a:stylesheet"&gt;
  &lt;xsl:variable name="stylesheet" select="."/&gt;
  &lt;xsl:variable name="depth" select="count(ancestor::a:stylesheet)+1"/&gt;

  &lt;stylesheet&gt;
    &lt;xsl:copy-of select="@id,@xml:base,@depth,@href,@transclusion"/&gt;

    &lt;xsl:variable name="imports" select="a:stylesheet[@transclusion='import']"/&gt;
    &lt;xsl:variable name="includes" select="a:stylesheet[@transclusion='include']"/&gt;
    &lt;xsl:variable name="vars" select="a:variable[@class='variable']"/&gt;
    &lt;xsl:variable name="params" select="a:variable[@class='param']"/&gt;
    &lt;xsl:variable name="templates" select="a:template"/&gt;
    &lt;xsl:variable name="functions" select="a:function"/&gt;
    &lt;xsl:variable name="fixmes" select=".//a:comment except .//a:stylesheet//a:comment"/&gt;

    &lt;xsl:attribute name="imports" select="count($imports)"/&gt;
    &lt;xsl:attribute name="includes" select="count($includes)"/&gt;
    &lt;xsl:attribute name="variables" select="count($vars)"/&gt;
    &lt;xsl:attribute name="params" select="count($params)"/&gt;
    &lt;xsl:attribute name="templates" select="count($templates)"/&gt;
    &lt;xsl:attribute name="functions" select="count($functions)"/&gt;
    &lt;xsl:attribute name="fixmes" select="count($fixmes)"/&gt;

    &lt;xsl:variable name="vp-unused" as="element(a:variable)*"
                  select="a:variable[empty(key('xref', @id))]"/&gt;

    &lt;xsl:variable name="vp-shadows"
                  select="a:variable[f:variable(., @name/string())]"/&gt;

    &lt;xsl:variable name="vp-elsewhere" as="element(a:variable)*"&gt;
      &lt;xsl:for-each select="a:variable"&gt;
        &lt;xsl:variable name="used-in"
                      select="key('xref', @id, root($stylesheet))
                                /ancestor::a:stylesheet[not(@transclusion='include')][1]
                              union ()"/&gt;
        &lt;xsl:if test="count($used-in) = 1 and exists($used-in except parent::*)"&gt;
          &lt;xsl:sequence select="."/&gt;
        &lt;/xsl:if&gt;
      &lt;/xsl:for-each&gt;
    &lt;/xsl:variable&gt;

    &lt;variables&gt;
      &lt;xsl:for-each select="$vp-unused[@class='variable']"&gt;
        &lt;unused&gt;&lt;xsl:sequence select="f:generate-id(.)"/&gt;&lt;/unused&gt;
      &lt;/xsl:for-each&gt;
      &lt;xsl:for-each select="$vp-shadows[@class='variable']"&gt;
        &lt;shadows&gt;&lt;xsl:sequence select="f:generate-id(.)"/&gt;&lt;/shadows&gt;
      &lt;/xsl:for-each&gt;
      &lt;xsl:for-each select="$vp-elsewhere[@class='variable']"&gt;
        &lt;elsewhere&gt;&lt;xsl:sequence select="f:generate-id(.)"/&gt;&lt;/elsewhere&gt;
      &lt;/xsl:for-each&gt;
    &lt;/variables&gt;

    &lt;params&gt;
      &lt;xsl:for-each select="$vp-unused[@class='param']"&gt;
        &lt;unused&gt;&lt;xsl:sequence select="f:generate-id(.)"/&gt;&lt;/unused&gt;
      &lt;/xsl:for-each&gt;
      &lt;xsl:for-each select="$vp-shadows[@class='param']"&gt;
        &lt;shadows&gt;&lt;xsl:sequence select="f:generate-id(.)"/&gt;&lt;/shadows&gt;
      &lt;/xsl:for-each&gt;
      &lt;xsl:for-each select="$vp-elsewhere[@class='param']"&gt;
        &lt;elsewhere&gt;&lt;xsl:sequence select="f:generate-id(.)"/&gt;&lt;/elsewhere&gt;
      &lt;/xsl:for-each&gt;
    &lt;/params&gt;

    &lt;xsl:variable name="templates-unused" as="element(a:template)*"&gt;
      &lt;xsl:for-each select="a:template[@name]"&gt;
        &lt;xsl:variable name="this" select="."/&gt;
        &lt;xsl:variable name="used-in" as="element()*"&gt;
          &lt;xsl:for-each select="key('xref', @id, root($stylesheet))"&gt;
            &lt;!-- recursion doesn't count as use --&gt;
            &lt;xsl:if test="not($this intersect ancestor::*)"&gt;
              &lt;xsl:sequence select="."/&gt;
            &lt;/xsl:if&gt;
          &lt;/xsl:for-each&gt;
        &lt;/xsl:variable&gt;
        &lt;xsl:if test="empty($used-in)"&gt;
          &lt;xsl:sequence select="."/&gt;
        &lt;/xsl:if&gt;
      &lt;/xsl:for-each&gt;
    &lt;/xsl:variable&gt;

    &lt;xsl:variable name="templates-shadow"
                  select="a:template[@name and f:template-shadows(., @name/string())]"/&gt;

    &lt;xsl:variable name="templates-elsewhere" as="element(a:template)*"&gt;
      &lt;xsl:for-each select="a:template[@name]"&gt;
        &lt;xsl:variable name="used-by"
                      select="(key('xref', @id)
                              /ancestor::*[parent::a:stylesheet[not(@transclusion='include')]][1])
                              union ()"/&gt;
        &lt;xsl:variable name="used-by-modules"
                      select="$used-by/parent::* union ()"/&gt;
        &lt;xsl:if test="count($used-by-modules) = 1
                      and not(parent::* is $used-by-modules)"&gt;
          &lt;xsl:sequence select="."/&gt;
        &lt;/xsl:if&gt;
      &lt;/xsl:for-each&gt;
    &lt;/xsl:variable&gt;

    &lt;templates&gt;
      &lt;xsl:for-each select="$templates-unused"&gt;
        &lt;unused&gt;&lt;xsl:sequence select="f:generate-id(.)"/&gt;&lt;/unused&gt;
      &lt;/xsl:for-each&gt;
      &lt;xsl:for-each select="$templates-shadow"&gt;
        &lt;shadows&gt;&lt;xsl:sequence select="f:generate-id(.)"/&gt;&lt;/shadows&gt;
      &lt;/xsl:for-each&gt;
      &lt;xsl:for-each select="$templates-elsewhere"&gt;
        &lt;elsewhere&gt;&lt;xsl:sequence select="f:generate-id(.)"/&gt;&lt;/elsewhere&gt;
      &lt;/xsl:for-each&gt;
    &lt;/templates&gt;

    &lt;comments/&gt;

    &lt;xsl:variable name="functions-shadow"
                  select="a:function[@name and f:function-shadows(., @name/string())]"/&gt;

    &lt;functions&gt;
      &lt;xsl:variable name="functions-unused" as="element(a:function)*"&gt;
        &lt;xsl:for-each select="a:function"&gt;
          &lt;xsl:variable name="this" select="."/&gt;
          &lt;xsl:variable name="used-in" as="element()*"&gt;
            &lt;xsl:for-each select="key('xref', @id, root($stylesheet))"&gt;
              &lt;!-- recursion doesn't count as use --&gt;
              &lt;xsl:if test="not($this intersect ancestor::*)"&gt;
                &lt;xsl:sequence select="."/&gt;
              &lt;/xsl:if&gt;
            &lt;/xsl:for-each&gt;
          &lt;/xsl:variable&gt;
          &lt;xsl:if test="empty($used-in)"&gt;
            &lt;xsl:sequence select="."/&gt;
          &lt;/xsl:if&gt;
        &lt;/xsl:for-each&gt;
      &lt;/xsl:variable&gt;

      &lt;xsl:variable name="functions-elsewhere" as="element(a:function)*"&gt;
        &lt;xsl:for-each select="a:function"&gt;
          &lt;xsl:variable name="used-in"
                        select="key('xref', @id, root($stylesheet))
                                    /ancestor::a:stylesheet[not(@transclusion='include')][1]
                                union ()"/&gt;
          &lt;xsl:if test="count($used-in) = 1 and exists($used-in except parent::*)"&gt;
            &lt;xsl:sequence select="."/&gt;
          &lt;/xsl:if&gt;
        &lt;/xsl:for-each&gt;
      &lt;/xsl:variable&gt;

      &lt;xsl:for-each select="$functions-unused"&gt;
        &lt;unused&gt;&lt;xsl:sequence select="f:generate-id(.)"/&gt;&lt;/unused&gt;
      &lt;/xsl:for-each&gt;
      &lt;xsl:for-each select="$functions-shadow"&gt;
        &lt;shadows&gt;&lt;xsl:sequence select="f:generate-id(.)"/&gt;&lt;/shadows&gt;
      &lt;/xsl:for-each&gt;
      &lt;xsl:for-each select="$functions-elsewhere"&gt;
        &lt;elsewhere&gt;&lt;xsl:sequence select="f:generate-id(.)"/&gt;&lt;/elsewhere&gt;
      &lt;/xsl:for-each&gt;
    &lt;/functions&gt;

    &lt;xsl:apply-templates select="a:variable|a:template|a:function|a:stylesheet"/&gt;
    &lt;xsl:apply-templates select=".//a:comment except .//a:stylesheet//a:comment"/&gt;
  &lt;/stylesheet&gt;
&lt;/xsl:template&gt;

&lt;xsl:template match="a:function"&gt;
  &lt;xsl:variable name="used-by" as="element()*"&gt;
    &lt;xsl:for-each select="key('xref', @id)"&gt;
      &lt;xsl:sequence
          select="ancestor::*[parent::a:stylesheet[not(@transclusion='include')]][1]"/&gt;
    &lt;/xsl:for-each&gt;
  &lt;/xsl:variable&gt;

  &lt;!-- remove dups --&gt;
  &lt;xsl:variable name="used-by" select="$used-by union ()"/&gt;

  &lt;xsl:variable name="used-by-modules"
                select="$used-by/parent::* union ()"/&gt;

  &lt;xsl:variable name="used-only-elsewhere"
                select="count($used-by-modules) = 1
                        and not(parent::* is $used-by-modules)"/&gt;

  &lt;xsl:variable name="shadows"
                select="f:function-shadows(., @name/string())"/&gt;

  &lt;xsl:variable name="classes" as="xs:string+"&gt;
    &lt;xsl:sequence select="local-name(.)"/&gt;
    &lt;xsl:sequence select="if (empty($used-by)) then 'unused' else ()"/&gt;
    &lt;xsl:sequence select="if ($shadows) then 'shadows' else ()"/&gt;
    &lt;xsl:sequence select="if ($used-only-elsewhere) then 'elsewhere' else ()"/&gt;
  &lt;/xsl:variable&gt;

  &lt;function id="{f:generate-id(.)}"
            class="{string-join($classes, ' ')}"
            recursive="{exists(. intersect $used-by)}"
            elsewhere="{$used-only-elsewhere}"&gt;
    &lt;xsl:copy-of select="@name,@display-name,@id,@as,@line-number,@column-number"/&gt;
    &lt;xsl:copy-of select="a:param" copy-namespaces="no"/&gt;

    &lt;xsl:for-each select="$shadows"&gt;
      &lt;shadow&gt;&lt;xsl:sequence select="f:generate-id(.)"/&gt;&lt;/shadow&gt;
    &lt;/xsl:for-each&gt;

    &lt;xsl:for-each select="key('fnoarity', @noarity-id) except $shadows"&gt;
      &lt;no-arity&gt;&lt;xsl:sequence select="f:generate-id(.)"/&gt;&lt;/no-arity&gt;
    &lt;/xsl:for-each&gt;

    &lt;xsl:for-each select="f:variables-referenced(.)"&gt;
      &lt;variable&gt;&lt;xsl:sequence select="f:generate-id(.)"/&gt;&lt;/variable&gt;
    &lt;/xsl:for-each&gt;

    &lt;xsl:for-each select="$used-by/self::a:function except ."&gt;
      &lt;function&gt;&lt;xsl:sequence select="f:generate-id(.)"/&gt;&lt;/function&gt;
    &lt;/xsl:for-each&gt;

    &lt;xsl:for-each select="f:template-calls(.)"&gt;
      &lt;template&gt;&lt;xsl:sequence select="f:generate-id(.)"/&gt;&lt;/template&gt;
    &lt;/xsl:for-each&gt;

    &lt;xsl:for-each select="$used-by"&gt;
      &lt;used-by&gt;&lt;xsl:sequence select="f:generate-id(.)"/&gt;&lt;/used-by&gt;
    &lt;/xsl:for-each&gt;

    &lt;xsl:for-each select="$used-by-modules"&gt;
      &lt;used-by-module&gt;&lt;xsl:sequence select="f:generate-id(.)"/&gt;&lt;/used-by-module&gt;
    &lt;/xsl:for-each&gt;
  &lt;/function&gt;
&lt;/xsl:template&gt;

&lt;xsl:template match="a:variable"&gt;
  &lt;xsl:variable name="this" select="."/&gt;
  &lt;xsl:variable name="id" select="@id/string()"/&gt;

  &lt;xsl:variable name="used-by" as="element()*"&gt;
    &lt;xsl:for-each select="key('xref', @id)"&gt;
      &lt;xsl:sequence
          select="ancestor::*[parent::a:stylesheet[not(@transclusion='include')]][1]"/&gt;
    &lt;/xsl:for-each&gt;
  &lt;/xsl:variable&gt;

  &lt;!-- remove dups --&gt;
  &lt;xsl:variable name="used-by" select="$used-by union ()"/&gt;

  &lt;xsl:variable name="used-by-modules"
                select="$used-by/parent::* union ()"/&gt;

  &lt;xsl:variable name="used-only-elsewhere"
                select="count($used-by-modules) = 1
                        and not(parent::* is $used-by-modules)"/&gt;

  &lt;xsl:variable name="shadows" select="f:variable(., @name/string())"/&gt;

  &lt;xsl:variable name="classes" as="xs:string+"&gt;
    &lt;xsl:sequence select="@class/string()"/&gt;
    &lt;xsl:sequence select="if ($shadows) then 'shadows' else ()"/&gt;
    &lt;xsl:sequence select="if (empty($used-by)) then 'unused' else ()"/&gt;
    &lt;xsl:sequence select="if ($used-only-elsewhere) then 'elsewhere' else ()"/&gt;
  &lt;/xsl:variable&gt;

  &lt;variable id="{f:generate-id(.)}"
            class="{string-join($classes, ' ')}"
            type="{@class}"
            elsewhere="{$used-only-elsewhere}"&gt;
    &lt;xsl:copy-of select="@static,@name,@line-number,@column-number,@display-name,@as"/&gt;

    &lt;xsl:for-each select="$shadows"&gt;
      &lt;shadow&gt;&lt;xsl:sequence select="f:generate-id(.)"/&gt;&lt;/shadow&gt;
    &lt;/xsl:for-each&gt;

    &lt;xsl:for-each select="f:variables-referenced(.)"&gt;
      &lt;variable&gt;&lt;xsl:sequence select="f:generate-id(.)"/&gt;&lt;/variable&gt;
    &lt;/xsl:for-each&gt;

    &lt;xsl:for-each select="f:function-calls(.)"&gt;
      &lt;function&gt;&lt;xsl:sequence select="f:generate-id(.)"/&gt;&lt;/function&gt;
    &lt;/xsl:for-each&gt;

    &lt;xsl:for-each select="f:template-calls(.)"&gt;
      &lt;template&gt;&lt;xsl:sequence select="f:generate-id(.)"/&gt;&lt;/template&gt;
    &lt;/xsl:for-each&gt;

    &lt;xsl:for-each select="$used-by"&gt;
      &lt;used-by class="{local-name(.)}"&gt;&lt;xsl:sequence select="f:generate-id(.)"/&gt;&lt;/used-by&gt;
    &lt;/xsl:for-each&gt;

    &lt;xsl:for-each select="$used-by-modules"&gt;
      &lt;used-by-module&gt;&lt;xsl:sequence select="f:generate-id(.)"/&gt;&lt;/used-by-module&gt;
    &lt;/xsl:for-each&gt;
  &lt;/variable&gt;
&lt;/xsl:template&gt;

&lt;xsl:template match="a:template"&gt;
  &lt;xsl:variable name="this" select="."/&gt;

  &lt;xsl:variable name="used-by" as="element()*"&gt;
    &lt;xsl:if test="@name"&gt;
      &lt;xsl:sequence
          select="(key('xref', @id)/ancestor::*
                     [parent::a:stylesheet[not(@transclusion='include')]][1])
                   union ()"/&gt;
    &lt;/xsl:if&gt;
  &lt;/xsl:variable&gt;

  &lt;xsl:variable name="used-by-modules"
                select="$used-by/parent::* union ()"/&gt;

  &lt;xsl:variable name="used-only-elsewhere"
                select="count($used-by-modules) = 1
                        and not(parent::* is $used-by-modules)"/&gt;

  &lt;xsl:variable name="shadows"
                select="if (@name) then f:template-shadows(., @name/string()) else ()"/&gt;

  &lt;xsl:variable name="classes" as="xs:string+"&gt;
    &lt;xsl:sequence select="local-name(.)"/&gt;
    &lt;xsl:sequence select="if ($shadows) then 'shadows' else ()"/&gt;
    &lt;xsl:sequence select="if (@name and empty($used-by)) then 'unused' else ()"/&gt;
    &lt;xsl:sequence select="if ($used-only-elsewhere) then 'elsewhere' else ()"/&gt;
  &lt;/xsl:variable&gt;

  &lt;template id="{f:generate-id(.)}"
            class="{string-join($classes, ' ')}"
            recursive="{exists(. intersect $used-by)}"
            elsewhere="{$used-only-elsewhere}"&gt;
    &lt;xsl:copy-of select="@name,@display-name,@match,@as,@mode,@display-mode,
                         @priority,@line-number,@column-number"/&gt;

    &lt;xsl:for-each select="$shadows"&gt;
      &lt;shadow&gt;&lt;xsl:sequence select="f:generate-id(.)"/&gt;&lt;/shadow&gt;
    &lt;/xsl:for-each&gt;

    &lt;xsl:for-each select="f:variables-referenced(.)"&gt;
      &lt;variable&gt;&lt;xsl:sequence select="f:generate-id(.)"/&gt;&lt;/variable&gt;
    &lt;/xsl:for-each&gt;

    &lt;xsl:for-each select="f:function-calls(.)"&gt;
      &lt;function&gt;&lt;xsl:sequence select="f:generate-id(.)"/&gt;&lt;/function&gt;
    &lt;/xsl:for-each&gt;

    &lt;xsl:for-each select="f:template-calls(.) except ."&gt;
      &lt;template&gt;&lt;xsl:sequence select="f:generate-id(.)"/&gt;&lt;/template&gt;
    &lt;/xsl:for-each&gt;

    &lt;xsl:for-each select="$used-by"&gt;
      &lt;used-by&gt;&lt;xsl:sequence select="f:generate-id(.)"/&gt;&lt;/used-by&gt;
    &lt;/xsl:for-each&gt;

    &lt;xsl:for-each select="$used-by-modules"&gt;
      &lt;used-by-module&gt;&lt;xsl:sequence select="f:generate-id(.)"/&gt;&lt;/used-by-module&gt;
    &lt;/xsl:for-each&gt;
  &lt;/template&gt;
&lt;/xsl:template&gt;

&lt;xsl:template match="a:comment"&gt;
  &lt;comment id="{f:generate-id(.)}"
           class="comment"&gt;
    &lt;xsl:copy-of select="@line-number,@column-number"/&gt;
    &lt;xsl:sequence select="normalize-space(.)"/&gt;
  &lt;/comment&gt;
&lt;/xsl:template&gt;

&lt;xsl:function name="f:variables-referenced" as="element(a:variable)*"&gt;
  &lt;xsl:param name="node" as="element()"/&gt;
  &lt;xsl:sequence select="($node//a:variable-ref ! key('id', @xref))[parent::a:stylesheet] union ()"/&gt;
&lt;/xsl:function&gt;

&lt;xsl:function name="f:function-calls" as="element(a:function)*"&gt;
  &lt;xsl:param name="node" as="element()"/&gt;
  &lt;xsl:sequence select="($node//a:function-call ! key('id', @xref))[parent::a:stylesheet] union ()"/&gt;
&lt;/xsl:function&gt;

&lt;xsl:function name="f:template-calls" as="element(a:template)*"&gt;
  &lt;xsl:param name="node" as="element()"/&gt;
  &lt;xsl:sequence select="($node//a:call-template ! key('id', @xref))[parent::a:stylesheet] union ()"/&gt;
&lt;/xsl:function&gt;

&lt;xsl:function name="f:generate-id" as="xs:string"&gt;
  &lt;xsl:param name="node" as="element()"/&gt;
  &lt;xsl:if test="not($node/@id)"&gt;
    &lt;xsl:message terminate="yes" select="'No id?', $node"/&gt;
  &lt;/xsl:if&gt;
  &lt;xsl:sequence select="$node/@id/string()"/&gt;
&lt;/xsl:function&gt;

&lt;!-- ============================================================ --&gt;

&lt;xsl:function name="f:variable" as="element(a:variable)?"&gt;
  &lt;xsl:param name="context" as="element()"/&gt;
  &lt;xsl:param name="ref" as="xs:string"/&gt;

  &lt;xsl:choose&gt;
    &lt;xsl:when test="$context/preceding-sibling::a:variable[@name=$ref]"&gt;
      &lt;xsl:sequence select="$context/preceding-sibling::a:variable[@name=$ref][1]"/&gt;
    &lt;/xsl:when&gt;
    &lt;xsl:when test="$context/self::a:stylesheet"&gt;
      &lt;xsl:sequence select="($context/preceding::a:stylesheet/a:variable[@name=$ref])[last()]"/&gt;
    &lt;/xsl:when&gt;
    &lt;xsl:when test="empty($context)"&gt;
      &lt;xsl:sequence select="()"/&gt;
    &lt;/xsl:when&gt;
    &lt;xsl:otherwise&gt;
      &lt;xsl:sequence select="f:variable($context/parent::*, $ref)"/&gt;
    &lt;/xsl:otherwise&gt;
  &lt;/xsl:choose&gt;
&lt;/xsl:function&gt;

&lt;xsl:function name="f:template-shadows" as="element(a:template)?"&gt;
  &lt;xsl:param name="context" as="element()"/&gt;
  &lt;xsl:param name="ref" as="xs:string"/&gt;

  &lt;xsl:choose&gt;
    &lt;xsl:when test="$context/preceding-sibling::a:template[@name=$ref]"&gt;
      &lt;xsl:sequence select="$context/preceding-sibling::a:template[@name=$ref][1]"/&gt;
    &lt;/xsl:when&gt;
    &lt;xsl:when test="$context/self::a:stylesheet"&gt;
      &lt;xsl:sequence
          select="($context/preceding::a:stylesheet/a:template[@name=$ref])[last()]"/&gt;
    &lt;/xsl:when&gt;
    &lt;xsl:when test="empty($context)"&gt;
      &lt;xsl:sequence select="()"/&gt;
    &lt;/xsl:when&gt;
    &lt;xsl:otherwise&gt;
      &lt;xsl:sequence select="f:template-shadows($context/parent::*, $ref)"/&gt;
    &lt;/xsl:otherwise&gt;
  &lt;/xsl:choose&gt;
&lt;/xsl:function&gt;

&lt;xsl:function name="f:function-shadows" as="element(a:function)?"&gt;
  &lt;xsl:param name="context" as="element()"/&gt;
  &lt;xsl:param name="ref" as="xs:string"/&gt;

  &lt;xsl:choose&gt;
    &lt;xsl:when test="$context/preceding-sibling::a:function[@name=$ref]"&gt;
      &lt;xsl:sequence select="$context/preceding-sibling::a:function[@name=$ref][1]"/&gt;
    &lt;/xsl:when&gt;
    &lt;xsl:when test="$context/self::a:stylesheet"&gt;
      &lt;xsl:sequence
          select="($context/preceding::a:stylesheet/a:function[@name=$ref])[last()]"/&gt;
    &lt;/xsl:when&gt;
    &lt;xsl:when test="empty($context)"&gt;
      &lt;xsl:sequence select="()"/&gt;
    &lt;/xsl:when&gt;
    &lt;xsl:otherwise&gt;
      &lt;xsl:sequence select="f:function-shadows($context/parent::*, $ref)"/&gt;
    &lt;/xsl:otherwise&gt;
  &lt;/xsl:choose&gt;
&lt;/xsl:function&gt;

&lt;/xsl:stylesheet&gt;
</code></pre></td></tr></table></div></div></div></div><div class="stylesheet" id="S-60890"><h2>summarize.xsl</h2><p><span><span class="template all">15 templates</span></span>, <span><span class="function all">4 functions</span></span>, <span><span class="variable all">1 variable</span></span>, <span><span class="param all">5 params</span></span></p><div class="instructions"><div class="title closed">Instructions</div><div class="body"><div id="S-60890-..css" class="instruction param"><div class="title"><span class="link" title="Line 15"><a href="#line-d47615e426-15" class="goto-lno">§</a></span>Param <code>$css</code></div><div class="props"><div class="used-by"><span class="marker"></span>Used by: <a href="#S-60890-t-1">template</a></div><div class="used-in"><span class="marker"></span>Used in: <a href="#S-60890">summarize.xsl</a></div></div></div><div id="S-60890-..js" class="instruction param"><div class="title"><span class="link" title="Line 16"><a href="#line-d47615e426-16" class="goto-lno">§</a></span>Param <code>$js</code></div><div class="props"><div class="used-by"><span class="marker"></span>Used by: <a href="#S-60890-t-1">template</a></div><div class="used-in"><span class="marker"></span>Used in: <a href="#S-60890">summarize.xsl</a></div></div></div><div id="S-60890-..prismcss" class="instruction param"><div class="title"><span class="link" title="Line 17"><a href="#line-d47615e426-17" class="goto-lno">§</a></span>Param <code>$prismcss</code></div><div class="props"><div class="used-by"><span class="marker"></span>Used by: <a href="#S-60890-t-1">template</a></div><div class="used-in"><span class="marker"></span>Used in: <a href="#S-60890">summarize.xsl</a></div></div></div><div id="S-60890-..prismjs" class="instruction param"><div class="title"><span class="link" title="Line 18"><a href="#line-d47615e426-18" class="goto-lno">§</a></span>Param <code>$prismjs</code></div><div class="props"><div class="used-by"><span class="marker"></span>Used by: <a href="#S-60890-t-1">template</a></div><div class="used-in"><span class="marker"></span>Used in: <a href="#S-60890">summarize.xsl</a></div></div></div><div id="S-60890-..title" class="instruction param"><div class="title"><span class="link" title="Line 20"><a href="#line-d47615e426-20" class="goto-lno">§</a></span>Param <code>$title</code></div><div class="props"><div class="used-by"><span class="marker"></span>Used by: <a href="#S-60890-t-1">template</a></div><div class="used-in"><span class="marker"></span>Used in: <a href="#S-60890">summarize.xsl</a></div></div></div><div id="S-60890-..Z" class="instruction variable"><div class="title"><span class="link" title="Line 22"><a href="#line-d47615e426-22" class="goto-lno">§</a></span>Variable <code>$Z</code></div><div class="props"><div class="used-by"><span class="marker"></span>Used by: <a href="#S-60890-t-1">template</a></div><div class="used-in"><span class="marker"></span>Used in: <a href="#S-60890">summarize.xsl</a></div></div></div><div id="S-60890-t-1" class="instruction template"><div class="title"><span class="link" title="Line 24"><a href="#line-d47615e426-24" class="goto-lno">§</a></span>Template match ≅ a:summary</div><div class="props"><div class="uses">Uses: <a href="#S-16674-..TITLE">$TITLE</a>, <a href="#S-16674-..VERHASH">$VERHASH</a>, <a href="#S-16674-..VERSION">$VERSION</a>, <a href="#S-60890-..Z">$Z</a>, <a href="#S-60890-..css">$css</a>, <a href="#S-60890-..js">$js</a>, <a href="#S-60890-..prismcss">$prismcss</a>, <a href="#S-60890-..prismjs">$prismjs</a>, <a href="#S-60890-..title">$title</a></div><div class="calls">Calls: <a href="#S-60890-nwalsh.com.ns.xslt.functions.summary-count,2">f:summary-count()</a></div><div class="mode">Mode: <code>m:summarize</code></div><div class="matches">Matches: <code>a:summary</code></div></div></div><div id="S-60890-t-2" class="instruction template"><div class="title"><span class="link" title="Line 145"><a href="#line-d47615e426-145" class="goto-lno">§</a></span>Template match ≅ a:stylesheet</div><div class="props"><div class="uses">Uses: <a href="#S-49518-..source-listings">$source-listings</a></div><div class="calls">Calls: <a href="#S-60890-nwalsh.com.ns.xslt.functions.summary-count,2">f:summary-count()</a>, <a href="#S-60890-nwalsh.com.ns.xslt.functions.summary-details,1">f:summary-details()</a></div><div class="mode">Mode: <code>m:summarize</code></div><div class="matches">Matches: <code>a:stylesheet</code></div></div></div><div id="S-60890-t-3" class="instruction template"><div class="title"><span class="link" title="Line 281"><a href="#line-d47615e426-281" class="goto-lno">§</a></span>Template match ≅ a:function</div><div class="props"><div class="calls">Calls: <a href="#S-60890-nwalsh.com.ns.xslt.functions.line-link,1">f:line-link()</a>, <a href="#S-60890-nwalsh.com.ns.xslt.functions.reference-list,1">f:reference-list()</a></div><div class="calls">Calls: <a href="#S-60890-nwalsh.com.ns.xslt.templates.functions-called">t:functions-called</a>, <a href="#S-60890-nwalsh.com.ns.xslt.templates.templates-called">t:templates-called</a>, <a href="#S-60890-nwalsh.com.ns.xslt.templates.variables-referenced">t:variables-referenced</a></div><div class="mode">Mode: <code>m:summarize</code></div><div class="matches">Matches: <code>a:function</code></div></div></div><div id="S-60890-t-4" class="instruction template"><div class="title"><span class="link" title="Line 364"><a href="#line-d47615e426-364" class="goto-lno">§</a></span>Template match ≅ a:variable</div><div class="props"><div class="calls">Calls: <a href="#S-60890-nwalsh.com.ns.xslt.functions.line-link,1">f:line-link()</a>, <a href="#S-60890-nwalsh.com.ns.xslt.functions.reference-list,1">f:reference-list()</a></div><div class="calls">Calls: <a href="#S-60890-nwalsh.com.ns.xslt.templates.functions-called">t:functions-called</a>, <a href="#S-60890-nwalsh.com.ns.xslt.templates.templates-called">t:templates-called</a>, <a href="#S-60890-nwalsh.com.ns.xslt.templates.variables-referenced">t:variables-referenced</a></div><div class="mode">Mode: <code>m:summarize</code></div><div class="matches">Matches: <code>a:variable</code></div></div></div><div id="S-60890-t-5" class="instruction template"><div class="title"><span class="link" title="Line 428"><a href="#line-d47615e426-428" class="goto-lno">§</a></span>Template match ≅ a:template</div><div class="props"><div class="calls">Calls: <a href="#S-60890-nwalsh.com.ns.xslt.functions.line-link,1">f:line-link()</a>, <a href="#S-60890-nwalsh.com.ns.xslt.functions.reference-list,1">f:reference-list()</a></div><div class="calls">Calls: <a href="#S-60890-nwalsh.com.ns.xslt.templates.functions-called">t:functions-called</a>, <a href="#S-60890-nwalsh.com.ns.xslt.templates.templates-called">t:templates-called</a>, <a href="#S-60890-nwalsh.com.ns.xslt.templates.variables-referenced">t:variables-referenced</a></div><div class="mode">Mode: <code>m:summarize</code></div><div class="matches">Matches: <code>a:template</code></div></div></div><div id="S-60890-t-6" class="instruction template"><div class="title"><span class="link" title="Line 542"><a href="#line-d47615e426-542" class="goto-lno">§</a></span>Template match ≅ a:comment</div><div class="props"><div class="calls">Calls: <a href="#S-60890-nwalsh.com.ns.xslt.functions.line-link,1">f:line-link()</a></div><div class="mode">Mode: <code>m:summarize</code></div><div class="matches">Matches: <code>a:comment</code></div></div></div><div id="S-60890-nwalsh.com.ns.xslt.templates.variables-referenced" class="instruction template"><div class="title"><span class="link" title="Line 558"><a href="#line-d47615e426-558" class="goto-lno">§</a></span>Template t:variables-referenced  match ≅ </div><div class="props"><div class="used-by"><span class="marker"></span>Used by: <a href="#S-60890-t-3">template</a>, <a href="#S-60890-t-4">template</a>, <a href="#S-60890-t-5">template</a></div><div class="used-in"><span class="marker"></span>Used in: <a href="#S-60890">summarize.xsl</a></div><div class="mode">Mode: <code>m:summarize</code></div></div></div><div id="S-60890-nwalsh.com.ns.xslt.templates.functions-called" class="instruction template"><div class="title"><span class="link" title="Line 571"><a href="#line-d47615e426-571" class="goto-lno">§</a></span>Template t:functions-called  match ≅ </div><div class="props"><div class="used-by"><span class="marker"></span>Used by: <a href="#S-60890-t-3">template</a>, <a href="#S-60890-t-4">template</a>, <a href="#S-60890-t-5">template</a></div><div class="used-in"><span class="marker"></span>Used in: <a href="#S-60890">summarize.xsl</a></div><div class="mode">Mode: <code>m:summarize</code></div></div></div><div id="S-60890-nwalsh.com.ns.xslt.templates.templates-called" class="instruction template"><div class="title"><span class="link" title="Line 584"><a href="#line-d47615e426-584" class="goto-lno">§</a></span>Template t:templates-called  match ≅ </div><div class="props"><div class="used-by"><span class="marker"></span>Used by: <a href="#S-60890-t-3">template</a>, <a href="#S-60890-t-4">template</a>, <a href="#S-60890-t-5">template</a></div><div class="used-in"><span class="marker"></span>Used in: <a href="#S-60890">summarize.xsl</a></div><div class="mode">Mode: <code>m:summarize</code></div></div></div><div id="S-60890-nwalsh.com.ns.xslt.functions.reference-list,1" class="instruction function"><div class="title"><span class="link" title="Line 599"><a href="#line-d47615e426-599" class="goto-lno">§</a></span>Function f:reference-list($refs as element()+)</div><div class="props"><div class="used-by"><span class="marker"></span>Used by: <a href="#S-60890-t-3">template</a>, <a href="#S-60890-t-4">template</a>, <a href="#S-60890-t-5">template</a></div><div class="used-in"><span class="marker"></span>Used in: <a href="#S-60890">summarize.xsl</a></div></div></div><div id="S-60890-t-10" class="instruction template"><div class="title"><span class="link" title="Line 609"><a href="#line-d47615e426-609" class="goto-lno">§</a></span>Template match ≅ *</div><div class="props"><div class="mode">Mode: <code>m:reference</code></div><div class="matches">Matches: <code>*</code></div></div></div><div id="S-60890-t-11" class="instruction template"><div class="title"><span class="link" title="Line 616"><a href="#line-d47615e426-616" class="goto-lno">§</a></span>Template match ≅ a:stylesheet</div><div class="props"><div class="mode">Mode: <code>m:reference</code></div><div class="matches">Matches: <code>a:stylesheet</code></div></div></div><div id="S-60890-t-12" class="instruction template"><div class="title"><span class="link" title="Line 624"><a href="#line-d47615e426-624" class="goto-lno">§</a></span>Template match ≅ a:variable</div><div class="props"><div class="mode">Mode: <code>m:reference</code></div><div class="matches">Matches: <code>a:variable</code></div></div></div><div id="S-60890-t-13" class="instruction template"><div class="title"><span class="link" title="Line 630"><a href="#line-d47615e426-630" class="goto-lno">§</a></span>Template match ≅ a:function</div><div class="props"><div class="mode">Mode: <code>m:reference</code></div><div class="matches">Matches: <code>a:function</code></div></div></div><div id="S-60890-t-14" class="instruction template"><div class="title"><span class="link" title="Line 647"><a href="#line-d47615e426-647" class="goto-lno">§</a></span>Template match ≅ a:template</div><div class="props"><div class="mode">Mode: <code>m:reference</code></div><div class="matches">Matches: <code>a:template</code></div></div></div><div id="S-60890-t-15" class="instruction template"><div class="title"><span class="link" title="Line 662"><a href="#line-d47615e426-662" class="goto-lno">§</a></span>Template match ≅ a:stylesheet</div><div class="props"><div class="mode">Mode: <code>m:toc</code></div><div class="matches">Matches: <code>a:stylesheet</code></div></div></div><div id="S-60890-nwalsh.com.ns.xslt.functions.line-link,1" class="instruction function"><div class="title"><span class="link" title="Line 678"><a href="#line-d47615e426-678" class="goto-lno">§</a></span>Function f:line-link($node as element()) as element(h:span)?</div><div class="props"><div class="uses">Uses: <a href="#S-49518-..source-listings">$source-listings</a></div><div class="used-by"><span class="marker"></span>Used by: <a href="#S-60890-t-3">template</a>, <a href="#S-60890-t-4">template</a>, <a href="#S-60890-t-5">template</a>, <a href="#S-60890-t-6">template</a></div><div class="used-in"><span class="marker"></span>Used in: <a href="#S-60890">summarize.xsl</a></div></div></div><div id="S-60890-nwalsh.com.ns.xslt.functions.summary-count,2" class="instruction function"><div class="title"><span class="link" title="Line 693"><a href="#line-d47615e426-693" class="goto-lno">§</a></span>Function f:summary-count($count as xs:string, $label as xs:string) as element(h:span)?</div><div class="props"><div class="used-by"><span class="marker"></span>Used by: <a href="#S-60890-t-1">template</a>, <a href="#S-60890-t-2">template</a></div><div class="used-in"><span class="marker"></span>Used in: <a href="#S-60890">summarize.xsl</a></div></div></div><div id="S-60890-nwalsh.com.ns.xslt.functions.summary-details,1" class="instruction function"><div class="title"><span class="link" title="Line 714"><a href="#line-d47615e426-714" class="goto-lno">§</a></span>Function f:summary-details($detail as element())</div><div class="props"><div class="used-by"><span class="marker"></span>Used by: <a href="#S-60890-t-2">template</a></div><div class="used-in"><span class="marker"></span>Used in: <a href="#S-60890">summarize.xsl</a></div></div></div></div></div><div class="source-code"><div class="title closed">Source code</div><div class="body"><div><table><tr><td valign="top" align="right"><pre class="fake-prism"><span id="line-d47615e426-1">1</span>
<span id="line-d47615e426-2"><span class="lno">2</span></span>
<span id="line-d47615e426-3"><span class="lno">3</span></span>
<span id="line-d47615e426-4"><span class="lno">4</span></span>
<span id="line-d47615e426-5">5</span>
<span id="line-d47615e426-6"><span class="lno">6</span></span>
<span id="line-d47615e426-7"><span class="lno">7</span></span>
<span id="line-d47615e426-8"><span class="lno">8</span></span>
<span id="line-d47615e426-9"><span class="lno">9</span></span>
<span id="line-d47615e426-10">10</span>
<span id="line-d47615e426-11"><span class="lno">11</span></span>
<span id="line-d47615e426-12"><span class="lno">12</span></span>
<span id="line-d47615e426-13"><span class="lno">13</span></span>
<span id="line-d47615e426-14"><span class="lno">14</span></span>
<span id="line-d47615e426-15">15</span>
<span id="line-d47615e426-16"><span class="lno">16</span></span>
<span id="line-d47615e426-17"><span class="lno">17</span></span>
<span id="line-d47615e426-18"><span class="lno">18</span></span>
<span id="line-d47615e426-19"><span class="lno">19</span></span>
<span id="line-d47615e426-20">20</span>
<span id="line-d47615e426-21"><span class="lno">21</span></span>
<span id="line-d47615e426-22"><span class="lno">22</span></span>
<span id="line-d47615e426-23"><span class="lno">23</span></span>
<span id="line-d47615e426-24"><span class="lno">24</span></span>
<span id="line-d47615e426-25">25</span>
<span id="line-d47615e426-26"><span class="lno">26</span></span>
<span id="line-d47615e426-27"><span class="lno">27</span></span>
<span id="line-d47615e426-28"><span class="lno">28</span></span>
<span id="line-d47615e426-29"><span class="lno">29</span></span>
<span id="line-d47615e426-30">30</span>
<span id="line-d47615e426-31"><span class="lno">31</span></span>
<span id="line-d47615e426-32"><span class="lno">32</span></span>
<span id="line-d47615e426-33"><span class="lno">33</span></span>
<span id="line-d47615e426-34"><span class="lno">34</span></span>
<span id="line-d47615e426-35">35</span>
<span id="line-d47615e426-36"><span class="lno">36</span></span>
<span id="line-d47615e426-37"><span class="lno">37</span></span>
<span id="line-d47615e426-38"><span class="lno">38</span></span>
<span id="line-d47615e426-39"><span class="lno">39</span></span>
<span id="line-d47615e426-40">40</span>
<span id="line-d47615e426-41"><span class="lno">41</span></span>
<span id="line-d47615e426-42"><span class="lno">42</span></span>
<span id="line-d47615e426-43"><span class="lno">43</span></span>
<span id="line-d47615e426-44"><span class="lno">44</span></span>
<span id="line-d47615e426-45">45</span>
<span id="line-d47615e426-46"><span class="lno">46</span></span>
<span id="line-d47615e426-47"><span class="lno">47</span></span>
<span id="line-d47615e426-48"><span class="lno">48</span></span>
<span id="line-d47615e426-49"><span class="lno">49</span></span>
<span id="line-d47615e426-50">50</span>
<span id="line-d47615e426-51"><span class="lno">51</span></span>
<span id="line-d47615e426-52"><span class="lno">52</span></span>
<span id="line-d47615e426-53"><span class="lno">53</span></span>
<span id="line-d47615e426-54"><span class="lno">54</span></span>
<span id="line-d47615e426-55">55</span>
<span id="line-d47615e426-56"><span class="lno">56</span></span>
<span id="line-d47615e426-57"><span class="lno">57</span></span>
<span id="line-d47615e426-58"><span class="lno">58</span></span>
<span id="line-d47615e426-59"><span class="lno">59</span></span>
<span id="line-d47615e426-60">60</span>
<span id="line-d47615e426-61"><span class="lno">61</span></span>
<span id="line-d47615e426-62"><span class="lno">62</span></span>
<span id="line-d47615e426-63"><span class="lno">63</span></span>
<span id="line-d47615e426-64"><span class="lno">64</span></span>
<span id="line-d47615e426-65">65</span>
<span id="line-d47615e426-66"><span class="lno">66</span></span>
<span id="line-d47615e426-67"><span class="lno">67</span></span>
<span id="line-d47615e426-68"><span class="lno">68</span></span>
<span id="line-d47615e426-69"><span class="lno">69</span></span>
<span id="line-d47615e426-70">70</span>
<span id="line-d47615e426-71"><span class="lno">71</span></span>
<span id="line-d47615e426-72"><span class="lno">72</span></span>
<span id="line-d47615e426-73"><span class="lno">73</span></span>
<span id="line-d47615e426-74"><span class="lno">74</span></span>
<span id="line-d47615e426-75">75</span>
<span id="line-d47615e426-76"><span class="lno">76</span></span>
<span id="line-d47615e426-77"><span class="lno">77</span></span>
<span id="line-d47615e426-78"><span class="lno">78</span></span>
<span id="line-d47615e426-79"><span class="lno">79</span></span>
<span id="line-d47615e426-80">80</span>
<span id="line-d47615e426-81"><span class="lno">81</span></span>
<span id="line-d47615e426-82"><span class="lno">82</span></span>
<span id="line-d47615e426-83"><span class="lno">83</span></span>
<span id="line-d47615e426-84"><span class="lno">84</span></span>
<span id="line-d47615e426-85">85</span>
<span id="line-d47615e426-86"><span class="lno">86</span></span>
<span id="line-d47615e426-87"><span class="lno">87</span></span>
<span id="line-d47615e426-88"><span class="lno">88</span></span>
<span id="line-d47615e426-89"><span class="lno">89</span></span>
<span id="line-d47615e426-90">90</span>
<span id="line-d47615e426-91"><span class="lno">91</span></span>
<span id="line-d47615e426-92"><span class="lno">92</span></span>
<span id="line-d47615e426-93"><span class="lno">93</span></span>
<span id="line-d47615e426-94"><span class="lno">94</span></span>
<span id="line-d47615e426-95">95</span>
<span id="line-d47615e426-96"><span class="lno">96</span></span>
<span id="line-d47615e426-97"><span class="lno">97</span></span>
<span id="line-d47615e426-98"><span class="lno">98</span></span>
<span id="line-d47615e426-99"><span class="lno">99</span></span>
<span id="line-d47615e426-100">100</span>
<span id="line-d47615e426-101"><span class="lno">101</span></span>
<span id="line-d47615e426-102"><span class="lno">102</span></span>
<span id="line-d47615e426-103"><span class="lno">103</span></span>
<span id="line-d47615e426-104"><span class="lno">104</span></span>
<span id="line-d47615e426-105">105</span>
<span id="line-d47615e426-106"><span class="lno">106</span></span>
<span id="line-d47615e426-107"><span class="lno">107</span></span>
<span id="line-d47615e426-108"><span class="lno">108</span></span>
<span id="line-d47615e426-109"><span class="lno">109</span></span>
<span id="line-d47615e426-110">110</span>
<span id="line-d47615e426-111"><span class="lno">111</span></span>
<span id="line-d47615e426-112"><span class="lno">112</span></span>
<span id="line-d47615e426-113"><span class="lno">113</span></span>
<span id="line-d47615e426-114"><span class="lno">114</span></span>
<span id="line-d47615e426-115">115</span>
<span id="line-d47615e426-116"><span class="lno">116</span></span>
<span id="line-d47615e426-117"><span class="lno">117</span></span>
<span id="line-d47615e426-118"><span class="lno">118</span></span>
<span id="line-d47615e426-119"><span class="lno">119</span></span>
<span id="line-d47615e426-120">120</span>
<span id="line-d47615e426-121"><span class="lno">121</span></span>
<span id="line-d47615e426-122"><span class="lno">122</span></span>
<span id="line-d47615e426-123"><span class="lno">123</span></span>
<span id="line-d47615e426-124"><span class="lno">124</span></span>
<span id="line-d47615e426-125">125</span>
<span id="line-d47615e426-126"><span class="lno">126</span></span>
<span id="line-d47615e426-127"><span class="lno">127</span></span>
<span id="line-d47615e426-128"><span class="lno">128</span></span>
<span id="line-d47615e426-129"><span class="lno">129</span></span>
<span id="line-d47615e426-130">130</span>
<span id="line-d47615e426-131"><span class="lno">131</span></span>
<span id="line-d47615e426-132"><span class="lno">132</span></span>
<span id="line-d47615e426-133"><span class="lno">133</span></span>
<span id="line-d47615e426-134"><span class="lno">134</span></span>
<span id="line-d47615e426-135">135</span>
<span id="line-d47615e426-136"><span class="lno">136</span></span>
<span id="line-d47615e426-137"><span class="lno">137</span></span>
<span id="line-d47615e426-138"><span class="lno">138</span></span>
<span id="line-d47615e426-139"><span class="lno">139</span></span>
<span id="line-d47615e426-140">140</span>
<span id="line-d47615e426-141"><span class="lno">141</span></span>
<span id="line-d47615e426-142"><span class="lno">142</span></span>
<span id="line-d47615e426-143"><span class="lno">143</span></span>
<span id="line-d47615e426-144"><span class="lno">144</span></span>
<span id="line-d47615e426-145">145</span>
<span id="line-d47615e426-146"><span class="lno">146</span></span>
<span id="line-d47615e426-147"><span class="lno">147</span></span>
<span id="line-d47615e426-148"><span class="lno">148</span></span>
<span id="line-d47615e426-149"><span class="lno">149</span></span>
<span id="line-d47615e426-150">150</span>
<span id="line-d47615e426-151"><span class="lno">151</span></span>
<span id="line-d47615e426-152"><span class="lno">152</span></span>
<span id="line-d47615e426-153"><span class="lno">153</span></span>
<span id="line-d47615e426-154"><span class="lno">154</span></span>
<span id="line-d47615e426-155">155</span>
<span id="line-d47615e426-156"><span class="lno">156</span></span>
<span id="line-d47615e426-157"><span class="lno">157</span></span>
<span id="line-d47615e426-158"><span class="lno">158</span></span>
<span id="line-d47615e426-159"><span class="lno">159</span></span>
<span id="line-d47615e426-160">160</span>
<span id="line-d47615e426-161"><span class="lno">161</span></span>
<span id="line-d47615e426-162"><span class="lno">162</span></span>
<span id="line-d47615e426-163"><span class="lno">163</span></span>
<span id="line-d47615e426-164"><span class="lno">164</span></span>
<span id="line-d47615e426-165">165</span>
<span id="line-d47615e426-166"><span class="lno">166</span></span>
<span id="line-d47615e426-167"><span class="lno">167</span></span>
<span id="line-d47615e426-168"><span class="lno">168</span></span>
<span id="line-d47615e426-169"><span class="lno">169</span></span>
<span id="line-d47615e426-170">170</span>
<span id="line-d47615e426-171"><span class="lno">171</span></span>
<span id="line-d47615e426-172"><span class="lno">172</span></span>
<span id="line-d47615e426-173"><span class="lno">173</span></span>
<span id="line-d47615e426-174"><span class="lno">174</span></span>
<span id="line-d47615e426-175">175</span>
<span id="line-d47615e426-176"><span class="lno">176</span></span>
<span id="line-d47615e426-177"><span class="lno">177</span></span>
<span id="line-d47615e426-178"><span class="lno">178</span></span>
<span id="line-d47615e426-179"><span class="lno">179</span></span>
<span id="line-d47615e426-180">180</span>
<span id="line-d47615e426-181"><span class="lno">181</span></span>
<span id="line-d47615e426-182"><span class="lno">182</span></span>
<span id="line-d47615e426-183"><span class="lno">183</span></span>
<span id="line-d47615e426-184"><span class="lno">184</span></span>
<span id="line-d47615e426-185">185</span>
<span id="line-d47615e426-186"><span class="lno">186</span></span>
<span id="line-d47615e426-187"><span class="lno">187</span></span>
<span id="line-d47615e426-188"><span class="lno">188</span></span>
<span id="line-d47615e426-189"><span class="lno">189</span></span>
<span id="line-d47615e426-190">190</span>
<span id="line-d47615e426-191"><span class="lno">191</span></span>
<span id="line-d47615e426-192"><span class="lno">192</span></span>
<span id="line-d47615e426-193"><span class="lno">193</span></span>
<span id="line-d47615e426-194"><span class="lno">194</span></span>
<span id="line-d47615e426-195">195</span>
<span id="line-d47615e426-196"><span class="lno">196</span></span>
<span id="line-d47615e426-197"><span class="lno">197</span></span>
<span id="line-d47615e426-198"><span class="lno">198</span></span>
<span id="line-d47615e426-199"><span class="lno">199</span></span>
<span id="line-d47615e426-200">200</span>
<span id="line-d47615e426-201"><span class="lno">201</span></span>
<span id="line-d47615e426-202"><span class="lno">202</span></span>
<span id="line-d47615e426-203"><span class="lno">203</span></span>
<span id="line-d47615e426-204"><span class="lno">204</span></span>
<span id="line-d47615e426-205">205</span>
<span id="line-d47615e426-206"><span class="lno">206</span></span>
<span id="line-d47615e426-207"><span class="lno">207</span></span>
<span id="line-d47615e426-208"><span class="lno">208</span></span>
<span id="line-d47615e426-209"><span class="lno">209</span></span>
<span id="line-d47615e426-210">210</span>
<span id="line-d47615e426-211"><span class="lno">211</span></span>
<span id="line-d47615e426-212"><span class="lno">212</span></span>
<span id="line-d47615e426-213"><span class="lno">213</span></span>
<span id="line-d47615e426-214"><span class="lno">214</span></span>
<span id="line-d47615e426-215">215</span>
<span id="line-d47615e426-216"><span class="lno">216</span></span>
<span id="line-d47615e426-217"><span class="lno">217</span></span>
<span id="line-d47615e426-218"><span class="lno">218</span></span>
<span id="line-d47615e426-219"><span class="lno">219</span></span>
<span id="line-d47615e426-220">220</span>
<span id="line-d47615e426-221"><span class="lno">221</span></span>
<span id="line-d47615e426-222"><span class="lno">222</span></span>
<span id="line-d47615e426-223"><span class="lno">223</span></span>
<span id="line-d47615e426-224"><span class="lno">224</span></span>
<span id="line-d47615e426-225">225</span>
<span id="line-d47615e426-226"><span class="lno">226</span></span>
<span id="line-d47615e426-227"><span class="lno">227</span></span>
<span id="line-d47615e426-228"><span class="lno">228</span></span>
<span id="line-d47615e426-229"><span class="lno">229</span></span>
<span id="line-d47615e426-230">230</span>
<span id="line-d47615e426-231"><span class="lno">231</span></span>
<span id="line-d47615e426-232"><span class="lno">232</span></span>
<span id="line-d47615e426-233"><span class="lno">233</span></span>
<span id="line-d47615e426-234"><span class="lno">234</span></span>
<span id="line-d47615e426-235">235</span>
<span id="line-d47615e426-236"><span class="lno">236</span></span>
<span id="line-d47615e426-237"><span class="lno">237</span></span>
<span id="line-d47615e426-238"><span class="lno">238</span></span>
<span id="line-d47615e426-239"><span class="lno">239</span></span>
<span id="line-d47615e426-240">240</span>
<span id="line-d47615e426-241"><span class="lno">241</span></span>
<span id="line-d47615e426-242"><span class="lno">242</span></span>
<span id="line-d47615e426-243"><span class="lno">243</span></span>
<span id="line-d47615e426-244"><span class="lno">244</span></span>
<span id="line-d47615e426-245">245</span>
<span id="line-d47615e426-246"><span class="lno">246</span></span>
<span id="line-d47615e426-247"><span class="lno">247</span></span>
<span id="line-d47615e426-248"><span class="lno">248</span></span>
<span id="line-d47615e426-249"><span class="lno">249</span></span>
<span id="line-d47615e426-250">250</span>
<span id="line-d47615e426-251"><span class="lno">251</span></span>
<span id="line-d47615e426-252"><span class="lno">252</span></span>
<span id="line-d47615e426-253"><span class="lno">253</span></span>
<span id="line-d47615e426-254"><span class="lno">254</span></span>
<span id="line-d47615e426-255">255</span>
<span id="line-d47615e426-256"><span class="lno">256</span></span>
<span id="line-d47615e426-257"><span class="lno">257</span></span>
<span id="line-d47615e426-258"><span class="lno">258</span></span>
<span id="line-d47615e426-259"><span class="lno">259</span></span>
<span id="line-d47615e426-260">260</span>
<span id="line-d47615e426-261"><span class="lno">261</span></span>
<span id="line-d47615e426-262"><span class="lno">262</span></span>
<span id="line-d47615e426-263"><span class="lno">263</span></span>
<span id="line-d47615e426-264"><span class="lno">264</span></span>
<span id="line-d47615e426-265">265</span>
<span id="line-d47615e426-266"><span class="lno">266</span></span>
<span id="line-d47615e426-267"><span class="lno">267</span></span>
<span id="line-d47615e426-268"><span class="lno">268</span></span>
<span id="line-d47615e426-269"><span class="lno">269</span></span>
<span id="line-d47615e426-270">270</span>
<span id="line-d47615e426-271"><span class="lno">271</span></span>
<span id="line-d47615e426-272"><span class="lno">272</span></span>
<span id="line-d47615e426-273"><span class="lno">273</span></span>
<span id="line-d47615e426-274"><span class="lno">274</span></span>
<span id="line-d47615e426-275">275</span>
<span id="line-d47615e426-276"><span class="lno">276</span></span>
<span id="line-d47615e426-277"><span class="lno">277</span></span>
<span id="line-d47615e426-278"><span class="lno">278</span></span>
<span id="line-d47615e426-279"><span class="lno">279</span></span>
<span id="line-d47615e426-280">280</span>
<span id="line-d47615e426-281"><span class="lno">281</span></span>
<span id="line-d47615e426-282"><span class="lno">282</span></span>
<span id="line-d47615e426-283"><span class="lno">283</span></span>
<span id="line-d47615e426-284"><span class="lno">284</span></span>
<span id="line-d47615e426-285">285</span>
<span id="line-d47615e426-286"><span class="lno">286</span></span>
<span id="line-d47615e426-287"><span class="lno">287</span></span>
<span id="line-d47615e426-288"><span class="lno">288</span></span>
<span id="line-d47615e426-289"><span class="lno">289</span></span>
<span id="line-d47615e426-290">290</span>
<span id="line-d47615e426-291"><span class="lno">291</span></span>
<span id="line-d47615e426-292"><span class="lno">292</span></span>
<span id="line-d47615e426-293"><span class="lno">293</span></span>
<span id="line-d47615e426-294"><span class="lno">294</span></span>
<span id="line-d47615e426-295">295</span>
<span id="line-d47615e426-296"><span class="lno">296</span></span>
<span id="line-d47615e426-297"><span class="lno">297</span></span>
<span id="line-d47615e426-298"><span class="lno">298</span></span>
<span id="line-d47615e426-299"><span class="lno">299</span></span>
<span id="line-d47615e426-300">300</span>
<span id="line-d47615e426-301"><span class="lno">301</span></span>
<span id="line-d47615e426-302"><span class="lno">302</span></span>
<span id="line-d47615e426-303"><span class="lno">303</span></span>
<span id="line-d47615e426-304"><span class="lno">304</span></span>
<span id="line-d47615e426-305">305</span>
<span id="line-d47615e426-306"><span class="lno">306</span></span>
<span id="line-d47615e426-307"><span class="lno">307</span></span>
<span id="line-d47615e426-308"><span class="lno">308</span></span>
<span id="line-d47615e426-309"><span class="lno">309</span></span>
<span id="line-d47615e426-310">310</span>
<span id="line-d47615e426-311"><span class="lno">311</span></span>
<span id="line-d47615e426-312"><span class="lno">312</span></span>
<span id="line-d47615e426-313"><span class="lno">313</span></span>
<span id="line-d47615e426-314"><span class="lno">314</span></span>
<span id="line-d47615e426-315">315</span>
<span id="line-d47615e426-316"><span class="lno">316</span></span>
<span id="line-d47615e426-317"><span class="lno">317</span></span>
<span id="line-d47615e426-318"><span class="lno">318</span></span>
<span id="line-d47615e426-319"><span class="lno">319</span></span>
<span id="line-d47615e426-320">320</span>
<span id="line-d47615e426-321"><span class="lno">321</span></span>
<span id="line-d47615e426-322"><span class="lno">322</span></span>
<span id="line-d47615e426-323"><span class="lno">323</span></span>
<span id="line-d47615e426-324"><span class="lno">324</span></span>
<span id="line-d47615e426-325">325</span>
<span id="line-d47615e426-326"><span class="lno">326</span></span>
<span id="line-d47615e426-327"><span class="lno">327</span></span>
<span id="line-d47615e426-328"><span class="lno">328</span></span>
<span id="line-d47615e426-329"><span class="lno">329</span></span>
<span id="line-d47615e426-330">330</span>
<span id="line-d47615e426-331"><span class="lno">331</span></span>
<span id="line-d47615e426-332"><span class="lno">332</span></span>
<span id="line-d47615e426-333"><span class="lno">333</span></span>
<span id="line-d47615e426-334"><span class="lno">334</span></span>
<span id="line-d47615e426-335">335</span>
<span id="line-d47615e426-336"><span class="lno">336</span></span>
<span id="line-d47615e426-337"><span class="lno">337</span></span>
<span id="line-d47615e426-338"><span class="lno">338</span></span>
<span id="line-d47615e426-339"><span class="lno">339</span></span>
<span id="line-d47615e426-340">340</span>
<span id="line-d47615e426-341"><span class="lno">341</span></span>
<span id="line-d47615e426-342"><span class="lno">342</span></span>
<span id="line-d47615e426-343"><span class="lno">343</span></span>
<span id="line-d47615e426-344"><span class="lno">344</span></span>
<span id="line-d47615e426-345">345</span>
<span id="line-d47615e426-346"><span class="lno">346</span></span>
<span id="line-d47615e426-347"><span class="lno">347</span></span>
<span id="line-d47615e426-348"><span class="lno">348</span></span>
<span id="line-d47615e426-349"><span class="lno">349</span></span>
<span id="line-d47615e426-350">350</span>
<span id="line-d47615e426-351"><span class="lno">351</span></span>
<span id="line-d47615e426-352"><span class="lno">352</span></span>
<span id="line-d47615e426-353"><span class="lno">353</span></span>
<span id="line-d47615e426-354"><span class="lno">354</span></span>
<span id="line-d47615e426-355">355</span>
<span id="line-d47615e426-356"><span class="lno">356</span></span>
<span id="line-d47615e426-357"><span class="lno">357</span></span>
<span id="line-d47615e426-358"><span class="lno">358</span></span>
<span id="line-d47615e426-359"><span class="lno">359</span></span>
<span id="line-d47615e426-360">360</span>
<span id="line-d47615e426-361"><span class="lno">361</span></span>
<span id="line-d47615e426-362"><span class="lno">362</span></span>
<span id="line-d47615e426-363"><span class="lno">363</span></span>
<span id="line-d47615e426-364"><span class="lno">364</span></span>
<span id="line-d47615e426-365">365</span>
<span id="line-d47615e426-366"><span class="lno">366</span></span>
<span id="line-d47615e426-367"><span class="lno">367</span></span>
<span id="line-d47615e426-368"><span class="lno">368</span></span>
<span id="line-d47615e426-369"><span class="lno">369</span></span>
<span id="line-d47615e426-370">370</span>
<span id="line-d47615e426-371"><span class="lno">371</span></span>
<span id="line-d47615e426-372"><span class="lno">372</span></span>
<span id="line-d47615e426-373"><span class="lno">373</span></span>
<span id="line-d47615e426-374"><span class="lno">374</span></span>
<span id="line-d47615e426-375">375</span>
<span id="line-d47615e426-376"><span class="lno">376</span></span>
<span id="line-d47615e426-377"><span class="lno">377</span></span>
<span id="line-d47615e426-378"><span class="lno">378</span></span>
<span id="line-d47615e426-379"><span class="lno">379</span></span>
<span id="line-d47615e426-380">380</span>
<span id="line-d47615e426-381"><span class="lno">381</span></span>
<span id="line-d47615e426-382"><span class="lno">382</span></span>
<span id="line-d47615e426-383"><span class="lno">383</span></span>
<span id="line-d47615e426-384"><span class="lno">384</span></span>
<span id="line-d47615e426-385">385</span>
<span id="line-d47615e426-386"><span class="lno">386</span></span>
<span id="line-d47615e426-387"><span class="lno">387</span></span>
<span id="line-d47615e426-388"><span class="lno">388</span></span>
<span id="line-d47615e426-389"><span class="lno">389</span></span>
<span id="line-d47615e426-390">390</span>
<span id="line-d47615e426-391"><span class="lno">391</span></span>
<span id="line-d47615e426-392"><span class="lno">392</span></span>
<span id="line-d47615e426-393"><span class="lno">393</span></span>
<span id="line-d47615e426-394"><span class="lno">394</span></span>
<span id="line-d47615e426-395">395</span>
<span id="line-d47615e426-396"><span class="lno">396</span></span>
<span id="line-d47615e426-397"><span class="lno">397</span></span>
<span id="line-d47615e426-398"><span class="lno">398</span></span>
<span id="line-d47615e426-399"><span class="lno">399</span></span>
<span id="line-d47615e426-400">400</span>
<span id="line-d47615e426-401"><span class="lno">401</span></span>
<span id="line-d47615e426-402"><span class="lno">402</span></span>
<span id="line-d47615e426-403"><span class="lno">403</span></span>
<span id="line-d47615e426-404"><span class="lno">404</span></span>
<span id="line-d47615e426-405">405</span>
<span id="line-d47615e426-406"><span class="lno">406</span></span>
<span id="line-d47615e426-407"><span class="lno">407</span></span>
<span id="line-d47615e426-408"><span class="lno">408</span></span>
<span id="line-d47615e426-409"><span class="lno">409</span></span>
<span id="line-d47615e426-410">410</span>
<span id="line-d47615e426-411"><span class="lno">411</span></span>
<span id="line-d47615e426-412"><span class="lno">412</span></span>
<span id="line-d47615e426-413"><span class="lno">413</span></span>
<span id="line-d47615e426-414"><span class="lno">414</span></span>
<span id="line-d47615e426-415">415</span>
<span id="line-d47615e426-416"><span class="lno">416</span></span>
<span id="line-d47615e426-417"><span class="lno">417</span></span>
<span id="line-d47615e426-418"><span class="lno">418</span></span>
<span id="line-d47615e426-419"><span class="lno">419</span></span>
<span id="line-d47615e426-420">420</span>
<span id="line-d47615e426-421"><span class="lno">421</span></span>
<span id="line-d47615e426-422"><span class="lno">422</span></span>
<span id="line-d47615e426-423"><span class="lno">423</span></span>
<span id="line-d47615e426-424"><span class="lno">424</span></span>
<span id="line-d47615e426-425">425</span>
<span id="line-d47615e426-426"><span class="lno">426</span></span>
<span id="line-d47615e426-427"><span class="lno">427</span></span>
<span id="line-d47615e426-428"><span class="lno">428</span></span>
<span id="line-d47615e426-429"><span class="lno">429</span></span>
<span id="line-d47615e426-430">430</span>
<span id="line-d47615e426-431"><span class="lno">431</span></span>
<span id="line-d47615e426-432"><span class="lno">432</span></span>
<span id="line-d47615e426-433"><span class="lno">433</span></span>
<span id="line-d47615e426-434"><span class="lno">434</span></span>
<span id="line-d47615e426-435">435</span>
<span id="line-d47615e426-436"><span class="lno">436</span></span>
<span id="line-d47615e426-437"><span class="lno">437</span></span>
<span id="line-d47615e426-438"><span class="lno">438</span></span>
<span id="line-d47615e426-439"><span class="lno">439</span></span>
<span id="line-d47615e426-440">440</span>
<span id="line-d47615e426-441"><span class="lno">441</span></span>
<span id="line-d47615e426-442"><span class="lno">442</span></span>
<span id="line-d47615e426-443"><span class="lno">443</span></span>
<span id="line-d47615e426-444"><span class="lno">444</span></span>
<span id="line-d47615e426-445">445</span>
<span id="line-d47615e426-446"><span class="lno">446</span></span>
<span id="line-d47615e426-447"><span class="lno">447</span></span>
<span id="line-d47615e426-448"><span class="lno">448</span></span>
<span id="line-d47615e426-449"><span class="lno">449</span></span>
<span id="line-d47615e426-450">450</span>
<span id="line-d47615e426-451"><span class="lno">451</span></span>
<span id="line-d47615e426-452"><span class="lno">452</span></span>
<span id="line-d47615e426-453"><span class="lno">453</span></span>
<span id="line-d47615e426-454"><span class="lno">454</span></span>
<span id="line-d47615e426-455">455</span>
<span id="line-d47615e426-456"><span class="lno">456</span></span>
<span id="line-d47615e426-457"><span class="lno">457</span></span>
<span id="line-d47615e426-458"><span class="lno">458</span></span>
<span id="line-d47615e426-459"><span class="lno">459</span></span>
<span id="line-d47615e426-460">460</span>
<span id="line-d47615e426-461"><span class="lno">461</span></span>
<span id="line-d47615e426-462"><span class="lno">462</span></span>
<span id="line-d47615e426-463"><span class="lno">463</span></span>
<span id="line-d47615e426-464"><span class="lno">464</span></span>
<span id="line-d47615e426-465">465</span>
<span id="line-d47615e426-466"><span class="lno">466</span></span>
<span id="line-d47615e426-467"><span class="lno">467</span></span>
<span id="line-d47615e426-468"><span class="lno">468</span></span>
<span id="line-d47615e426-469"><span class="lno">469</span></span>
<span id="line-d47615e426-470">470</span>
<span id="line-d47615e426-471"><span class="lno">471</span></span>
<span id="line-d47615e426-472"><span class="lno">472</span></span>
<span id="line-d47615e426-473"><span class="lno">473</span></span>
<span id="line-d47615e426-474"><span class="lno">474</span></span>
<span id="line-d47615e426-475">475</span>
<span id="line-d47615e426-476"><span class="lno">476</span></span>
<span id="line-d47615e426-477"><span class="lno">477</span></span>
<span id="line-d47615e426-478"><span class="lno">478</span></span>
<span id="line-d47615e426-479"><span class="lno">479</span></span>
<span id="line-d47615e426-480">480</span>
<span id="line-d47615e426-481"><span class="lno">481</span></span>
<span id="line-d47615e426-482"><span class="lno">482</span></span>
<span id="line-d47615e426-483"><span class="lno">483</span></span>
<span id="line-d47615e426-484"><span class="lno">484</span></span>
<span id="line-d47615e426-485">485</span>
<span id="line-d47615e426-486"><span class="lno">486</span></span>
<span id="line-d47615e426-487"><span class="lno">487</span></span>
<span id="line-d47615e426-488"><span class="lno">488</span></span>
<span id="line-d47615e426-489"><span class="lno">489</span></span>
<span id="line-d47615e426-490">490</span>
<span id="line-d47615e426-491"><span class="lno">491</span></span>
<span id="line-d47615e426-492"><span class="lno">492</span></span>
<span id="line-d47615e426-493"><span class="lno">493</span></span>
<span id="line-d47615e426-494"><span class="lno">494</span></span>
<span id="line-d47615e426-495">495</span>
<span id="line-d47615e426-496"><span class="lno">496</span></span>
<span id="line-d47615e426-497"><span class="lno">497</span></span>
<span id="line-d47615e426-498"><span class="lno">498</span></span>
<span id="line-d47615e426-499"><span class="lno">499</span></span>
<span id="line-d47615e426-500">500</span>
<span id="line-d47615e426-501"><span class="lno">501</span></span>
<span id="line-d47615e426-502"><span class="lno">502</span></span>
<span id="line-d47615e426-503"><span class="lno">503</span></span>
<span id="line-d47615e426-504"><span class="lno">504</span></span>
<span id="line-d47615e426-505">505</span>
<span id="line-d47615e426-506"><span class="lno">506</span></span>
<span id="line-d47615e426-507"><span class="lno">507</span></span>
<span id="line-d47615e426-508"><span class="lno">508</span></span>
<span id="line-d47615e426-509"><span class="lno">509</span></span>
<span id="line-d47615e426-510">510</span>
<span id="line-d47615e426-511"><span class="lno">511</span></span>
<span id="line-d47615e426-512"><span class="lno">512</span></span>
<span id="line-d47615e426-513"><span class="lno">513</span></span>
<span id="line-d47615e426-514"><span class="lno">514</span></span>
<span id="line-d47615e426-515">515</span>
<span id="line-d47615e426-516"><span class="lno">516</span></span>
<span id="line-d47615e426-517"><span class="lno">517</span></span>
<span id="line-d47615e426-518"><span class="lno">518</span></span>
<span id="line-d47615e426-519"><span class="lno">519</span></span>
<span id="line-d47615e426-520">520</span>
<span id="line-d47615e426-521"><span class="lno">521</span></span>
<span id="line-d47615e426-522"><span class="lno">522</span></span>
<span id="line-d47615e426-523"><span class="lno">523</span></span>
<span id="line-d47615e426-524"><span class="lno">524</span></span>
<span id="line-d47615e426-525">525</span>
<span id="line-d47615e426-526"><span class="lno">526</span></span>
<span id="line-d47615e426-527"><span class="lno">527</span></span>
<span id="line-d47615e426-528"><span class="lno">528</span></span>
<span id="line-d47615e426-529"><span class="lno">529</span></span>
<span id="line-d47615e426-530">530</span>
<span id="line-d47615e426-531"><span class="lno">531</span></span>
<span id="line-d47615e426-532"><span class="lno">532</span></span>
<span id="line-d47615e426-533"><span class="lno">533</span></span>
<span id="line-d47615e426-534"><span class="lno">534</span></span>
<span id="line-d47615e426-535">535</span>
<span id="line-d47615e426-536"><span class="lno">536</span></span>
<span id="line-d47615e426-537"><span class="lno">537</span></span>
<span id="line-d47615e426-538"><span class="lno">538</span></span>
<span id="line-d47615e426-539"><span class="lno">539</span></span>
<span id="line-d47615e426-540">540</span>
<span id="line-d47615e426-541"><span class="lno">541</span></span>
<span id="line-d47615e426-542"><span class="lno">542</span></span>
<span id="line-d47615e426-543"><span class="lno">543</span></span>
<span id="line-d47615e426-544"><span class="lno">544</span></span>
<span id="line-d47615e426-545">545</span>
<span id="line-d47615e426-546"><span class="lno">546</span></span>
<span id="line-d47615e426-547"><span class="lno">547</span></span>
<span id="line-d47615e426-548"><span class="lno">548</span></span>
<span id="line-d47615e426-549"><span class="lno">549</span></span>
<span id="line-d47615e426-550">550</span>
<span id="line-d47615e426-551"><span class="lno">551</span></span>
<span id="line-d47615e426-552"><span class="lno">552</span></span>
<span id="line-d47615e426-553"><span class="lno">553</span></span>
<span id="line-d47615e426-554"><span class="lno">554</span></span>
<span id="line-d47615e426-555">555</span>
<span id="line-d47615e426-556"><span class="lno">556</span></span>
<span id="line-d47615e426-557"><span class="lno">557</span></span>
<span id="line-d47615e426-558"><span class="lno">558</span></span>
<span id="line-d47615e426-559"><span class="lno">559</span></span>
<span id="line-d47615e426-560">560</span>
<span id="line-d47615e426-561"><span class="lno">561</span></span>
<span id="line-d47615e426-562"><span class="lno">562</span></span>
<span id="line-d47615e426-563"><span class="lno">563</span></span>
<span id="line-d47615e426-564"><span class="lno">564</span></span>
<span id="line-d47615e426-565">565</span>
<span id="line-d47615e426-566"><span class="lno">566</span></span>
<span id="line-d47615e426-567"><span class="lno">567</span></span>
<span id="line-d47615e426-568"><span class="lno">568</span></span>
<span id="line-d47615e426-569"><span class="lno">569</span></span>
<span id="line-d47615e426-570">570</span>
<span id="line-d47615e426-571"><span class="lno">571</span></span>
<span id="line-d47615e426-572"><span class="lno">572</span></span>
<span id="line-d47615e426-573"><span class="lno">573</span></span>
<span id="line-d47615e426-574"><span class="lno">574</span></span>
<span id="line-d47615e426-575">575</span>
<span id="line-d47615e426-576"><span class="lno">576</span></span>
<span id="line-d47615e426-577"><span class="lno">577</span></span>
<span id="line-d47615e426-578"><span class="lno">578</span></span>
<span id="line-d47615e426-579"><span class="lno">579</span></span>
<span id="line-d47615e426-580">580</span>
<span id="line-d47615e426-581"><span class="lno">581</span></span>
<span id="line-d47615e426-582"><span class="lno">582</span></span>
<span id="line-d47615e426-583"><span class="lno">583</span></span>
<span id="line-d47615e426-584"><span class="lno">584</span></span>
<span id="line-d47615e426-585">585</span>
<span id="line-d47615e426-586"><span class="lno">586</span></span>
<span id="line-d47615e426-587"><span class="lno">587</span></span>
<span id="line-d47615e426-588"><span class="lno">588</span></span>
<span id="line-d47615e426-589"><span class="lno">589</span></span>
<span id="line-d47615e426-590">590</span>
<span id="line-d47615e426-591"><span class="lno">591</span></span>
<span id="line-d47615e426-592"><span class="lno">592</span></span>
<span id="line-d47615e426-593"><span class="lno">593</span></span>
<span id="line-d47615e426-594"><span class="lno">594</span></span>
<span id="line-d47615e426-595">595</span>
<span id="line-d47615e426-596"><span class="lno">596</span></span>
<span id="line-d47615e426-597"><span class="lno">597</span></span>
<span id="line-d47615e426-598"><span class="lno">598</span></span>
<span id="line-d47615e426-599"><span class="lno">599</span></span>
<span id="line-d47615e426-600">600</span>
<span id="line-d47615e426-601"><span class="lno">601</span></span>
<span id="line-d47615e426-602"><span class="lno">602</span></span>
<span id="line-d47615e426-603"><span class="lno">603</span></span>
<span id="line-d47615e426-604"><span class="lno">604</span></span>
<span id="line-d47615e426-605">605</span>
<span id="line-d47615e426-606"><span class="lno">606</span></span>
<span id="line-d47615e426-607"><span class="lno">607</span></span>
<span id="line-d47615e426-608"><span class="lno">608</span></span>
<span id="line-d47615e426-609"><span class="lno">609</span></span>
<span id="line-d47615e426-610">610</span>
<span id="line-d47615e426-611"><span class="lno">611</span></span>
<span id="line-d47615e426-612"><span class="lno">612</span></span>
<span id="line-d47615e426-613"><span class="lno">613</span></span>
<span id="line-d47615e426-614"><span class="lno">614</span></span>
<span id="line-d47615e426-615">615</span>
<span id="line-d47615e426-616"><span class="lno">616</span></span>
<span id="line-d47615e426-617"><span class="lno">617</span></span>
<span id="line-d47615e426-618"><span class="lno">618</span></span>
<span id="line-d47615e426-619"><span class="lno">619</span></span>
<span id="line-d47615e426-620">620</span>
<span id="line-d47615e426-621"><span class="lno">621</span></span>
<span id="line-d47615e426-622"><span class="lno">622</span></span>
<span id="line-d47615e426-623"><span class="lno">623</span></span>
<span id="line-d47615e426-624"><span class="lno">624</span></span>
<span id="line-d47615e426-625">625</span>
<span id="line-d47615e426-626"><span class="lno">626</span></span>
<span id="line-d47615e426-627"><span class="lno">627</span></span>
<span id="line-d47615e426-628"><span class="lno">628</span></span>
<span id="line-d47615e426-629"><span class="lno">629</span></span>
<span id="line-d47615e426-630">630</span>
<span id="line-d47615e426-631"><span class="lno">631</span></span>
<span id="line-d47615e426-632"><span class="lno">632</span></span>
<span id="line-d47615e426-633"><span class="lno">633</span></span>
<span id="line-d47615e426-634"><span class="lno">634</span></span>
<span id="line-d47615e426-635">635</span>
<span id="line-d47615e426-636"><span class="lno">636</span></span>
<span id="line-d47615e426-637"><span class="lno">637</span></span>
<span id="line-d47615e426-638"><span class="lno">638</span></span>
<span id="line-d47615e426-639"><span class="lno">639</span></span>
<span id="line-d47615e426-640">640</span>
<span id="line-d47615e426-641"><span class="lno">641</span></span>
<span id="line-d47615e426-642"><span class="lno">642</span></span>
<span id="line-d47615e426-643"><span class="lno">643</span></span>
<span id="line-d47615e426-644"><span class="lno">644</span></span>
<span id="line-d47615e426-645">645</span>
<span id="line-d47615e426-646"><span class="lno">646</span></span>
<span id="line-d47615e426-647"><span class="lno">647</span></span>
<span id="line-d47615e426-648"><span class="lno">648</span></span>
<span id="line-d47615e426-649"><span class="lno">649</span></span>
<span id="line-d47615e426-650">650</span>
<span id="line-d47615e426-651"><span class="lno">651</span></span>
<span id="line-d47615e426-652"><span class="lno">652</span></span>
<span id="line-d47615e426-653"><span class="lno">653</span></span>
<span id="line-d47615e426-654"><span class="lno">654</span></span>
<span id="line-d47615e426-655">655</span>
<span id="line-d47615e426-656"><span class="lno">656</span></span>
<span id="line-d47615e426-657"><span class="lno">657</span></span>
<span id="line-d47615e426-658"><span class="lno">658</span></span>
<span id="line-d47615e426-659"><span class="lno">659</span></span>
<span id="line-d47615e426-660">660</span>
<span id="line-d47615e426-661"><span class="lno">661</span></span>
<span id="line-d47615e426-662"><span class="lno">662</span></span>
<span id="line-d47615e426-663"><span class="lno">663</span></span>
<span id="line-d47615e426-664"><span class="lno">664</span></span>
<span id="line-d47615e426-665">665</span>
<span id="line-d47615e426-666"><span class="lno">666</span></span>
<span id="line-d47615e426-667"><span class="lno">667</span></span>
<span id="line-d47615e426-668"><span class="lno">668</span></span>
<span id="line-d47615e426-669"><span class="lno">669</span></span>
<span id="line-d47615e426-670">670</span>
<span id="line-d47615e426-671"><span class="lno">671</span></span>
<span id="line-d47615e426-672"><span class="lno">672</span></span>
<span id="line-d47615e426-673"><span class="lno">673</span></span>
<span id="line-d47615e426-674"><span class="lno">674</span></span>
<span id="line-d47615e426-675">675</span>
<span id="line-d47615e426-676"><span class="lno">676</span></span>
<span id="line-d47615e426-677"><span class="lno">677</span></span>
<span id="line-d47615e426-678"><span class="lno">678</span></span>
<span id="line-d47615e426-679"><span class="lno">679</span></span>
<span id="line-d47615e426-680">680</span>
<span id="line-d47615e426-681"><span class="lno">681</span></span>
<span id="line-d47615e426-682"><span class="lno">682</span></span>
<span id="line-d47615e426-683"><span class="lno">683</span></span>
<span id="line-d47615e426-684"><span class="lno">684</span></span>
<span id="line-d47615e426-685">685</span>
<span id="line-d47615e426-686"><span class="lno">686</span></span>
<span id="line-d47615e426-687"><span class="lno">687</span></span>
<span id="line-d47615e426-688"><span class="lno">688</span></span>
<span id="line-d47615e426-689"><span class="lno">689</span></span>
<span id="line-d47615e426-690">690</span>
<span id="line-d47615e426-691"><span class="lno">691</span></span>
<span id="line-d47615e426-692"><span class="lno">692</span></span>
<span id="line-d47615e426-693"><span class="lno">693</span></span>
<span id="line-d47615e426-694"><span class="lno">694</span></span>
<span id="line-d47615e426-695">695</span>
<span id="line-d47615e426-696"><span class="lno">696</span></span>
<span id="line-d47615e426-697"><span class="lno">697</span></span>
<span id="line-d47615e426-698"><span class="lno">698</span></span>
<span id="line-d47615e426-699"><span class="lno">699</span></span>
<span id="line-d47615e426-700">700</span>
<span id="line-d47615e426-701"><span class="lno">701</span></span>
<span id="line-d47615e426-702"><span class="lno">702</span></span>
<span id="line-d47615e426-703"><span class="lno">703</span></span>
<span id="line-d47615e426-704"><span class="lno">704</span></span>
<span id="line-d47615e426-705">705</span>
<span id="line-d47615e426-706"><span class="lno">706</span></span>
<span id="line-d47615e426-707"><span class="lno">707</span></span>
<span id="line-d47615e426-708"><span class="lno">708</span></span>
<span id="line-d47615e426-709"><span class="lno">709</span></span>
<span id="line-d47615e426-710">710</span>
<span id="line-d47615e426-711"><span class="lno">711</span></span>
<span id="line-d47615e426-712"><span class="lno">712</span></span>
<span id="line-d47615e426-713"><span class="lno">713</span></span>
<span id="line-d47615e426-714"><span class="lno">714</span></span>
<span id="line-d47615e426-715">715</span>
<span id="line-d47615e426-716"><span class="lno">716</span></span>
<span id="line-d47615e426-717"><span class="lno">717</span></span>
<span id="line-d47615e426-718"><span class="lno">718</span></span>
<span id="line-d47615e426-719"><span class="lno">719</span></span>
<span id="line-d47615e426-720">720</span>
<span id="line-d47615e426-721"><span class="lno">721</span></span>
<span id="line-d47615e426-722"><span class="lno">722</span></span>
<span id="line-d47615e426-723"><span class="lno">723</span></span>
<span id="line-d47615e426-724"><span class="lno">724</span></span>
<span id="line-d47615e426-725">725</span>
<span id="line-d47615e426-726"><span class="lno">726</span></span>
<span id="line-d47615e426-727"><span class="lno">727</span></span>
<span id="line-d47615e426-728"><span class="lno">728</span></span>
<span id="line-d47615e426-729"><span class="lno">729</span></span>
<span id="line-d47615e426-730">730</span>
<span id="line-d47615e426-731"><span class="lno">731</span></span>
<span id="line-d47615e426-732"><span class="lno">732</span></span>
<span id="line-d47615e426-733"><span class="lno">733</span></span>
<span id="line-d47615e426-734"><span class="lno">734</span></span>
<span id="line-d47615e426-735">735</span>
<span id="line-d47615e426-736"><span class="lno">736</span></span>
<span id="line-d47615e426-737"><span class="lno">737</span></span>
<span id="line-d47615e426-738"><span class="lno">738</span></span>
<span id="line-d47615e426-739"><span class="lno">739</span></span>
<span id="line-d47615e426-740">740</span>
<span id="line-d47615e426-741"><span class="lno">741</span></span>
<span id="line-d47615e426-742"><span class="lno">742</span></span>
<span id="line-d47615e426-743"><span class="lno">743</span></span>
<span id="line-d47615e426-744"><span class="lno">744</span></span>
<span id="line-d47615e426-745">745</span>
<span id="line-d47615e426-746"><span class="lno">746</span></span>
<span id="line-d47615e426-747"><span class="lno">747</span></span>
<span id="line-d47615e426-748"><span class="lno">748</span></span>
<span id="line-d47615e426-749"><span class="lno">749</span></span>
<span id="line-d47615e426-750">750</span>
</pre></td><td valign="top"><pre><code class="language-xml">&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
                xmlns:a="http://nwalsh.com/ns/xslt/analysis"
                xmlns:f="http://nwalsh.com/ns/xslt/functions"
                xmlns:fp="http://nwalsh.com/ns/xslt/functions/private"
                xmlns:h="http://www.w3.org/1999/xhtml"
                xmlns:m="http://nwalsh.com/ns/xslt/modes"
                xmlns:t="http://nwalsh.com/ns/xslt/templates"
                xmlns:xs="http://www.w3.org/2001/XMLSchema"
                xmlns="http://www.w3.org/1999/xhtml"
                default-mode="m:summarize"
                exclude-result-prefixes="a f fp h m t xs"
                version="3.0"&gt;

&lt;xsl:param name="css" select="'css/xsltexplorer.css'"/&gt;
&lt;xsl:param name="js" select="'js/xsltexplorer.js'"/&gt;
&lt;xsl:param name="prismcss" select="'css/prism.css'"/&gt;
&lt;xsl:param name="prismjs" select="'js/prism.js'"/&gt;

&lt;xsl:param name="title" select="()"/&gt;

&lt;xsl:variable name="Z" select="xs:dayTimeDuration('PT0H')"/&gt;

&lt;xsl:template match="a:summary"&gt;
  &lt;html&gt;
    &lt;head&gt;
      &lt;title&gt;
        &lt;xsl:sequence select="if (exists($title))
                              then $title
                              else $TITLE
                                   || ': '
                                   || tokenize(base-uri(/*), '/')[last()]"/&gt;
      &lt;/title&gt;
      &lt;meta name="viewport" content="width=device-width,initial-scale=1" /&gt;
      &lt;link rel="shortcut icon" href="https://xslt.xmlexplorer.com/img/icon64.png"
            type="image/png" /&gt;
      &lt;link rel="stylesheet" href="{$prismcss}"/&gt;
      &lt;link rel="stylesheet" href="{$css}"/&gt;
      &lt;link rel="schema.dc" href="http://purl.org/dc/elements/1.1/"/&gt;
      &lt;meta name="dc.modified"
            content="{format-dateTime(adjust-dateTime-to-timezone(current-dateTime(), $Z),
                                      '[Y0001]-[M01]-[D01]T[H01]:[m01]:[s01]Z')}"/&gt;
      &lt;meta name="generator" content="{$TITLE} {$VERSION} / {$VERHASH}"/&gt;
      &lt;script src="{$prismjs}"&gt;&lt;/script&gt;
    &lt;/head&gt;
    &lt;body&gt;
      &lt;main&gt;
        &lt;h1&gt;
          &lt;a href="https://xslt.xmlexplorer.com/"&gt;
            &lt;img class="logo" src="https://xslt.xmlexplorer.com/img/logo256.png"/&gt;
          &lt;/a&gt;
          &lt;xsl:sequence select="if (exists($title))
                                then $title
                                else $TITLE
                                     || ': '
                                     || tokenize(base-uri(/*), '/')[last()]"/&gt;
        &lt;/h1&gt;

        &lt;xsl:variable name="details" as="element(h:span)*"&gt;
          &lt;xsl:sequence select="@imports ! f:summary-count(./string(), 'import')"/&gt;
          &lt;xsl:sequence select="@includes ! f:summary-count(./string(), 'include')"/&gt;
          &lt;xsl:sequence select="@templates ! f:summary-count(./string(), 'template')"/&gt;
          &lt;xsl:sequence select="@functions ! f:summary-count(./string(), 'function')"/&gt;
          &lt;xsl:sequence select="@variables ! f:summary-count(./string(), 'variable')"/&gt;
          &lt;xsl:sequence select="@params ! f:summary-count(./string(), 'param')"/&gt;
          &lt;xsl:sequence select="@fixmes ! f:summary-count(./string(), 'FIXME: comment')"/&gt;
        &lt;/xsl:variable&gt;

        &lt;xsl:if test="$details"&gt;
          &lt;p&gt;
            &lt;xsl:for-each select="$details"&gt;
              &lt;xsl:if test="position() gt 1"&gt;, &lt;/xsl:if&gt;
              &lt;!-- strip off the spans so they aren't visible to CSS/JS --&gt;
              &lt;xsl:sequence select="node()"/&gt;
            &lt;/xsl:for-each&gt;
          &lt;/p&gt;
        &lt;/xsl:if&gt;

        &lt;xsl:if test="a:stylesheet/a:stylesheet"&gt;
          &lt;div class="toc"&gt;
            &lt;span class="closed"&gt;List of Imports&lt;/span&gt;
            &lt;xsl:apply-templates select="a:stylesheet" mode="m:toc"/&gt;
          &lt;/div&gt;
        &lt;/xsl:if&gt;

        &lt;xsl:variable name="list" select="//a:stylesheet/a:template[@name]"/&gt;
        &lt;xsl:if test="$list"&gt;
          &lt;div class="lot"&gt;
            &lt;span class="closed"&gt;List of Templates&lt;/span&gt;
            &lt;dl class="columns"&gt;
              &lt;xsl:for-each select="$list"&gt;
                &lt;xsl:sort select="@id"/&gt;
                &lt;dt&gt;
                  &lt;xsl:apply-templates select="." mode="m:reference"/&gt;
                &lt;/dt&gt;
              &lt;/xsl:for-each&gt;
            &lt;/dl&gt;
          &lt;/div&gt;
        &lt;/xsl:if&gt;         

        &lt;xsl:variable name="list" select="//a:stylesheet/a:function"/&gt;
        &lt;xsl:if test="$list"&gt;
          &lt;div class="lof"&gt;
            &lt;span class="closed"&gt;List of Functions&lt;/span&gt;
            &lt;dl class="columns"&gt;
              &lt;xsl:for-each select="$list"&gt;
                &lt;xsl:sort select="@id"/&gt;
                &lt;dt&gt;
                  &lt;xsl:apply-templates select="." mode="m:reference"/&gt;
                &lt;/dt&gt;
              &lt;/xsl:for-each&gt;
            &lt;/dl&gt;
          &lt;/div&gt;
        &lt;/xsl:if&gt;            

        &lt;xsl:apply-templates/&gt;
      &lt;/main&gt;
      &lt;footer&gt;
        &lt;xsl:variable name="now" select="adjust-dateTime-to-timezone(current-dateTime(), $Z)"/&gt;
        &lt;p&gt;
          &lt;xsl:text&gt;Generated by &lt;/xsl:text&gt;
          &lt;a href="https://xslt.xmlexplorer.com/"&gt;
            &lt;xsl:sequence select="$TITLE"/&gt;
          &lt;/a&gt;
          &lt;xsl:text&gt; version &lt;/xsl:text&gt;
          &lt;span title="git hash: {$VERHASH}"&gt;
            &lt;xsl:sequence select="$VERSION"/&gt;
          &lt;/span&gt;
          &lt;xsl:text&gt; at &lt;/xsl:text&gt;
          &lt;xsl:sequence select="format-dateTime($now, '[H01]:[m01]')"/&gt;
          &lt;xsl:text&gt; on &lt;/xsl:text&gt;
          &lt;xsl:sequence select="format-dateTime($now, '[D01] [MNn,*-3] [Y0001]')"/&gt;
          &lt;xsl:text&gt;.&lt;/xsl:text&gt;
        &lt;/p&gt;
        &lt;p&gt;
          &lt;xsl:text&gt;Source: &lt;/xsl:text&gt;
          &lt;xsl:sequence select="@xml:base/string()"/&gt;
        &lt;/p&gt;
      &lt;/footer&gt;
    &lt;/body&gt;
    &lt;script src="{$js}"/&gt;
  &lt;/html&gt;
&lt;/xsl:template&gt;

&lt;xsl:template match="a:stylesheet"&gt;
  &lt;xsl:variable name="stylesheet" select="."/&gt;

  &lt;xsl:variable name="hsize" select="min((count(ancestor::a:stylesheet)+1,4))"/&gt;

  &lt;div class="{local-name(.)}" id="{@id}"&gt;
    &lt;xsl:element name="h{$hsize}" namespace="http://www.w3.org/1999/xhtml"&gt;
      &lt;xsl:value-of select="tokenize(@xml:base, '/')[last()]"/&gt;
      &lt;xsl:message select="'Summarizing', @href/string(), '…'"/&gt;
    &lt;/xsl:element&gt;

    &lt;xsl:variable name="summary" as="element(h:span)*"&gt;
      &lt;xsl:sequence select="f:summary-count(@imports, 'import')"/&gt;
      &lt;xsl:sequence select="f:summary-count(@includes, 'include')"/&gt;
    &lt;/xsl:variable&gt;

    &lt;xsl:if test="exists($summary)"&gt;
      &lt;p&gt;
        &lt;xsl:for-each select="$summary"&gt;
          &lt;xsl:if test="position() gt 1"&gt;, &lt;/xsl:if&gt;
          &lt;xsl:sequence select="."/&gt;
        &lt;/xsl:for-each&gt;
      &lt;/p&gt;
    &lt;/xsl:if&gt;

    &lt;xsl:apply-templates select="a:stylesheet"/&gt;

    &lt;xsl:variable name="summary" as="element(h:span)*"&gt;
      &lt;xsl:if test="@templates ne '0'"&gt;
        &lt;span&gt;
          &lt;xsl:sequence select="f:summary-count(@templates, 'template')"/&gt;
          &lt;xsl:sequence select="f:summary-details(a:templates)"/&gt;
        &lt;/span&gt;
      &lt;/xsl:if&gt;          
      &lt;xsl:if test="@functions ne '0'"&gt;
        &lt;span&gt;
          &lt;xsl:sequence select="f:summary-count(@functions, 'function')"/&gt;
          &lt;xsl:sequence select="f:summary-details(a:functions)"/&gt;
        &lt;/span&gt;
      &lt;/xsl:if&gt;          
      &lt;xsl:if test="@variables ne '0'"&gt;
        &lt;span&gt;
          &lt;xsl:sequence select="f:summary-count(@variables, 'variable')"/&gt;
          &lt;xsl:sequence select="f:summary-details(a:variables)"/&gt;
        &lt;/span&gt;
      &lt;/xsl:if&gt;          
      &lt;xsl:if test="@params ne '0'"&gt;
        &lt;span&gt;
          &lt;xsl:sequence select="f:summary-count(@params, 'param')"/&gt;
          &lt;xsl:sequence select="f:summary-details(a:params)"/&gt;
        &lt;/span&gt;
      &lt;/xsl:if&gt;          
      &lt;xsl:if test="@fixmes ne '0'"&gt;
        &lt;span&gt;
          &lt;xsl:sequence select="f:summary-count(@fixmes, 'FIXME: comment')"/&gt;
          &lt;xsl:sequence select="f:summary-details(a:comments)"/&gt;
        &lt;/span&gt;
      &lt;/xsl:if&gt;          
    &lt;/xsl:variable&gt;

    &lt;xsl:if test="exists($summary)"&gt;
      &lt;p&gt;
        &lt;xsl:for-each select="$summary"&gt;
          &lt;xsl:if test="position() gt 1"&gt;, &lt;/xsl:if&gt;
          &lt;xsl:sequence select="."/&gt;
        &lt;/xsl:for-each&gt;
      &lt;/p&gt;
    &lt;/xsl:if&gt;

    &lt;div class="instructions"&gt;
      &lt;div class="title closed"&gt;Instructions&lt;/div&gt;
      &lt;div class="body"&gt;
        &lt;xsl:apply-templates select="a:* except (a:stylesheet|a:variables|a:functions
                                                 |a:templates|a:params
                                                 |a:comments|a:comment)"/&gt;
      &lt;/div&gt;
    &lt;/div&gt;

    &lt;xsl:if test=".//a:comment except .//a:stylesheet//a:comment"&gt;
      &lt;div class="instructions"&gt;
        &lt;div class="title closed"&gt;FIXME: comments&lt;/div&gt;
        &lt;div class="body"&gt;
          &lt;xsl:apply-templates select=".//a:comment except .//a:stylesheet//a:comment"/&gt;
        &lt;/div&gt;
      &lt;/div&gt;
    &lt;/xsl:if&gt;

    &lt;xsl:if test="string($source-listings) = ('1','true','yes')"&gt;
      &lt;div class="source-code"&gt;
        &lt;div class="title closed"&gt;Source code&lt;/div&gt;
        &lt;div class="body"&gt;
          &lt;div&gt;
            &lt;xsl:try&gt;
              &lt;xsl:variable name="code" select="unparsed-text(@xml:base)"/&gt;
              &lt;table&gt;
                &lt;tr&gt;
                  &lt;td valign="top" align="right"&gt;
                    &lt;pre class="fake-prism"&gt;
                      &lt;xsl:for-each select="tokenize($code,'&amp;#10;')"&gt;
                        &lt;span id="line-{generate-id($stylesheet)}-{position()}"&gt;
                          &lt;xsl:choose&gt;
                            &lt;xsl:when test="position() eq 1 or (position() mod 5 = 0)"&gt;
                              &lt;xsl:sequence select="position()"/&gt;
                            &lt;/xsl:when&gt;
                            &lt;xsl:otherwise&gt;
                              &lt;span class="lno"&gt;
                                &lt;xsl:sequence select="position()"/&gt;
                              &lt;/span&gt;
                            &lt;/xsl:otherwise&gt;
                          &lt;/xsl:choose&gt;
                        &lt;/span&gt;
                        &lt;xsl:text&gt;&amp;#10;&lt;/xsl:text&gt;
                      &lt;/xsl:for-each&gt;
                    &lt;/pre&gt;
                  &lt;/td&gt;
                  &lt;td valign="top"&gt;
                    &lt;pre&gt;
                      &lt;code class="language-xml"&gt;
                        &lt;xsl:sequence select="$code"/&gt;
                      &lt;/code&gt;
                    &lt;/pre&gt;
                  &lt;/td&gt;
                &lt;/tr&gt;
              &lt;/table&gt;
              &lt;xsl:catch&gt;
                &lt;xsl:message select="'Failed to load source:', @xml:base"/&gt;
                &lt;xsl:sequence select="()"/&gt;
              &lt;/xsl:catch&gt;
            &lt;/xsl:try&gt;
          &lt;/div&gt;
        &lt;/div&gt;
      &lt;/div&gt;
    &lt;/xsl:if&gt;
  &lt;/div&gt;
&lt;/xsl:template&gt;

&lt;xsl:template match="a:function"&gt;
  &lt;div id="{@id}"
       class="instruction {@class}"&gt;
    &lt;div class="title"&gt;
      &lt;xsl:sequence select="f:line-link(.)"/&gt;
      &lt;xsl:text&gt;Function &lt;/xsl:text&gt;
      &lt;xsl:choose&gt;
        &lt;xsl:when test="count(a:no-arity) gt 1"&gt;
          &lt;xsl:sequence select="@display-name/string()"/&gt;
        &lt;/xsl:when&gt;
        &lt;xsl:otherwise&gt;
          &lt;xsl:sequence select="substring-before(@display-name/string(), '#')"/&gt;
        &lt;/xsl:otherwise&gt;
      &lt;/xsl:choose&gt;
      &lt;xsl:text&gt;(&lt;/xsl:text&gt;
      &lt;xsl:for-each select="a:param"&gt;
        &lt;xsl:if test="position() gt 1"&gt;, &lt;/xsl:if&gt;
        &lt;xsl:text&gt;$&lt;/xsl:text&gt;
        &lt;xsl:value-of select="@name/string()"/&gt;
        &lt;xsl:if test="@as"&gt;
          &lt;xsl:text&gt; as &lt;/xsl:text&gt;
          &lt;xsl:value-of select="@as/string()"/&gt;
        &lt;/xsl:if&gt;
      &lt;/xsl:for-each&gt;
      &lt;xsl:text&gt;)&lt;/xsl:text&gt;

      &lt;xsl:if test="@as"&gt;
        &lt;xsl:sequence select="' as ' || @as"/&gt;
      &lt;/xsl:if&gt;

      &lt;xsl:if test="@recursive = 'true'"&gt;
        &lt;xsl:text&gt; &lt;/xsl:text&gt;
        &lt;span class="recursive" title="Recursive function"&gt;♻&lt;/span&gt;
      &lt;/xsl:if&gt;
    &lt;/div&gt;

    &lt;div class="props"&gt;
      &lt;xsl:if test="a:shadow"&gt;
        &lt;div class="shadows"&gt;
          &lt;span class="marker"&gt;⚠&lt;/span&gt;
          &lt;xsl:text&gt;Shadows: &lt;/xsl:text&gt;
          &lt;xsl:apply-templates select="key('id', a:shadow)" mode="m:reference"/&gt;
        &lt;/div&gt;
      &lt;/xsl:if&gt;

      &lt;xsl:call-template name="t:variables-referenced"/&gt;
      &lt;xsl:call-template name="t:functions-called"/&gt;
      &lt;xsl:call-template name="t:templates-called"/&gt;

      &lt;div class="used-by"&gt;
        &lt;xsl:choose&gt;
          &lt;xsl:when test="a:used-by"&gt;
            &lt;span class="marker"&gt;
              &lt;xsl:if test="count(a:used-by) = 1 and a:used-by/string() = @id/string()"&gt;
                &lt;span class="marker"&gt;☞&lt;/span&gt;
              &lt;/xsl:if&gt;
            &lt;/span&gt;
            &lt;xsl:text&gt;Used by: &lt;/xsl:text&gt;
            &lt;xsl:sequence select="f:reference-list(a:used-by)"/&gt;
          &lt;/xsl:when&gt;
          &lt;xsl:otherwise&gt;
            &lt;span class="marker"&gt;☞&lt;/span&gt;
            &lt;span class="unused"&gt;Unused&lt;/span&gt;
          &lt;/xsl:otherwise&gt;
        &lt;/xsl:choose&gt;
      &lt;/div&gt;

      &lt;xsl:if test="a:used-by-module"&gt;
        &lt;div class="used-in"&gt;
          &lt;span class="marker"&gt;
            &lt;xsl:if test="@elsewhere = 'true'"&gt;
              &lt;xsl:attribute name="title" select="'Only used in one other module'"/&gt;
              &lt;xsl:text&gt;☝&lt;/xsl:text&gt;
            &lt;/xsl:if&gt;
          &lt;/span&gt;
          &lt;xsl:text&gt;Used in: &lt;/xsl:text&gt;
          &lt;xsl:sequence select="f:reference-list(a:used-by-module)"/&gt;
        &lt;/div&gt;
      &lt;/xsl:if&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/xsl:template&gt;

&lt;xsl:template match="a:variable"&gt;
  &lt;div id="{@id}"
       class="instruction {@class}"&gt;
    &lt;div class="title"&gt;
      &lt;xsl:sequence select="f:line-link(.)"/&gt;
      &lt;xsl:sequence
          select="if (@type = 'param') then 'Param ' else 'Variable '"/&gt;
      &lt;code&gt;
        &lt;xsl:sequence select="'$'||@display-name/string()"/&gt;
      &lt;/code&gt;
      &lt;xsl:if test="@as"&gt;
        &lt;xsl:text&gt; as &lt;/xsl:text&gt;
        &lt;code&gt;
          &lt;xsl:sequence select="@as/string()"/&gt;
        &lt;/code&gt;
      &lt;/xsl:if&gt;
      &lt;xsl:if test="@static = 'yes'"&gt;
        &lt;xsl:text&gt; [static]&lt;/xsl:text&gt;
      &lt;/xsl:if&gt;
    &lt;/div&gt;

    &lt;div class="props"&gt;
      &lt;xsl:if test="a:shadow"&gt;
        &lt;div class="shadows"&gt;
          &lt;span class="marker"&gt;⚠&lt;/span&gt;
          &lt;xsl:text&gt;Shadows: &lt;/xsl:text&gt;
          &lt;xsl:apply-templates select="key('id', a:shadow)" mode="m:reference"/&gt;
        &lt;/div&gt;
      &lt;/xsl:if&gt;

      &lt;xsl:call-template name="t:variables-referenced"/&gt;
      &lt;xsl:call-template name="t:functions-called"/&gt;
      &lt;xsl:call-template name="t:templates-called"/&gt;

      &lt;div class="used-by"&gt;
        &lt;xsl:choose&gt;
          &lt;xsl:when test="a:used-by"&gt;
            &lt;span class="marker"&gt;&lt;/span&gt;
            &lt;xsl:text&gt;Used by: &lt;/xsl:text&gt;
            &lt;xsl:sequence select="f:reference-list(a:used-by)"/&gt;
          &lt;/xsl:when&gt;
          &lt;xsl:otherwise&gt;
            &lt;span class="marker"&gt;☞&lt;/span&gt;
            &lt;span class="unused"&gt;Unused&lt;/span&gt;
          &lt;/xsl:otherwise&gt;
        &lt;/xsl:choose&gt;
      &lt;/div&gt;

      &lt;xsl:if test="a:used-by-module"&gt;
        &lt;div class="used-in"&gt;
          &lt;span class="marker"&gt;
            &lt;xsl:if test="@elsewhere = 'true'"&gt;
              &lt;xsl:attribute name="title" select="'Only used in one other module'"/&gt;
              &lt;xsl:text&gt;☝&lt;/xsl:text&gt;
            &lt;/xsl:if&gt;
          &lt;/span&gt;
          &lt;xsl:text&gt;Used in: &lt;/xsl:text&gt;
          &lt;xsl:sequence select="f:reference-list(a:used-by-module)"/&gt;
        &lt;/div&gt;
      &lt;/xsl:if&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/xsl:template&gt;

&lt;xsl:template match="a:template"&gt;
  &lt;div id="{@id}"
       class="instruction {@class}"&gt;
    &lt;div class="title"&gt;
      &lt;xsl:sequence select="f:line-link(.)"/&gt;
      &lt;xsl:text&gt;Template&lt;/xsl:text&gt;

      &lt;xsl:if test="@name"&gt;
        &lt;xsl:sequence select="' ' || @display-name/string()"/&gt;
      &lt;/xsl:if&gt;
      
      &lt;xsl:choose&gt;
        &lt;xsl:when test="@match and string-length(@match) gt 30"&gt;
          &lt;xsl:sequence select="' match ≅ ' || substring(@match, 1, 30) || '…'"/&gt;
        &lt;/xsl:when&gt;
        &lt;xsl:otherwise&gt;
          &lt;xsl:sequence select="' match ≅ ' || @match/string()"/&gt;
        &lt;/xsl:otherwise&gt;
      &lt;/xsl:choose&gt;

      &lt;xsl:if test="@as"&gt;
        &lt;xsl:sequence select="' as ' || @as"/&gt;
      &lt;/xsl:if&gt;

      &lt;xsl:if test="@recursive = 'true'"&gt;
        &lt;xsl:text&gt; &lt;/xsl:text&gt;
        &lt;span class="recursive" title="Recursive template"&gt;♻&lt;/span&gt;
      &lt;/xsl:if&gt;
    &lt;/div&gt;

    &lt;div class="props"&gt;
      &lt;xsl:if test="a:shadow"&gt;
        &lt;div class="shadows"&gt;
          &lt;span class="marker"&gt;⚠&lt;/span&gt;
          &lt;xsl:text&gt;Shadows: &lt;/xsl:text&gt;
          &lt;xsl:apply-templates select="key('id', a:shadow)" mode="m:reference"/&gt;
        &lt;/div&gt;
      &lt;/xsl:if&gt;

      &lt;xsl:call-template name="t:variables-referenced"/&gt;
      &lt;xsl:call-template name="t:functions-called"/&gt;
      &lt;xsl:call-template name="t:templates-called"/&gt;

      &lt;xsl:if test="@name"&gt;
        &lt;div class="used-by"&gt;
          &lt;xsl:choose&gt;
            &lt;xsl:when test="a:used-by"&gt;
              &lt;span class="marker"&gt;
                &lt;xsl:if test="count(a:used-by) = 1 and a:used-by/string() = @id/string()"&gt;
                  &lt;span class="marker"&gt;☞&lt;/span&gt;
                &lt;/xsl:if&gt;
              &lt;/span&gt;
              &lt;xsl:text&gt;Used by: &lt;/xsl:text&gt;
              &lt;xsl:sequence select="f:reference-list(a:used-by)"/&gt;
            &lt;/xsl:when&gt;
            &lt;xsl:otherwise&gt;
              &lt;span class="marker"&gt;☞&lt;/span&gt;
              &lt;span class="unused"&gt;
                &lt;xsl:text&gt;Unused&lt;/xsl:text&gt;
                &lt;xsl:if test="@match"&gt;
                  &lt;xsl:text&gt; (by name)&lt;/xsl:text&gt;
                &lt;/xsl:if&gt;
              &lt;/span&gt;
            &lt;/xsl:otherwise&gt;
          &lt;/xsl:choose&gt;
        &lt;/div&gt;
      &lt;/xsl:if&gt;

      &lt;xsl:if test="a:used-by-module"&gt;
        &lt;div class="used-in"&gt;
          &lt;span class="marker"&gt;
            &lt;xsl:if test="@elsewhere = 'true'"&gt;
              &lt;xsl:attribute name="title" select="'Only used in one other module'"/&gt;
              &lt;xsl:text&gt;☝&lt;/xsl:text&gt;
            &lt;/xsl:if&gt;
          &lt;/span&gt;
          &lt;xsl:text&gt;Used in: &lt;/xsl:text&gt;
          &lt;xsl:sequence select="f:reference-list(a:used-by-module)"/&gt;
        &lt;/div&gt;
      &lt;/xsl:if&gt;

      &lt;xsl:if test="@mode"&gt;
        &lt;div class="mode"&gt;
          &lt;xsl:text&gt;Mode: &lt;/xsl:text&gt;
          &lt;code&gt;
            &lt;xsl:value-of select="@display-mode/string()"/&gt;
          &lt;/code&gt;
        &lt;/div&gt;
      &lt;/xsl:if&gt;

      &lt;xsl:if test="@priority"&gt;
        &lt;div class="priority"&gt;
          &lt;xsl:text&gt;Priority: &lt;/xsl:text&gt;
          &lt;code&gt;
            &lt;xsl:value-of select="@priority/string()"/&gt;
          &lt;/code&gt;
        &lt;/div&gt;
      &lt;/xsl:if&gt;

      &lt;xsl:if test="@match"&gt;
        &lt;div class="matches"&gt;
          &lt;xsl:text&gt;Matches: &lt;/xsl:text&gt;
          &lt;xsl:for-each select="tokenize(@match,'\|')"&gt;
            &lt;xsl:if test="position() gt 1"&gt;, &lt;/xsl:if&gt;
            &lt;code&gt;
              &lt;xsl:value-of select="."/&gt;
            &lt;/code&gt;
          &lt;/xsl:for-each&gt;
        &lt;/div&gt;
      &lt;/xsl:if&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/xsl:template&gt;

&lt;xsl:template match="a:comment"&gt;
  &lt;div id="{@id}"
       class="instruction {@class}"&gt;
    &lt;div class="title"&gt;
      &lt;xsl:sequence select="f:line-link(.)"/&gt;
      &lt;xsl:text&gt;Comment&lt;/xsl:text&gt;
    &lt;/div&gt;

    &lt;div class="props"&gt;
      &lt;xsl:sequence select="string(.)"/&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/xsl:template&gt;

&lt;!-- ============================================================ --&gt;

&lt;xsl:template name="t:variables-referenced"&gt;
  &lt;xsl:if test="a:variable"&gt;
    &lt;div class="uses"&gt;
      &lt;xsl:text&gt;Uses: &lt;/xsl:text&gt;
      &lt;xsl:for-each select="a:variable ! key('id', .)"&gt;
        &lt;xsl:sort select="@name"/&gt;
        &lt;xsl:if test="position() gt 1"&gt;, &lt;/xsl:if&gt;
        &lt;xsl:apply-templates select="." mode="m:reference"/&gt;
      &lt;/xsl:for-each&gt;
    &lt;/div&gt;
  &lt;/xsl:if&gt;
&lt;/xsl:template&gt;

&lt;xsl:template name="t:functions-called"&gt;
  &lt;xsl:if test="a:function"&gt;
    &lt;div class="calls"&gt;
      &lt;xsl:text&gt;Calls: &lt;/xsl:text&gt;
      &lt;xsl:for-each select="a:function ! key('id', .)"&gt;
        &lt;xsl:sort select="@name"/&gt;
        &lt;xsl:if test="position() gt 1"&gt;, &lt;/xsl:if&gt;
        &lt;xsl:apply-templates select="." mode="m:reference"/&gt;
      &lt;/xsl:for-each&gt;
    &lt;/div&gt;
  &lt;/xsl:if&gt;
&lt;/xsl:template&gt;

&lt;xsl:template name="t:templates-called"&gt;
  &lt;xsl:if test="a:template"&gt;
    &lt;div class="calls"&gt;
      &lt;xsl:text&gt;Calls: &lt;/xsl:text&gt;
      &lt;xsl:for-each select="a:template ! key('id', .)"&gt;
        &lt;xsl:sort select="@name"/&gt;
        &lt;xsl:if test="position() gt 1"&gt;, &lt;/xsl:if&gt;
        &lt;xsl:apply-templates select="." mode="m:reference"/&gt;
      &lt;/xsl:for-each&gt;
    &lt;/div&gt;
  &lt;/xsl:if&gt;
&lt;/xsl:template&gt;

&lt;!-- ============================================================ --&gt;

&lt;xsl:function name="f:reference-list"&gt;
  &lt;xsl:param name="refs" as="element()+"/&gt;

  &lt;xsl:for-each select="$refs ! key('id', .)"&gt;
    &lt;xsl:sort select="@name"/&gt;
    &lt;xsl:if test="position() gt 1"&gt;, &lt;/xsl:if&gt;
    &lt;xsl:apply-templates select="." mode="m:reference"/&gt;
  &lt;/xsl:for-each&gt;
&lt;/xsl:function&gt;

&lt;xsl:template match="*" mode="m:reference"&gt;
  &lt;a href="#{@id}" class="error"&gt;
    &lt;xsl:text&gt;???&lt;/xsl:text&gt;
    &lt;xsl:sequence select="local-name(.)"/&gt;
  &lt;/a&gt;
&lt;/xsl:template&gt;

&lt;xsl:template match="a:stylesheet" mode="m:reference"&gt;
  &lt;a href="#{@id}"&gt;
    &lt;xsl:sequence select="if (@href)
                          then string(@href)
                          else '«root»'"/&gt;
  &lt;/a&gt;
&lt;/xsl:template&gt;

&lt;xsl:template match="a:variable" mode="m:reference"&gt;
  &lt;a href="#{@id}"&gt;
    &lt;xsl:sequence select="'$'||@display-name/string()"/&gt;
  &lt;/a&gt;
&lt;/xsl:template&gt;

&lt;xsl:template match="a:function" mode="m:reference"&gt;
  &lt;xsl:variable name="fdefs"
                select="key('fnoarity', @noarity-id)"/&gt;

  &lt;a href="#{@id}"&gt;
    &lt;xsl:choose&gt;
      &lt;xsl:when test="count($fdefs) gt 1"&gt;
        &lt;xsl:sequence select="@display-name/string()"/&gt;
      &lt;/xsl:when&gt;
      &lt;xsl:otherwise&gt;
        &lt;xsl:sequence select="substring-before(@display-name/string(), '#')"/&gt;
      &lt;/xsl:otherwise&gt;
    &lt;/xsl:choose&gt;
    &lt;xsl:text&gt;()&lt;/xsl:text&gt;
  &lt;/a&gt;
&lt;/xsl:template&gt;

&lt;xsl:template match="a:template" mode="m:reference"&gt;
  &lt;a href="#{@id}"&gt;
    &lt;xsl:choose&gt;
      &lt;xsl:when test="@name"&gt;
        &lt;xsl:sequence select="@display-name/string()"/&gt;
      &lt;/xsl:when&gt;
      &lt;xsl:otherwise&gt;
        &lt;xsl:text&gt;template&lt;/xsl:text&gt;
      &lt;/xsl:otherwise&gt;
    &lt;/xsl:choose&gt;
  &lt;/a&gt;
&lt;/xsl:template&gt;

&lt;!-- ============================================================ --&gt;

&lt;xsl:template match="a:stylesheet" mode="m:toc"&gt;
  &lt;xsl:if test="a:stylesheet"&gt;
    &lt;ul&gt;
      &lt;xsl:for-each select="a:stylesheet"&gt;
        &lt;li&gt;
          &lt;a href="#{@id}"&gt;
            &lt;xsl:sequence select="@href/string()"/&gt;
          &lt;/a&gt;
          &lt;xsl:apply-templates select="." mode="m:toc"/&gt;
        &lt;/li&gt;
      &lt;/xsl:for-each&gt;
    &lt;/ul&gt;
  &lt;/xsl:if&gt;
&lt;/xsl:template&gt;

&lt;!-- ============================================================ --&gt;
&lt;xsl:function name="f:line-link" as="element(h:span)?"&gt;
  &lt;xsl:param name="node" as="element()"/&gt;

  &lt;span class="link"&gt;
    &lt;xsl:if test="string($source-listings) = ('1','true','yes')
                  and $node/@line-number"&gt;
      &lt;xsl:attribute name="title" select="'Line ' || $node/@line-number/string()"/&gt;
      &lt;a href="#line-{generate-id($node/ancestor::a:stylesheet[1])}-{$node/@line-number}"
         class="goto-lno"&gt;
        &lt;xsl:text&gt;§&lt;/xsl:text&gt;
      &lt;/a&gt;
    &lt;/xsl:if&gt;
  &lt;/span&gt;
&lt;/xsl:function&gt;

&lt;xsl:function name="f:summary-count" as="element(h:span)?"&gt;
  &lt;xsl:param name="count" as="xs:string"/&gt;
  &lt;xsl:param name="label" as="xs:string"/&gt;

  &lt;xsl:if test="$count ne '0'"&gt;
    &lt;span class="{$label} all"&gt;
      &lt;xsl:choose&gt;
        &lt;xsl:when test="$count = '1'"&gt;
          &lt;xsl:sequence select="$count || ' ' || $label"/&gt;
        &lt;/xsl:when&gt;
        &lt;xsl:when test="not($count castable as xs:integer)"&gt;
          &lt;xsl:sequence select="$count || ' ' || $label"/&gt;
        &lt;/xsl:when&gt;
        &lt;xsl:otherwise&gt;
          &lt;xsl:sequence select="$count || ' ' || $label || 's'"/&gt;
        &lt;/xsl:otherwise&gt;
      &lt;/xsl:choose&gt;
    &lt;/span&gt;
  &lt;/xsl:if&gt;
&lt;/xsl:function&gt;

&lt;xsl:function name="f:summary-details"&gt;
  &lt;xsl:param name="detail" as="element()"/&gt;

  &lt;!-- hack --&gt;
  &lt;xsl:variable name="class" select="local-name($detail)"/&gt;
  &lt;xsl:variable name="class" select="substring($class, 1, string-length($class) - 1)"/&gt;

  &lt;xsl:variable name="detail" as="element(h:span)*"&gt;
    &lt;xsl:if test="$detail/a:unused"&gt;
      &lt;span class="{$class} unused"&gt;
        &lt;xsl:sequence select="count($detail/a:unused) || ' unused'"/&gt;
      &lt;/span&gt;
    &lt;/xsl:if&gt;
    &lt;xsl:if test="$detail/a:shadows"&gt;
      &lt;span class="{$class} shadows"&gt;
        &lt;xsl:sequence select="count($detail/a:shadows) || ' shadow'"/&gt;
      &lt;/span&gt;
    &lt;/xsl:if&gt;
    &lt;xsl:if test="$detail/a:elsewhere"&gt;
      &lt;span class="{$class} elsewhere"&gt;
        &lt;xsl:sequence select="count($detail/a:elsewhere) || ' used only in one other module'"/&gt;
      &lt;/span&gt;
    &lt;/xsl:if&gt;
  &lt;/xsl:variable&gt;

  &lt;xsl:if test="exists($detail)"&gt;
    &lt;xsl:text&gt; (&lt;/xsl:text&gt;
    &lt;xsl:for-each select="$detail"&gt;
      &lt;xsl:if test="position() gt 1"&gt;, &lt;/xsl:if&gt;
      &lt;xsl:sequence select="."/&gt;
    &lt;/xsl:for-each&gt;
    &lt;xsl:text&gt;)&lt;/xsl:text&gt;
  &lt;/xsl:if&gt;
&lt;/xsl:function&gt;

&lt;/xsl:stylesheet&gt;
</code></pre></td></tr></table></div></div></div></div><p><span><span class="template all">4 templates</span></span>, <span><span class="param all">6 params</span> (<span class="param elsewhere">1 used only in one other module</span>)</span></p><div class="instructions"><div class="title closed">Instructions</div><div class="body"><div id="S-49518-..source-listings" class="instruction param elsewhere"><div class="title"><span class="link" title="Line 18"><a href="#line-d47615e2-18" class="goto-lno">§</a></span>Param <code>$source-listings</code></div><div class="props"><div class="used-by"><span class="marker"></span>Used by: <a href="#S-60890-t-2">template</a>, <a href="#S-60890-nwalsh.com.ns.xslt.functions.line-link,1">f:line-link()</a></div><div class="used-in"><span class="marker" title="Only used in one other module">☝</span>Used in: <a href="#S-60890">summarize.xsl</a></div></div></div><div id="S-49518-..debug-parse" class="instruction param"><div class="title"><span class="link" title="Line 20"><a href="#line-d47615e2-20" class="goto-lno">§</a></span>Param <code>$debug-parse</code> [static]</div><div class="props"><div class="used-by"><span class="marker"></span>Used by: <a href="#S-49518-t-1">template</a></div><div class="used-in"><span class="marker"></span>Used in: <a href="#S-49518">«root»</a></div></div></div><div id="S-49518-..debug-resolve" class="instruction param"><div class="title"><span class="link" title="Line 21"><a href="#line-d47615e2-21" class="goto-lno">§</a></span>Param <code>$debug-resolve</code> [static]</div><div class="props"><div class="used-by"><span class="marker"></span>Used by: <a href="#S-49518-t-1">template</a></div><div class="used-in"><span class="marker"></span>Used in: <a href="#S-49518">«root»</a></div></div></div><div id="S-49518-..debug-analyze" class="instruction param"><div class="title"><span class="link" title="Line 22"><a href="#line-d47615e2-22" class="goto-lno">§</a></span>Param <code>$debug-analyze</code> [static]</div><div class="props"><div class="used-by"><span class="marker"></span>Used by: <a href="#S-49518-t-1">template</a></div><div class="used-in"><span class="marker"></span>Used in: <a href="#S-49518">«root»</a></div></div></div><div id="S-49518-..format" class="instruction param"><div class="title"><span class="link" title="Line 23"><a href="#line-d47615e2-23" class="goto-lno">§</a></span>Param <code>$format</code></div><div class="props"><div class="used-by"><span class="marker"></span>Used by: <a href="#S-49518-t-1">template</a></div><div class="used-in"><span class="marker"></span>Used in: <a href="#S-49518">«root»</a></div></div></div><div id="S-49518-..xspec-tests" class="instruction param"><div class="title"><span class="link" title="Line 24"><a href="#line-d47615e2-24" class="goto-lno">§</a></span>Param <code>$xspec-tests</code></div><div class="props"><div class="used-by"><span class="marker"></span>Used by: <a href="#S-49518-t-1">template</a>, <a href="#S-56087-nwalsh.com.ns.xslt.functions.checksum,1">f:checksum()</a></div><div class="used-in"><span class="marker"></span>Used in: <a href="#S-49518">«root»</a>, <a href="#S-56087">parse.xsl</a></div></div></div><div id="S-49518-t-1" class="instruction template"><div class="title"><span class="link" title="Line 26"><a href="#line-d47615e2-26" class="goto-lno">§</a></span>Template match ≅ /</div><div class="props"><div class="uses">Uses: <a href="#S-49518-..debug-analyze">$debug-analyze</a>, <a href="#S-49518-..debug-parse">$debug-parse</a>, <a href="#S-49518-..debug-resolve">$debug-resolve</a>, <a href="#S-49518-..format">$format</a>, <a href="#S-49518-..xspec-tests">$xspec-tests</a></div><div class="matches">Matches: <code>/</code></div></div></div><div id="S-49518-t-2" class="instruction template"><div class="title"><span class="link" title="Line 73"><a href="#line-d47615e2-73" class="goto-lno">§</a></span>Template match ≅ element()</div><div class="props"><div class="mode">Mode: <code>m:fix-base-uri</code></div><div class="matches">Matches: <code>element()</code></div></div></div><div id="S-49518-t-3" class="instruction template"><div class="title"><span class="link" title="Line 79"><a href="#line-d47615e2-79" class="goto-lno">§</a></span>Template match ≅ @xml:base</div><div class="props"><div class="mode">Mode: <code>m:fix-base-uri</code></div><div class="matches">Matches: <code>@xml:base</code></div></div></div><div id="S-49518-t-4" class="instruction template"><div class="title"><span class="link" title="Line 84"><a href="#line-d47615e2-84" class="goto-lno">§</a></span>Template match ≅ attribute()|comment()|processi…</div><div class="props"><div class="mode">Mode: <code>m:fix-base-uri</code></div><div class="matches">Matches: <code>attribute()</code>, <code>comment()</code>, <code>processing-instruction()</code>, <code>text()</code></div></div></div></div></div><div class="source-code"><div class="title closed">Source code</div><div class="body"><div><table><tr><td valign="top" align="right"><pre class="fake-prism"><span id="line-d47615e2-1">1</span>
<span id="line-d47615e2-2"><span class="lno">2</span></span>
<span id="line-d47615e2-3"><span class="lno">3</span></span>
<span id="line-d47615e2-4"><span class="lno">4</span></span>
<span id="line-d47615e2-5">5</span>
<span id="line-d47615e2-6"><span class="lno">6</span></span>
<span id="line-d47615e2-7"><span class="lno">7</span></span>
<span id="line-d47615e2-8"><span class="lno">8</span></span>
<span id="line-d47615e2-9"><span class="lno">9</span></span>
<span id="line-d47615e2-10">10</span>
<span id="line-d47615e2-11"><span class="lno">11</span></span>
<span id="line-d47615e2-12"><span class="lno">12</span></span>
<span id="line-d47615e2-13"><span class="lno">13</span></span>
<span id="line-d47615e2-14"><span class="lno">14</span></span>
<span id="line-d47615e2-15">15</span>
<span id="line-d47615e2-16"><span class="lno">16</span></span>
<span id="line-d47615e2-17"><span class="lno">17</span></span>
<span id="line-d47615e2-18"><span class="lno">18</span></span>
<span id="line-d47615e2-19"><span class="lno">19</span></span>
<span id="line-d47615e2-20">20</span>
<span id="line-d47615e2-21"><span class="lno">21</span></span>
<span id="line-d47615e2-22"><span class="lno">22</span></span>
<span id="line-d47615e2-23"><span class="lno">23</span></span>
<span id="line-d47615e2-24"><span class="lno">24</span></span>
<span id="line-d47615e2-25">25</span>
<span id="line-d47615e2-26"><span class="lno">26</span></span>
<span id="line-d47615e2-27"><span class="lno">27</span></span>
<span id="line-d47615e2-28"><span class="lno">28</span></span>
<span id="line-d47615e2-29"><span class="lno">29</span></span>
<span id="line-d47615e2-30">30</span>
<span id="line-d47615e2-31"><span class="lno">31</span></span>
<span id="line-d47615e2-32"><span class="lno">32</span></span>
<span id="line-d47615e2-33"><span class="lno">33</span></span>
<span id="line-d47615e2-34"><span class="lno">34</span></span>
<span id="line-d47615e2-35">35</span>
<span id="line-d47615e2-36"><span class="lno">36</span></span>
<span id="line-d47615e2-37"><span class="lno">37</span></span>
<span id="line-d47615e2-38"><span class="lno">38</span></span>
<span id="line-d47615e2-39"><span class="lno">39</span></span>
<span id="line-d47615e2-40">40</span>
<span id="line-d47615e2-41"><span class="lno">41</span></span>
<span id="line-d47615e2-42"><span class="lno">42</span></span>
<span id="line-d47615e2-43"><span class="lno">43</span></span>
<span id="line-d47615e2-44"><span class="lno">44</span></span>
<span id="line-d47615e2-45">45</span>
<span id="line-d47615e2-46"><span class="lno">46</span></span>
<span id="line-d47615e2-47"><span class="lno">47</span></span>
<span id="line-d47615e2-48"><span class="lno">48</span></span>
<span id="line-d47615e2-49"><span class="lno">49</span></span>
<span id="line-d47615e2-50">50</span>
<span id="line-d47615e2-51"><span class="lno">51</span></span>
<span id="line-d47615e2-52"><span class="lno">52</span></span>
<span id="line-d47615e2-53"><span class="lno">53</span></span>
<span id="line-d47615e2-54"><span class="lno">54</span></span>
<span id="line-d47615e2-55">55</span>
<span id="line-d47615e2-56"><span class="lno">56</span></span>
<span id="line-d47615e2-57"><span class="lno">57</span></span>
<span id="line-d47615e2-58"><span class="lno">58</span></span>
<span id="line-d47615e2-59"><span class="lno">59</span></span>
<span id="line-d47615e2-60">60</span>
<span id="line-d47615e2-61"><span class="lno">61</span></span>
<span id="line-d47615e2-62"><span class="lno">62</span></span>
<span id="line-d47615e2-63"><span class="lno">63</span></span>
<span id="line-d47615e2-64"><span class="lno">64</span></span>
<span id="line-d47615e2-65">65</span>
<span id="line-d47615e2-66"><span class="lno">66</span></span>
<span id="line-d47615e2-67"><span class="lno">67</span></span>
<span id="line-d47615e2-68"><span class="lno">68</span></span>
<span id="line-d47615e2-69"><span class="lno">69</span></span>
<span id="line-d47615e2-70">70</span>
<span id="line-d47615e2-71"><span class="lno">71</span></span>
<span id="line-d47615e2-72"><span class="lno">72</span></span>
<span id="line-d47615e2-73"><span class="lno">73</span></span>
<span id="line-d47615e2-74"><span class="lno">74</span></span>
<span id="line-d47615e2-75">75</span>
<span id="line-d47615e2-76"><span class="lno">76</span></span>
<span id="line-d47615e2-77"><span class="lno">77</span></span>
<span id="line-d47615e2-78"><span class="lno">78</span></span>
<span id="line-d47615e2-79"><span class="lno">79</span></span>
<span id="line-d47615e2-80">80</span>
<span id="line-d47615e2-81"><span class="lno">81</span></span>
<span id="line-d47615e2-82"><span class="lno">82</span></span>
<span id="line-d47615e2-83"><span class="lno">83</span></span>
<span id="line-d47615e2-84"><span class="lno">84</span></span>
<span id="line-d47615e2-85">85</span>
<span id="line-d47615e2-86"><span class="lno">86</span></span>
<span id="line-d47615e2-87"><span class="lno">87</span></span>
<span id="line-d47615e2-88"><span class="lno">88</span></span>
<span id="line-d47615e2-89"><span class="lno">89</span></span>
</pre></td><td valign="top"><pre><code class="language-xml">&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
                xmlns:m="http://nwalsh.com/ns/xslt/modes"
                xmlns:xs="http://www.w3.org/2001/XMLSchema"
                xmlns="http://www.w3.org/1999/xhtml"
                exclude-result-prefixes="m xs"
                version="3.0"&gt;

&lt;xsl:import href="VERSION.xsl"/&gt;
&lt;xsl:import href="parse.xsl"/&gt;
&lt;xsl:import href="resolve.xsl"/&gt;
&lt;xsl:import href="analyze.xsl"/&gt;
&lt;xsl:import href="summarize.xsl"/&gt;

&lt;xsl:output method="xhtml" encoding="utf-8" indent="no"
            omit-xml-declaration="yes"/&gt;

&lt;xsl:param name="source-listings" select="'true'"/&gt;

&lt;xsl:param name="debug-parse" select="()" static="yes"/&gt;
&lt;xsl:param name="debug-resolve" select="()" static="yes"/&gt;
&lt;xsl:param name="debug-analyze" select="()" static="yes"/&gt;
&lt;xsl:param name="format" select="'visual'"/&gt;
&lt;xsl:param name="xspec-tests" select="'false'"/&gt;

&lt;xsl:template match="/"&gt;
  &lt;xsl:variable name="parsed"&gt;
    &lt;xsl:apply-templates select="/" mode="m:parse"/&gt;
  &lt;/xsl:variable&gt;

  &lt;xsl:result-document use-when="exists($debug-parse)"
                       href="{$debug-parse}" method="xml" indent="yes"&gt;
    &lt;xsl:sequence select="$parsed"/&gt;
  &lt;/xsl:result-document&gt;

  &lt;xsl:variable name="resolved"&gt;
    &lt;xsl:apply-templates select="$parsed" mode="m:resolve"/&gt;
  &lt;/xsl:variable&gt;

  &lt;xsl:result-document use-when="exists($debug-resolve)"
                       href="{$debug-resolve}" method="xml" indent="yes"&gt;
    &lt;xsl:sequence select="$resolved"/&gt;
  &lt;/xsl:result-document&gt;

  &lt;xsl:variable name="analyzed"&gt;
    &lt;xsl:apply-templates select="$resolved" mode="m:analyze"/&gt;
  &lt;/xsl:variable&gt;

  &lt;xsl:result-document use-when="exists($debug-analyze)"
                       href="{$debug-analyze}" method="xml" indent="yes"&gt;
    &lt;xsl:sequence select="$analyzed"/&gt;
  &lt;/xsl:result-document&gt;

  &lt;xsl:choose&gt;
    &lt;xsl:when test="$format = 'data'"&gt;
      &lt;xsl:choose&gt;
        &lt;xsl:when test="$xspec-tests = ('true','yes','1')"&gt;
          &lt;xsl:apply-templates select="$analyzed" mode="m:fix-base-uri"/&gt;
        &lt;/xsl:when&gt;
        &lt;xsl:otherwise&gt;
          &lt;xsl:sequence select="$analyzed"/&gt;
        &lt;/xsl:otherwise&gt;
      &lt;/xsl:choose&gt;
    &lt;/xsl:when&gt;
    &lt;xsl:otherwise&gt;
      &lt;xsl:apply-templates select="$analyzed" mode="m:summarize"/&gt;
    &lt;/xsl:otherwise&gt;
  &lt;/xsl:choose&gt;
&lt;/xsl:template&gt;

&lt;!-- ============================================================ --&gt;

&lt;xsl:template match="element()" mode="m:fix-base-uri"&gt;
  &lt;xsl:copy&gt;
    &lt;xsl:apply-templates select="@*,node()" mode="m:fix-base-uri"/&gt;
  &lt;/xsl:copy&gt;
&lt;/xsl:template&gt;

&lt;xsl:template match="@xml:base" mode="m:fix-base-uri"&gt;
  &lt;xsl:attribute name="xml:base" select="'...'"/&gt;
&lt;/xsl:template&gt;

&lt;xsl:template match="attribute()|text()|comment()|processing-instruction()"
              mode="m:fix-base-uri"&gt;
  &lt;xsl:copy/&gt;
&lt;/xsl:template&gt;

&lt;/xsl:stylesheet&gt;
</code></pre></td></tr></table></div></div></div></div></main><footer><p>Generated by <a href="https://xslt.xmlexplorer.com/">XSLT Explorer</a> version <span title="git hash: 2621bf7">0.1.5</span> at 07:44 on 07 Jun 2020.</p><p>Source: file:/Users/ndw/Projects/xml/xsltexplorer/build/xslt/explorer.xsl</p></footer></body><script src="js/xsltexplorer.js"></script></html>